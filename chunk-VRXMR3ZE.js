import{$ as et,A as Fo,Aa as Wo,Ab as ul,B as un,Bb as xg,C as nl,Ca as Eg,Cb as Ko,Da as wg,Db as ts,E as ug,Ea as Lr,Eb as Vg,F as Be,Fa as Tg,Fb as Ug,G as jo,Ga as bg,Gb as Fg,H as He,Ha as al,Hb as jg,I as lg,Ia as Ag,Ib as Jo,J as hg,K as se,Ka as Go,L as rl,N as J,Oa as Sg,P as dg,Pa as Rg,Pb as Qo,Q as ne,Qa as Cg,Qb as Yo,R as te,Ra as Pg,S as L,Sa as kg,Sb as Bg,T as ot,V as fg,W as at,Wa as Dg,X as ke,_ as ct,a as ng,aa as Bo,b as rg,ba as pg,bb as Ng,c as st,ca as Nr,d as $n,da as $e,e as Ze,ea as il,f as ig,fa as $o,g as sg,ga as ln,h as Vt,ha as Or,i as Xu,j as Zu,ja as Ft,k as el,ka as tt,l as xe,la as zo,m as G,ma as qo,n as Xi,na as mg,o as tl,oa as gg,p as og,pa as yg,q as ce,qa as sl,r as ag,ra as _g,s as cn,sa as Mr,t as cg,ta as ol,u as Uo,ua as Ho,vb as Og,w as Ut,wa as vg,x as kr,xb as Mg,y as Zi,ya as es,yb as Lg,z as Dr,za as Ig,zb as cl}from"./chunk-25PNJEBW.js";import{a as O,b as ye,c as Vo}from"./chunk-C6Q5SG76.js";var ns=class{_doc;constructor(e){this._doc=e}manager},Xo=(()=>{class n extends ns{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(te(et))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),ta=new ne(""),fl=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(o=>{o.manager=this});let i=t.filter(o=>!(o instanceof Xo));this._plugins=i.slice().reverse();let s=t.find(o=>o instanceof Xo);s&&this._plugins.push(s)}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new se(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(te(ta),te($e))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),ll="ng-app-id";function $g(n){for(let e of n)e.remove()}function zg(n,e){let t=e.createElement("style");return t.textContent=n,t}function qT(n,e,t,r){let i=n.head?.querySelectorAll(`style[${ll}="${e}"],link[${ll}="${e}"]`);if(i)for(let s of i)s.removeAttribute(ll),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function dl(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var pl=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,qT(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,zg);r?.forEach(i=>this.addUsage(i,this.external,dl))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&($g(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])$g(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,zg(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,dl(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(te(et),te(sl),te(ol,8),te(Mr))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),hl={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ml=/%COMP%/g;var Hg="%COMP%",HT=`_nghost-${Hg}`,WT=`_ngcontent-${Hg}`,GT=!0,KT=new ne("",{factory:()=>GT});function JT(n){return WT.replace(ml,n)}function QT(n){return HT.replace(ml,n)}function Wg(n,e){return e.map(t=>t.replace(ml,n))}var gl=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,r,i,s,o,c,u=null,h=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=c,this.nonce=u,this.tracingService=h,this.defaultRenderer=new rs(t,o,c,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof ea?i.applyToHost(t):i instanceof is&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,c=this.ngZone,u=this.eventManager,h=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,m=this.tracingService;switch(r.encapsulation){case Ho.Emulated:s=new ea(u,h,r,this.appId,f,o,c,m);break;case Ho.ShadowDom:return new Zo(u,t,r,o,c,this.nonce,m,h);case Ho.ExperimentalIsolatedShadowDom:return new Zo(u,t,r,o,c,this.nonce,m);default:s=new is(u,h,r,f,o,c,m);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(te(fl),te(pl),te(sl),te(KT),te(et),te($e),te(ol),te(Wo,8))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),rs=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(hl[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(qg(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(qg(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new se(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=hl[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=hl[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(es.DashCase|es.Important)?e.style.setProperty(t,r,i&es.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&es.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=ts().getGlobalEventTarget(this.doc,e),!e))throw new se(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function qg(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Zo=class extends rs{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,s,o,c,u){super(e,i,s,c),this.hostEl=t,this.sharedStylesHost=u,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let h=r.styles;h=Wg(r.id,h);for(let m of h){let g=document.createElement("style");o&&g.setAttribute("nonce",o),g.textContent=m,this.shadowRoot.appendChild(g)}let f=r.getExternalStyles?.();if(f)for(let m of f){let g=dl(m,i);o&&g.setAttribute("nonce",o),this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},is=class extends rs{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,c,u){super(e,s,o,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let h=r.styles;this.styles=u?Wg(u,h):h,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Ig.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},ea=class extends is{contentAttr;hostAttr;constructor(e,t,r,i,s,o,c,u){let h=i+"-"+r.id;super(e,t,r,s,o,c,u,h),this.contentAttr=JT(h),this.hostAttr=QT(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var na=class n extends Ug{supportsDOMEvents=!0;static makeCurrent(){Vg(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=YT();return t==null?null:XT(t)}resetBaseElement(){ss=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Qo(document.cookie,e)}},ss=null;function YT(){return ss=ss||document.head.querySelector("base"),ss?ss.getAttribute("href"):null}function XT(n){return new URL(n,document.baseURI).pathname}var ZT=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),Gg=["alt","control","meta","shift"],eb={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},tb={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Kg=(()=>{class n extends ns{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),c=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ts().onAndCancel(t,o.domEventName,c,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),Gg.forEach(h=>{let f=r.indexOf(h);f>-1&&(r.splice(f,1),o+=h+".")}),o+=s,r.length!=0||s.length===0)return null;let u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let i=eb[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Gg.forEach(o=>{if(o!==i){let c=tb[o];c(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(te(et))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})();function nb(n,e,t){let r=O({rootComponent:n,platformRef:t?.platformRef},rb(e));return xg(r)}function rb(n){return{appProviders:[...cb,...n?.providers??[]],platformProviders:ab}}function ib(){na.makeCurrent()}function sb(){return new il}function ob(){return yg(document),document}var ab=[{provide:Mr,useValue:Bg},{provide:_g,useValue:ib,multi:!0},{provide:et,useFactory:ob}];var cb=[{provide:fg,useValue:"root"},{provide:il,useFactory:sb},{provide:ta,useClass:Xo,multi:!0},{provide:ta,useClass:Kg,multi:!0},gl,pl,fl,{provide:Eg,useExisting:gl},{provide:Yo,useClass:ZT},[]];var qn=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=t.slice(r+1).trim();this.addHeaderEntry(i,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(c=>s.indexOf(c)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var ia=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}},sa=class{encodeKey(e){return Jg(e)}encodeValue(e){return Jg(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function ub(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,c]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],u=t.get(o)||[];u.push(c),t.set(o,u)}),t}var lb=/%(\d[a-f0-9])/gi,hb={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Jg(n){return encodeURIComponent(n).replace(lb,(e,t)=>hb[t]??e)}function ra(n){return`${n}`}var hn=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new sa,e.fromString){if(e.fromObject)throw new se(2805,!1);this.map=ub(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(ra):[ra(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(ra(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(ra(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};function db(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Qg(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Yg(n){return typeof Blob<"u"&&n instanceof Blob}function Xg(n){return typeof FormData<"u"&&n instanceof FormData}function fb(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Zg="Content-Type",ey="Accept",ty="text/plain",ny="application/json",pb=`${ny}, ${ty}, */*`,os=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,r,i){this.url=t,this.method=e.toUpperCase();let s;if(db(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s){if(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,this.keepalive=!!s.keepalive,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),s.priority&&(this.priority=s.priority),s.cache&&(this.cache=s.cache),s.credentials&&(this.credentials=s.credentials),typeof s.timeout=="number"){if(s.timeout<1||!Number.isInteger(s.timeout))throw new se(2822,"");this.timeout=s.timeout}s.mode&&(this.mode=s.mode),s.redirect&&(this.redirect=s.redirect),s.integrity&&(this.integrity=s.integrity),s.referrer&&(this.referrer=s.referrer),s.referrerPolicy&&(this.referrerPolicy=s.referrerPolicy),this.transferCache=s.transferCache}if(this.headers??=new qn,this.context??=new ia,!this.params)this.params=new hn,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),u=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+u+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Qg(this.body)||Yg(this.body)||Xg(this.body)||fb(this.body)?this.body:this.body instanceof hn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Xg(this.body)?null:Yg(this.body)?this.body.type||null:Qg(this.body)?null:typeof this.body=="string"?ty:this.body instanceof hn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?ny:null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.keepalive??this.keepalive,o=e.priority||this.priority,c=e.cache||this.cache,u=e.mode||this.mode,h=e.redirect||this.redirect,f=e.credentials||this.credentials,m=e.referrer||this.referrer,g=e.integrity||this.integrity,A=e.referrerPolicy||this.referrerPolicy,C=e.transferCache??this.transferCache,D=e.timeout??this.timeout,R=e.body!==void 0?e.body:this.body,M=e.withCredentials??this.withCredentials,V=e.reportProgress??this.reportProgress,F=e.headers||this.headers,$=e.params||this.params,ge=e.context??this.context;return e.setHeaders!==void 0&&(F=Object.keys(e.setHeaders).reduce((X,E)=>X.set(E,e.setHeaders[E]),F)),e.setParams&&($=Object.keys(e.setParams).reduce((X,E)=>X.set(E,e.setParams[E]),$)),new n(t,r,R,{params:$,headers:F,context:ge,reportProgress:V,responseType:i,withCredentials:M,transferCache:C,keepalive:s,cache:c,priority:o,timeout:D,mode:u,redirect:h,credentials:f,referrer:m,integrity:g,referrerPolicy:A})}},xr=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(xr||{}),Vr=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,r="OK"){this.headers=e.headers||new qn,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}},oa=class n extends Vr{constructor(e={}){super(e)}type=xr.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},aa=class n extends Vr{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=xr.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}},as=class extends Vr{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},mb=200,gb=204;var yb=new ne("");var _b=/^\)\]\}',?\n/;var Il=(()=>{class n{xhrFactory;tracingService=L(Wo,{optional:!0});constructor(t){this.xhrFactory=t}maybePropagateTrace(t){return this.tracingService?.propagate?this.tracingService.propagate(t):t}handle(t){if(t.method==="JSONP")throw new se(-2800,!1);let r=this.xhrFactory;return G(null).pipe(Be(()=>new st(s=>{let o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((R,M)=>o.setRequestHeader(R,M.join(","))),t.headers.has(ey)||o.setRequestHeader(ey,pb),!t.headers.has(Zg)){let R=t.detectContentTypeHeader();R!==null&&o.setRequestHeader(Zg,R)}if(t.timeout&&(o.timeout=t.timeout),t.responseType){let R=t.responseType.toLowerCase();o.responseType=R!=="json"?R:"text"}let c=t.serializeBody(),u=null,h=()=>{if(u!==null)return u;let R=o.statusText||"OK",M=new qn(o.getAllResponseHeaders()),V=o.responseURL||t.url;return u=new oa({headers:M,status:o.status,statusText:R,url:V}),u},f=this.maybePropagateTrace(()=>{let{headers:R,status:M,statusText:V,url:F}=h(),$=null;M!==gb&&($=typeof o.response>"u"?o.responseText:o.response),M===0&&(M=$?mb:0);let ge=M>=200&&M<300;if(t.responseType==="json"&&typeof $=="string"){let X=$;$=$.replace(_b,"");try{$=$!==""?JSON.parse($):null}catch(E){$=X,ge&&(ge=!1,$={error:E,text:$})}}ge?(s.next(new aa({body:$,headers:R,status:M,statusText:V,url:F||void 0})),s.complete()):s.error(new as({error:$,headers:R,status:M,statusText:V,url:F||void 0}))}),m=this.maybePropagateTrace(R=>{let{url:M}=h(),V=new as({error:R,status:o.status||0,statusText:o.statusText||"Unknown Error",url:M||void 0});s.error(V)}),g=m;t.timeout&&(g=this.maybePropagateTrace(R=>{let{url:M}=h(),V=new as({error:new DOMException("Request timed out","TimeoutError"),status:o.status||0,statusText:o.statusText||"Request timeout",url:M||void 0});s.error(V)}));let A=!1,C=this.maybePropagateTrace(R=>{A||(s.next(h()),A=!0);let M={type:xr.DownloadProgress,loaded:R.loaded};R.lengthComputable&&(M.total=R.total),t.responseType==="text"&&o.responseText&&(M.partialText=o.responseText),s.next(M)}),D=this.maybePropagateTrace(R=>{let M={type:xr.UploadProgress,loaded:R.loaded};R.lengthComputable&&(M.total=R.total),s.next(M)});return o.addEventListener("load",f),o.addEventListener("error",m),o.addEventListener("timeout",g),o.addEventListener("abort",m),t.reportProgress&&(o.addEventListener("progress",C),c!==null&&o.upload&&o.upload.addEventListener("progress",D)),o.send(c),s.next({type:xr.Sent}),()=>{o.removeEventListener("error",m),o.removeEventListener("abort",m),o.removeEventListener("load",f),o.removeEventListener("timeout",g),t.reportProgress&&(o.removeEventListener("progress",C),c!==null&&o.upload&&o.upload.removeEventListener("progress",D)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(r){return new(r||n)(te(Yo))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function vb(n,e){return e(n)}function Ib(n,e,t){return(r,i)=>ke(t,()=>e(r,s=>n(s,i)))}var ry=new ne("",{factory:()=>[]}),Eb=new ne(""),iy=new ne("",{factory:()=>!0});var El=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=te(Il),i},providedIn:"root"})}return n})();var ca=(()=>{class n{backend;injector;chain=null;pendingTasks=L(Or);contributeToStability=L(iy);constructor(t,r){this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(ry),...this.injector.get(Eb,[])]));this.chain=r.reduceRight((i,s)=>Ib(i,s,this.injector),vb)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Fo(r))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(te(El),te(at))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=te(ca),i},providedIn:"root"})}return n})();function vl(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer,referrerPolicy:n.referrerPolicy}}var wb=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof os)s=t;else{let u;i.headers instanceof qn?u=i.headers:u=new qn(i.headers);let h;i.params&&(i.params instanceof hn?h=i.params:h=new hn({fromObject:i.params})),s=new os(t,r,i.body!==void 0?i.body:null,{headers:u,context:i.context,params:h,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache,keepalive:i.keepalive,priority:i.priority,cache:i.cache,mode:i.mode,redirect:i.redirect,credentials:i.credentials,referrer:i.referrer,referrerPolicy:i.referrerPolicy,integrity:i.integrity,timeout:i.timeout})}let o=G(s).pipe(Zi(u=>this.handler.handle(u)));if(t instanceof os||i.observe==="events")return o;let c=o.pipe(Ut(u=>u instanceof aa));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(ce(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new se(2806,!1);return u.body}));case"blob":return c.pipe(ce(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new se(2807,!1);return u.body}));case"text":return c.pipe(ce(u=>{if(u.body!==null&&typeof u.body!="string")throw new se(2808,!1);return u.body}));case"json":default:return c.pipe(ce(u=>u.body))}case"response":return c;default:throw new se(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new hn().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,vl(i,r))}post(t,r,i={}){return this.request("POST",t,vl(i,r))}put(t,r,i={}){return this.request("PUT",t,vl(i,r))}static \u0275fac=function(r){return new(r||n)(te(wl))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Tb=new ne("",{factory:()=>!0}),bb="XSRF-TOKEN",Ab=new ne("",{factory:()=>bb}),Sb="X-XSRF-TOKEN",Rb=new ne("",{providedIn:"root",factory:()=>Sb}),Cb=(()=>{class n{cookieName=L(Ab);doc=L(et);lastCookieString="";lastToken=null;parseCount=0;getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Qo(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),sy=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=te(Cb),i},providedIn:"root"})}return n})();function Pb(n,e){if(!L(Tb)||n.method==="GET"||n.method==="HEAD")return e(n);try{let i=L(Fg).href,{origin:s}=new URL(i),{origin:o}=new URL(n.url,s);if(s!==o)return e(n)}catch{return e(n)}let t=L(sy).getToken(),r=L(Rb);return t!=null&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,t)})),e(n)}function kb(...n){let e=[wb,ca,{provide:wl,useExisting:ca},{provide:El,useFactory:()=>L(yb,{optional:!0})??L(Il)},{provide:ry,useValue:Pb,multi:!0}];for(let t of n)e.push(...t.\u0275providers);return ot(e)}var oy=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(te(et))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var q="primary",Is=Symbol("RouteTitle"),Rl=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Kn(n){return new Rl(n)}function my(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],c=n[s];if(o[0]===":")i[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function pa(n){return new Promise((e,t)=>{n.pipe(un()).subscribe({next:r=>e(r),error:r=>t(r)})})}function Nb(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!yt(n[t],e[t]))return!1;return!0}function yt(n,e){let t=n?Cl(n):void 0,r=e?Cl(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!gy(n[i],e[i]))return!1;return!0}function Cl(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function gy(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function yy(n){return n.length>0?n[n.length-1]:null}function Qn(n){return tl(n)?n:Rg(n)?xe(Promise.resolve(n)):G(n)}function _y(n){return tl(n)?pa(n):Promise.resolve(n)}var Ob={exact:Iy,subset:Ey},vy={exact:Mb,subset:Lb,ignored:()=>!0};function ay(n,e,t){return Ob[t.paths](n.root,e.root,t.matrixParams)&&vy[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Mb(n,e){return yt(n,e)}function Iy(n,e,t){if(!Wn(n.segments,e.segments)||!ha(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Iy(n.children[r],e.children[r],t))return!1;return!0}function Lb(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>gy(n[t],e[t]))}function Ey(n,e,t){return wy(n,e,e.segments,t)}function wy(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Wn(i,t)||e.hasChildren()||!ha(i,t,r))}else if(n.segments.length===t.length){if(!Wn(n.segments,t)||!ha(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Ey(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Wn(n.segments,i)||!ha(n.segments,i,r)||!n.children[q]?!1:wy(n.children[q],e,s,r)}}function ha(n,e,t){return e.every((r,i)=>vy[t](n[i].parameters,r.parameters))}var lt=class{root;queryParams;fragment;_queryParamMap;constructor(e=new re([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Kn(this.queryParams),this._queryParamMap}toString(){return Ub.serialize(this)}},re=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return da(this)}},dn=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Kn(this.parameters),this._parameterMap}toString(){return by(this)}};function xb(n,e){return Wn(n,e)&&n.every((t,r)=>yt(t.parameters,e[r].parameters))}function Wn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Vb(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===q&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==q&&(t=t.concat(e(i,r)))}),t}var Es=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>new fn,providedIn:"root"})}return n})(),fn=class{parse(e){let t=new kl(e);return new lt(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${cs(e.root,!0)}`,r=Bb(e.queryParams),i=typeof e.fragment=="string"?`#${Fb(e.fragment)}`:"";return`${t}${r}${i}`}},Ub=new fn;function da(n){return n.segments.map(e=>by(e)).join("/")}function cs(n,e){if(!n.hasChildren())return da(n);if(e){let t=n.children[q]?cs(n.children[q],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==q&&r.push(`${i}:${cs(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Vb(n,(r,i)=>i===q?[cs(n.children[q],!1)]:[`${i}:${cs(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[q]!=null?`${da(n)}/${t[0]}`:`${da(n)}/(${t.join("//")})`}}function Ty(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ua(n){return Ty(n).replace(/%3B/gi,";")}function Fb(n){return encodeURI(n)}function Pl(n){return Ty(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function fa(n){return decodeURIComponent(n)}function cy(n){return fa(n.replace(/\+/g,"%20"))}function by(n){return`${Pl(n.path)}${jb(n.parameters)}`}function jb(n){return Object.entries(n).map(([e,t])=>`;${Pl(e)}=${Pl(t)}`).join("")}function Bb(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${ua(t)}=${ua(i)}`).join("&"):`${ua(t)}=${ua(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var $b=/^[^\/()?;#]+/;function Tl(n){let e=n.match($b);return e?e[0]:""}var zb=/^[^\/()?;=#]+/;function qb(n){let e=n.match(zb);return e?e[0]:""}var Hb=/^[^=?&#]+/;function Wb(n){let e=n.match(Hb);return e?e[0]:""}var Gb=/^[^&#]+/;function Kb(n){let e=n.match(Gb);return e?e[0]:""}var kl=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new re([],{}):new re([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[q]=new re(e,t)),r}parseSegment(){let e=Tl(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new se(4009,!1);return this.capture(e),new dn(fa(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=qb(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Tl(this.remaining);i&&(r=i,this.capture(r))}e[fa(t)]=fa(r)}parseQueryParam(e){let t=Wb(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=Kb(this.remaining);o&&(r=o,this.capture(r))}let i=cy(t),s=cy(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Tl(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new se(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=q);let o=this.parseChildren();t[s??q]=Object.keys(o).length===1&&o[q]?o[q]:new re([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new se(4011,!1)}};function Ay(n){return n.segments.length>0?new re([],{[q]:n}):n}function Sy(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Sy(i);if(r===q&&s.segments.length===0&&s.hasChildren())for(let[o,c]of Object.entries(s.children))e[o]=c;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new re(n.segments,e);return Jb(t)}function Jb(n){if(n.numberOfChildren===1&&n.children[q]){let e=n.children[q];return new re(n.segments.concat(e.segments),e.children)}return n}function pn(n){return n instanceof lt}function Ry(n,e,t=null,r=null,i=new fn){let s=Cy(n);return Py(s,e,t,r,i)}function Cy(n){let e;function t(s){let o={};for(let u of s.children){let h=t(u);o[u.outlet]=h}let c=new re(s.url,o);return s===n&&(e=c),c}let r=t(n.root),i=Ay(r);return e??i}function Py(n,e,t,r,i){let s=n;for(;s.parent;)s=s.parent;if(e.length===0)return bl(s,s,s,t,r,i);let o=Qb(e);if(o.toRoot())return bl(s,s,new re([],{}),t,r,i);let c=Yb(o,s,n),u=c.processChildren?ls(c.segmentGroup,c.index,o.commands):Dy(c.segmentGroup,c.index,o.commands);return bl(s,c.segmentGroup,u,t,r,i)}function ma(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function fs(n){return typeof n=="object"&&n!=null&&n.outlets}function uy(n,e,t){n||="\u0275";let r=new lt;return r.queryParams={[n]:e},t.parse(t.serialize(r)).queryParams[n]}function bl(n,e,t,r,i,s){let o={};for(let[h,f]of Object.entries(r??{}))o[h]=Array.isArray(f)?f.map(m=>uy(h,m,s)):uy(h,f,s);let c;n===e?c=t:c=ky(n,e,t);let u=Ay(Sy(c));return new lt(u,o,i)}function ky(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=ky(s,e,t)}),new re(n.segments,r)}var ga=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&ma(r[0]))throw new se(4003,!1);let i=r.find(fs);if(i&&i!==yy(r))throw new se(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Qb(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new ga(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([u,h])=>{c[u]=typeof h=="string"?h.split("/"):h}),[...i,{outlets:c}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((c,u)=>{u==0&&c==="."||(u==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,s]},[]);return new ga(t,e,r)}var Fr=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function Yb(n,e,t){if(n.isAbsolute)return new Fr(e,!0,0);if(!t)return new Fr(e,!1,NaN);if(t.parent===null)return new Fr(t,!0,0);let r=ma(n.commands[0])?0:1,i=t.segments.length-1+r;return Xb(t,i,n.numberOfDoubleDots)}function Xb(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new se(4005,!1);i=r.segments.length}return new Fr(r,!1,i-s)}function Zb(n){return fs(n[0])?n[0].outlets:{[q]:n}}function Dy(n,e,t){if(n??=new re([],{}),n.segments.length===0&&n.hasChildren())return ls(n,e,t);let r=eA(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new re(n.segments.slice(0,r.pathIndex),{});return s.children[q]=new re(n.segments.slice(r.pathIndex),n.children),ls(s,0,i)}else return r.match&&i.length===0?new re(n.segments,{}):r.match&&!n.hasChildren()?Dl(n,e,t):r.match?ls(n,0,i):Dl(n,e,t)}function ls(n,e,t){if(t.length===0)return new re(n.segments,{});{let r=Zb(t),i={};if(Object.keys(r).some(s=>s!==q)&&n.children[q]&&n.numberOfChildren===1&&n.children[q].segments.length===0){let s=ls(n.children[q],e,t);return new re(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Dy(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new re(n.segments,i)}}function eA(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],c=t[r];if(fs(c))break;let u=`${c}`,h=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&h&&typeof h=="object"&&h.outlets===void 0){if(!hy(u,h,o))return s;r+=2}else{if(!hy(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Dl(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(fs(s)){let u=tA(s.outlets);return new re(r,u)}if(i===0&&ma(t[0])){let u=n.segments[e];r.push(new dn(u.path,ly(t[0]))),i++;continue}let o=fs(s)?s.outlets[q]:`${s}`,c=i<t.length-1?t[i+1]:null;o&&c&&ma(c)?(r.push(new dn(o,ly(c))),i+=2):(r.push(new dn(o,{})),i++)}return new re(r,{})}function tA(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Dl(new re([],{}),0,r))}),e}function ly(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function hy(n,e,t){return n==t.path&&yt(e,t.parameters)}var hs="imperative",Ae=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Ae||{}),Je=class{id;url;constructor(e,t){this.id=e,this.url=t}},Jn=class extends Je{type=Ae.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},vt=class extends Je{urlAfterRedirects;type=Ae.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ze=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(ze||{}),ps=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(ps||{}),_t=class extends Je{reason;code;type=Ae.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},jt=class extends Je{reason;code;type=Ae.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},Br=class extends Je{error;target;type=Ae.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},ms=class extends Je{urlAfterRedirects;state;type=Ae.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ya=class extends Je{urlAfterRedirects;state;type=Ae.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_a=class extends Je{urlAfterRedirects;state;shouldActivate;type=Ae.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},va=class extends Je{urlAfterRedirects;state;type=Ae.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ia=class extends Je{urlAfterRedirects;state;type=Ae.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ea=class{route;type=Ae.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},wa=class{route;type=Ae.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ta=class{snapshot;type=Ae.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ba=class{snapshot;type=Ae.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Aa=class{snapshot;type=Ae.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Sa=class{snapshot;type=Ae.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var gs=class{},$r=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function nA(n){return!(n instanceof gs)&&!(n instanceof $r)}function rA(n,e){return n.providers&&!n._injector&&(n._injector=al(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ut(n){return n.outlet||q}function iA(n,e){let t=n.filter(r=>ut(r)===e);return t.push(...n.filter(r=>ut(r)!==e)),t}function Hr(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Ra=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Hr(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Wr(this.rootInjector)}},Wr=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Ra(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(te(at))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ca=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Nl(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Nl(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Ol(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Ol(e,this._root).map(t=>t.value)}};function Nl(n,e){if(n===e.value)return e;for(let t of e.children){let r=Nl(n,t);if(r)return r}return null}function Ol(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Ol(n,t);if(r.length)return r.unshift(e),r}return[]}var Ke=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ur(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var ys=class extends Ca{snapshot;constructor(e,t){super(e),this.snapshot=t,Fl(this,e)}toString(){return this.snapshot.toString()}};function Ny(n){let e=sA(n),t=new Ze([new dn("",{})]),r=new Ze({}),i=new Ze({}),s=new Ze({}),o=new Ze(""),c=new Bt(t,r,s,o,i,q,n,e.root);return c.snapshot=e.root,new ys(new Ke(c,[]),e)}function sA(n){let e={},t={},r={},s=new Gn([],e,r,"",t,q,n,null,{});return new _s("",new Ke(s,[]))}var Bt=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,c,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=c,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(ce(h=>h[Is]))??G(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ce(e=>Kn(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ce(e=>Kn(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Pa(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:O(O({},e.params),n.params),data:O(O({},e.data),n.data),resolve:O(O(O(O({},n.data),e.data),i?.data),n._resolvedData)}:r={params:O({},n.params),data:O({},n.data),resolve:O(O({},n.data),n._resolvedData??{})},i&&My(i)&&(r.resolve[Is]=i.title),r}var Gn=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Is]}constructor(e,t,r,i,s,o,c,u,h){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=c,this.routeConfig=u,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Kn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Kn(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},_s=class extends Ca{url;constructor(e,t){super(t),this.url=e,Fl(this,t)}toString(){return Oy(this._root)}};function Fl(n,e){e.value._routerState=n,e.children.forEach(t=>Fl(n,t))}function Oy(n){let e=n.children.length>0?` { ${n.children.map(Oy).join(", ")} } `:"";return`${n.value}${e}`}function Al(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,yt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),yt(e.params,t.params)||n.paramsSubject.next(t.params),Nb(e.url,t.url)||n.urlSubject.next(t.url),yt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Ml(n,e){let t=yt(n.params,e.params)&&xb(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Ml(n.parent,e.parent))}function My(n){return typeof n.title=="string"||n.title===null}var Ly=new ne(""),jl=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=q;activateEvents=new Nr;deactivateEvents=new Nr;attachEvents=new Nr;detachEvents=new Nr;routerOutletData=Lg();parentContexts=L(Wr);location=L(Tg);changeDetector=L(ul);inputBinder=L(Oa,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new se(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new se(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new se(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new se(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Ll(t,c,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Go({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[zo]})}return n})(),Ll=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Bt?this.route:e===Wr?this.childContexts:e===Ly?this.outletData:this.parent.get(e,t)}},Oa=new ne("");var Bl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Ag({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Dg(0,"router-outlet")},dependencies:[jl],encapsulation:2})}return n})();function $l(n){let e=n.children&&n.children.map($l),t=e?ye(O({},n),{children:e}):O({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==q&&(t.component=Bl),t}function oA(n,e,t){let r=vs(n,e._root,t?t._root:void 0);return new ys(r,e)}function vs(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=aA(n,e,t);return new Ke(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>vs(n,c)),o}}let r=cA(e.value),i=e.children.map(s=>vs(n,s));return new Ke(r,i)}}function aA(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return vs(n,r,i);return vs(n,r)})}function cA(n){return new Bt(new Ze(n.url),new Ze(n.params),new Ze(n.queryParams),new Ze(n.fragment),new Ze(n.data),n.outlet,n.component,n)}var zr=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},xy="ngNavigationCancelingError";function ka(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=pn(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Vy(!1,ze.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function Vy(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[xy]=!0,t.cancellationCode=e,t}function uA(n){return Uy(n)&&pn(n.url)}function Uy(n){return!!n&&n[xy]}var lA=(n,e,t,r)=>ce(i=>(new xl(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),xl=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Al(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Ur(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ur(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ur(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Ur(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Sa(s.value.snapshot))}),e.children.length&&this.forwardEvent(new ba(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Al(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),Al(c.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},Da=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},jr=class{component;route;constructor(e,t){this.component=e,this.route=t}};function hA(n,e,t){let r=n._root,i=e?e._root:null;return us(r,i,t,[r.value])}function dA(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Gr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!dg(n)?n:e.get(n):r}function us(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ur(e);return n.children.forEach(o=>{fA(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,c])=>ds(c,t.getContext(o),i)),i}function fA(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=pA(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Da(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?us(n,e,c?c.children:null,r,i):us(n,e,t,r,i),u&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new jr(c.outlet.component,o))}else o&&ds(e,c,i),i.canActivateChecks.push(new Da(r)),s.component?us(n,null,c?c.children:null,r,i):us(n,null,t,r,i);return i}function pA(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Wn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Wn(n.url,e.url)||!yt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ml(n,e)||!yt(n.queryParams,e.queryParams);case"paramsChange":default:return!Ml(n,e)}}function ds(n,e,t){let r=Ur(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?ds(o,e.children.getContext(s),t):ds(o,null,t):ds(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new jr(e.outlet.component,i)):t.canDeactivateChecks.push(new jr(null,i)):t.canDeactivateChecks.push(new jr(null,i))}function ws(n){return typeof n=="function"}function mA(n){return typeof n=="boolean"}function gA(n){return n&&ws(n.canLoad)}function yA(n){return n&&ws(n.canActivate)}function _A(n){return n&&ws(n.canActivateChild)}function vA(n){return n&&ws(n.canDeactivate)}function IA(n){return n&&ws(n.canMatch)}function Fy(n){return n instanceof og||n?.name==="EmptyError"}var la=Symbol("INITIAL_VALUE");function qr(){return Be(n=>ag(n.map(e=>e.pipe(Dr(1),ug(la)))).pipe(ce(e=>{for(let t of e)if(t!==!0){if(t===la)return la;if(t===!1||EA(t))return t}return!0}),Ut(e=>e!==la),Dr(1)))}function EA(n){return pn(n)||n instanceof zr}function jy(n){return n.aborted?G(void 0).pipe(Dr(1)):new st(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function By(n){return jo(jy(n))}function wA(n,e){return cn(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?G(ye(O({},t),{guardsResult:!0})):TA(o,r,i,n).pipe(cn(c=>c&&mA(c)?bA(r,s,n,e):G(c)),ce(c=>ye(O({},t),{guardsResult:c})))})}function TA(n,e,t,r){return xe(n).pipe(cn(i=>PA(i.component,i.route,t,e,r)),un(i=>i!==!0,!0))}function bA(n,e,t,r){return xe(e).pipe(Zi(i=>cg(SA(i.route.parent,r),AA(i.route,r),CA(n,i.path,t),RA(n,i.route,t))),un(i=>i!==!0,!0))}function AA(n,e){return n!==null&&e&&e(new Aa(n)),G(!0)}function SA(n,e){return n!==null&&e&&e(new Ta(n)),G(!0)}function RA(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return G(!0);let i=r.map(s=>Uo(()=>{let o=Hr(e)??t,c=Gr(s,o),u=yA(c)?c.canActivate(e,n):ke(o,()=>c(e,n));return Qn(u).pipe(un())}));return G(i).pipe(qr())}function CA(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>dA(o)).filter(o=>o!==null).map(o=>Uo(()=>{let c=o.guards.map(u=>{let h=Hr(o.node)??t,f=Gr(u,h),m=_A(f)?f.canActivateChild(r,n):ke(h,()=>f(r,n));return Qn(m).pipe(un())});return G(c).pipe(qr())}));return G(s).pipe(qr())}function PA(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return G(!0);let o=s.map(c=>{let u=Hr(e)??i,h=Gr(c,u),f=vA(h)?h.canDeactivate(n,e,t,r):ke(u,()=>h(n,e,t,r));return Qn(f).pipe(un())});return G(o).pipe(qr())}function kA(n,e,t,r,i){let s=e.canLoad;if(s===void 0||s.length===0)return G(!0);let o=s.map(c=>{let u=Gr(c,n),h=gA(u)?u.canLoad(e,t):ke(n,()=>u(e,t)),f=Qn(h);return i?f.pipe(By(i)):f});return G(o).pipe(qr(),$y(r))}function $y(n){return rg(He(e=>{if(typeof e!="boolean")throw ka(n,e)}),ce(e=>e===!0))}function DA(n,e,t,r,i){let s=e.canMatch;if(!s||s.length===0)return G(!0);let o=s.map(c=>{let u=Gr(c,n),h=IA(u)?u.canMatch(e,t):ke(n,()=>u(e,t)),f=Qn(h);return i?f.pipe(By(i)):f});return G(o).pipe(qr(),$y(r))}var Hn=class zy extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,zy.prototype)}},Vl=class qy extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,qy.prototype)}};function NA(n){throw new se(4e3,!1)}function OA(n){throw Vy(!1,ze.GuardRejected)}var MA=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return r;if(i.numberOfChildren>1||!i.children[q])throw NA(`${e.redirectTo}`);i=i.children[q]}}async applyRedirectCommands(e,t,r,i,s){let o=await LA(t,i,s);if(o instanceof lt)throw new Vl(o);let c=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),e,r);if(o[0]==="/")throw new Vl(c);return c}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new lt(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([c,u])=>{o[c]=this.createSegmentGroup(e,u,r,i)}),new re(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new se(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}};function LA(n,e,t){if(typeof n=="string")return Promise.resolve(n);let r=n,{queryParams:i,fragment:s,routeConfig:o,url:c,outlet:u,params:h,data:f,title:m}=e;return pa(Qn(ke(t,()=>r({params:h,data:f,queryParams:i,fragment:s,routeConfig:o,url:c,outlet:u,title:m}))))}var Ul={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function xA(n,e,t,r,i,s){let o=Hy(n,e,t);return o.matched?(r=rA(e,r),DA(r,e,t,i,s).pipe(ce(c=>c===!0?o:O({},Ul)))):G(o)}function Hy(n,e,t){if(e.path==="**")return VA(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?O({},Ul):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||my)(t,n,e);if(!i)return O({},Ul);let s={};Object.entries(i.posParams??{}).forEach(([c,u])=>{s[c]=u.path});let o=i.consumed.length>0?O(O({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function VA(n){return{matched:!0,parameters:n.length>0?yy(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function dy(n,e,t,r){return t.length>0&&jA(n,t,r)?{segmentGroup:new re(e,FA(r,new re(t,n.children))),slicedSegments:[]}:t.length===0&&BA(n,t,r)?{segmentGroup:new re(n.segments,UA(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new re(n.segments,n.children),slicedSegments:t}}function UA(n,e,t,r){let i={};for(let s of t)if(Ma(n,e,s)&&!r[ut(s)]){let o=new re([],{});i[ut(s)]=o}return O(O({},r),i)}function FA(n,e){let t={};t[q]=e;for(let r of n)if(r.path===""&&ut(r)!==q){let i=new re([],{});t[ut(r)]=i}return t}function jA(n,e,t){return t.some(r=>Ma(n,e,r)&&ut(r)!==q)}function BA(n,e,t){return t.some(r=>Ma(n,e,r))}function Ma(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function $A(n,e,t){return e.length===0&&!n.children[t]}var zA=class{};async function qA(n,e,t,r,i,s,o="emptyOnly",c){return new WA(n,e,t,r,i,o,s,c).recognize()}var HA=31,WA=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,c,u){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c,this.abortSignal=u,this.applyRedirects=new MA(this.urlSerializer,this.urlTree)}noMatchError(e){return new se(4002,`'${e.segmentGroup}'`)}async recognize(){let e=dy(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:r}=await this.match(e),i=new Ke(r,t),s=new _s("",i),o=Ry(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}async match(e){let t=new Gn([],Object.freeze({}),Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),q,this.rootComponentType,null,{});try{return{children:await this.processSegmentGroup(this.injector,this.config,e,q,t),rootSnapshot:t}}catch(r){if(r instanceof Vl)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Hn?this.noMatchError(r):r}}async processSegmentGroup(e,t,r,i,s){if(r.segments.length===0&&r.hasChildren())return this.processChildren(e,t,r,s);let o=await this.processSegment(e,t,r,r.segments,i,!0,s);return o instanceof Ke?[o]:[]}async processChildren(e,t,r,i){let s=[];for(let u of Object.keys(r.children))u==="primary"?s.unshift(u):s.push(u);let o=[];for(let u of s){let h=r.children[u],f=iA(t,u),m=await this.processSegmentGroup(e,f,h,u,i);o.push(...m)}let c=Wy(o);return GA(c),c}async processSegment(e,t,r,i,s,o,c){for(let u of t)try{return await this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,s,o,c)}catch(h){if(h instanceof Hn||Fy(h))continue;throw h}if($A(r,i,s))return new zA;throw new Hn(r)}async processSegmentAgainstRoute(e,t,r,i,s,o,c,u){if(ut(r)!==o&&(o===q||!Ma(i,s,r)))throw new Hn(i);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,i,r,s,o,u);if(this.allowRedirects&&c)return this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,u);throw new Hn(i)}async expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,c){let{matched:u,parameters:h,consumedSegments:f,positionalParamSegments:m,remainingSegments:g}=Hy(t,i,s);if(!u)throw new Hn(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>HA&&(this.allowRedirects=!1));let A=new Gn(s,h,Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,fy(i),ut(i),i.component??i._loadedComponent??null,i,py(i)),C=Pa(A,c,this.paramsInheritanceStrategy);if(A.params=Object.freeze(C.params),A.data=Object.freeze(C.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let D=await this.applyRedirects.applyRedirectCommands(f,i.redirectTo,m,A,e),R=await this.applyRedirects.lineralizeSegments(i,D);return this.processSegment(e,r,t,R.concat(g),o,!1,c)}async matchSegmentAgainstRoute(e,t,r,i,s,o){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let c=await pa(xA(t,r,i,e,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(t.children={}),!c?.matched)throw new Hn(t);e=r._injector??e;let{routes:u}=await this.getChildConfig(e,r,i),h=r._loadedInjector??e,{parameters:f,consumedSegments:m,remainingSegments:g}=c,A=new Gn(m,f,Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,fy(r),ut(r),r.component??r._loadedComponent??null,r,py(r)),C=Pa(A,o,this.paramsInheritanceStrategy);A.params=Object.freeze(C.params),A.data=Object.freeze(C.data);let{segmentGroup:D,slicedSegments:R}=dy(t,m,g,u);if(R.length===0&&D.hasChildren()){let F=await this.processChildren(h,u,D,A);return new Ke(A,F)}if(u.length===0&&R.length===0)return new Ke(A,[]);let M=ut(r)===s,V=await this.processSegment(h,u,D,R,M?q:s,!0,A);return new Ke(A,V instanceof Ke?[V]:[])}async getChildConfig(e,t,r){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0)return{routes:t._loadedRoutes,injector:t._loadedInjector};if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await pa(kA(e,t,r,this.urlSerializer,this.abortSignal))){let s=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=s.routes,t._loadedInjector=s.injector,s}throw OA(t)}return{routes:[],injector:e}}};function GA(n){n.sort((e,t)=>e.value.outlet===q?-1:t.value.outlet===q?1:e.value.outlet.localeCompare(t.value.outlet))}function KA(n){let e=n.value.routeConfig;return e&&e.path===""}function Wy(n){let e=[],t=new Set;for(let r of n){if(!KA(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Wy(r.children);e.push(new Ke(r.value,i))}return e.filter(r=>!t.has(r))}function fy(n){return n.data||{}}function py(n){return n.resolve||{}}var JA=new ne("",{factory:()=>qA});function QA(n,e,t,r,i,s,o){let c=n.get(JA);return cn(u=>G(u).pipe(Be(h=>c(n,e,t,r,h.extractedUrl,i,s,o)),ce(({state:h,tree:f})=>ye(O({},u),{targetSnapshot:h,urlAfterRedirects:f}))))}function YA(n,e){return cn(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return G(t);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let h of Gy(u))o.add(h);let c=0;return xe(o).pipe(Zi(u=>s.has(u)?XA(u,r,n,e):(u.data=Pa(u,u.parent,n).resolve,G(void 0))),He(()=>c++),nl(1),cn(u=>c===o.size?G(t):Vt))})}function Gy(n){let e=n.children.map(t=>Gy(t)).flat();return[n,...e]}function XA(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!My(i)&&(s[Is]=i.title),Uo(()=>(n.data=Pa(n,n.parent,t).resolve,ZA(s,n,e,r).pipe(ce(o=>(n._resolvedData=o,n.data=O(O({},n.data),o),null)))))}function ZA(n,e,t,r){let i=Cl(n);if(i.length===0)return G({});let s={};return xe(i).pipe(cn(o=>eS(n[o],e,t,r).pipe(un(),He(c=>{if(c instanceof zr)throw ka(new fn,c);s[o]=c}))),nl(1),ce(()=>s),kr(o=>Fy(o)?Vt:Xi(o)))}function eS(n,e,t,r){let i=Hr(e)??r,s=Gr(n,i),o=s.resolve?s.resolve(e,t):ke(i,()=>s(e,t));return Qn(o)}function Sl(n){return Be(e=>{let t=n(e);return t?xe(t).pipe(ce(()=>e)):G(e)})}var zl=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===q);return r}getResolvedTitleForRoute(t){return t.data[Is]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>L(Ky),providedIn:"root"})}return n})(),Ky=(()=>{class n extends zl{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(te(oy))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Kr=new ne("",{factory:()=>({})}),Ts=new ne(""),Jy=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=L(Og);async loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await _y(ke(t,()=>r.loadComponent())),o=await Xy(Yy(s));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o,o}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await Qy(r,this.compiler,t,this.onLoadEndListener);return r._loadedRoutes=s.routes,r._loadedInjector=s.injector,s}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,i),i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function Qy(n,e,t,r){let i=await _y(ke(t,()=>n.loadChildren())),s=await Xy(Yy(i)),o;s instanceof bg||Array.isArray(s)?o=s:o=await e.compileModuleAsync(s),r&&r(n);let c,u,h=!1;return Array.isArray(o)?(u=o,h=!0):(c=o.create(t).injector,u=c.get(Ts,[],{optional:!0,self:!0}).flat()),{routes:u.map($l),injector:c}}function tS(n){return n&&typeof n=="object"&&"default"in n}function Yy(n){return tS(n)?n.default:n}async function Xy(n){return n}var La=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>L(nS),providedIn:"root"})}return n})(),nS=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Zy=new ne("");var rS=()=>{},e_=new ne(""),t_=(()=>{class n{currentNavigation=ln(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=ln(null);events=new $n;transitionAbortWithErrorSubject=new $n;configLoader=L(Jy);environmentInjector=L(at);destroyRef=L(Bo);urlSerializer=L(Es);rootContexts=L(Wr);location=L(Jo);inputBindingEnabled=L(Oa,{optional:!0})!==null;titleStrategy=L(zl);options=L(Kr,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=L(La);createViewTransition=L(Zy,{optional:!0});navigationErrorHandler=L(e_,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>G(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Ea(i)),r=i=>this.events.next(new wa(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;Ft(()=>{this.transitions?.next(ye(O({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(t){return this.transitions=new Ze(null),this.transitions.pipe(Ut(r=>r!==null),Be(r=>{let i=!1,s=new AbortController;return G(r).pipe(Be(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",ze.SupersededByNewNavigation),Vt;this.currentTransition=r;let c=this.lastSuccessfulNavigation();this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:c?ye(O({},c),{previousNavigation:null}):null,abort:()=>s.abort()});let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&h!=="reload")return this.events.next(new jt(o.id,this.urlSerializer.serialize(o.rawUrl),"",ps.IgnoredSameUrlNavigation)),o.resolve(!1),Vt;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return G(o).pipe(Be(f=>(this.events.next(new Jn(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),f.id!==this.navigationId?Vt:Promise.resolve(f))),QA(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,s.signal),He(f=>{r.targetSnapshot=f.targetSnapshot,r.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=f.urlAfterRedirects,g));let m=new ms(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(m)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:f,extractedUrl:m,source:g,restoredState:A,extras:C}=o,D=new Jn(f,this.urlSerializer.serialize(m),g,A);this.events.next(D);let R=Ny(this.rootComponentType).snapshot;return this.currentTransition=r=ye(O({},o),{targetSnapshot:R,urlAfterRedirects:m,extras:ye(O({},C),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(M=>(M.finalUrl=m,M)),G(r)}else return this.events.next(new jt(o.id,this.urlSerializer.serialize(o.extractedUrl),"",ps.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Vt}),He(o=>{let c=new ya(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(c)}),ce(o=>(this.currentTransition=r=ye(O({},o),{guards:hA(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),wA(this.environmentInjector,o=>this.events.next(o)),He(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw ka(this.urlSerializer,o.guardsResult);let c=new _a(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(c)}),Ut(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",ze.GuardRejected),!1)),Sl(o=>{if(o.guards.canActivateChecks.length!==0)return G(o).pipe(He(c=>{let u=new va(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),Be(c=>{let u=!1;return G(c).pipe(YA(this.paramsInheritanceStrategy,this.environmentInjector),He({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",ze.NoDataFromResolver)}}))}),He(c=>{let u=new Ia(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),Sl(o=>{let c=h=>{let f=[];if(h.routeConfig?._loadedComponent)h.component=h.routeConfig?._loadedComponent;else if(h.routeConfig?.loadComponent){let m=Hr(h)??this.environmentInjector;f.push(this.configLoader.loadComponent(m,h.routeConfig).then(g=>{h.component=g}))}for(let m of h.children)f.push(...c(m));return f},u=c(o.targetSnapshot.root);return u.length===0?G(o):xe(Promise.all(u).then(()=>o))}),Sl(()=>this.afterPreactivation()),Be(()=>{let{currentSnapshot:o,targetSnapshot:c}=r,u=this.createViewTransition?.(this.environmentInjector,o.root,c.root);return u?xe(u).pipe(ce(()=>r)):G(r)}),ce(o=>{let c=oA(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=ye(O({},o),{targetRouterState:c}),this.currentNavigation.update(u=>(u.targetRouterState=c,u)),r}),He(()=>{this.events.next(new gs)}),lA(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Dr(1),jo(jy(s.signal).pipe(Ut(()=>!i&&!r.targetRouterState),He(()=>{this.cancelNavigationTransition(r,s.signal.reason+"",ze.Aborted)}))),He({next:o=>{i=!0,this.currentNavigation.update(c=>(c.abort=rS,c)),this.lastSuccessfulNavigation.set(Ft(this.currentNavigation)),this.events.next(new vt(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),jo(this.transitionAbortWithErrorSubject.pipe(He(o=>{throw o}))),Fo(()=>{s.abort(),i||this.cancelNavigationTransition(r,"",ze.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),kr(o=>{if(this.destroyed)return r.resolve(!1),Vt;if(i=!0,Uy(o))this.events.next(new _t(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),uA(o)?this.events.next(new $r(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let c=new Br(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let u=ke(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(u instanceof zr){let{message:h,cancellationCode:f}=ka(this.urlSerializer,u);this.events.next(new _t(r.id,this.urlSerializer.serialize(r.extractedUrl),h,f)),this.events.next(new $r(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(c),o}catch(u){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(u)}}return Vt}))}))}cancelNavigationTransition(t,r,i){let s=new _t(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Ft(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function iS(n){return n!==hs}var n_=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>L(sS),providedIn:"root"})}return n})(),Na=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},sS=(()=>{class n extends Na{static \u0275fac=(()=>{let t;return function(i){return(t||(t=qo(n)))(i||n)}})();static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ql=(()=>{class n{urlSerializer=L(Es);options=L(Kr,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=L(Jo);urlHandlingStrategy=L(La);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new lt;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof lt?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=Ny(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>L(r_),providedIn:"root"})}return n})(),r_=(()=>{class n extends ql{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof Jn?this.updateStateMemento():t instanceof jt?this.commitTransition(r):t instanceof ms?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof gs?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof _t&&t.code!==ze.SupersededByNewNavigation&&t.code!==ze.Redirect?this.restoreHistory(r):t instanceof Br?this.restoreHistory(r,!0):t instanceof vt&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let c=this.browserPageId,u=O(O({},o),this.generateNgRouterState(i,c));this.location.replaceState(t,"",u)}else{let c=O(O({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",c)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=qo(n)))(i||n)}})();static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Hl(n,e){n.events.pipe(Ut(t=>t instanceof vt||t instanceof _t||t instanceof Br||t instanceof jt),ce(t=>t instanceof vt||t instanceof jt?0:(t instanceof _t?t.code===ze.Redirect||t.code===ze.SupersededByNewNavigation:!1)?2:1),Ut(t=>t!==2),Dr(1)).subscribe(()=>{e()})}var oS={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},aS={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Yn=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=L(Sg);stateManager=L(ql);options=L(Kr,{optional:!0})||{};pendingTasks=L(pg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=L(t_);urlSerializer=L(Es);location=L(Jo);urlHandlingStrategy=L(La);injector=L(at);_events=new $n;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=L(n_);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=L(Ts,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!L(Oa,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new ng;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=Ft(this.navigationTransitions.currentNavigation);if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof _t&&r.code!==ze.Redirect&&r.code!==ze.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof vt)this.navigated=!0;else if(r instanceof $r){let o=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u=O({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||iS(i.source)},o);this.scheduleNavigation(c,hs,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}nA(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),hs,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let u=O({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(s.state=u)}let c=this.parseUrl(t);this.scheduleNavigation(c,r,o,s).catch(u=>{this.disposed||this.injector.get($o)(u)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Ft(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map($l),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=u?this.currentUrlTree.fragment:o,f=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":f=O(O({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}f!==null&&(f=this.removeEmptyProps(f));let m;try{let g=i?i.snapshot:this.routerState.snapshot.root;m=Cy(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return Py(m,t,f,h??null,this.urlSerializer)}navigateByUrl(t,r={skipLocationChange:!1}){let i=pn(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,hs,null,r)}navigate(t,r={skipLocationChange:!1}){return cS(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(rl(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=O({},oS):r===!1?i=O({},aS):i=r,pn(t))return ay(this.currentUrlTree,t,i);let s=this.parseUrl(t);return ay(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((m,g)=>{c=m,u=g});let f=this.pendingTasks.add();return Hl(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(m=>Promise.reject(m))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function cS(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new se(4008,!1)}var i_=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=ln(null);get href(){return Ft(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new $n;applicationErrorHandler=L($o);options=L(Kr,{optional:!0});constructor(t,r,i,s,o,c){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=c,this.reactiveHref.set(L(new Mg("href"),{optional:!0}));let u=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area"||!!(typeof customElements=="object"&&customElements.get(u)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,r=i=>i==="merge"||i==="preserve";t||=r(this.queryParamsHandling),t||=!this.queryParamsHandling&&!r(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(i=>{i instanceof vt&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(pn(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,s,o){let c=this.urlTree;if(c===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u)?.catch(h=>{this.applicationErrorHandler(h)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:pn(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(Lr(Yn),Lr(Bt),mg("tabindex"),Lr(wg),Lr(gg),Lr(jg))};static \u0275dir=Go({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){r&1&&Ng("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&kg("href",i.reactiveHref(),vg)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Ko],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Ko],replaceUrl:[2,"replaceUrl","replaceUrl",Ko],routerLink:"routerLink"},features:[zo]})}return n})();var lS=new ne("");function hS(n,...e){return ot([{provide:Ts,multi:!0,useValue:n},[],{provide:Bt,useFactory:dS},{provide:Cg,multi:!0,useFactory:fS},e.map(t=>t.\u0275providers)])}function dS(){return L(Yn).routerState.root}function fS(){let n=L(ct);return e=>{let t=n.get(Pg);if(e!==t.components[0])return;let r=n.get(Yn),i=n.get(pS);n.get(mS)===1&&r.initialNavigation(),n.get(gS,null,{optional:!0})?.setUpPreloading(),n.get(lS,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var pS=new ne("",{factory:()=>new $n}),mS=new ne("",{factory:()=>1});var gS=new ne("");var s_=()=>{};var c_=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},yS=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},xa={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,f=s>>2,m=(s&3)<<4|c>>4,g=(c&15)<<2|h>>6,A=h&63;u||(A=64,o||(g=64)),r.push(t[f],t[m],t[g],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(c_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||m==null)throw new Gl;let g=s<<2|c>>4;if(r.push(g),h!==64){let A=c<<4&240|h>>2;if(r.push(A),m!==64){let C=h<<6&192|m;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Gl=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},_S=function(n){let e=c_(n);return xa.encodeByteArray(e,!0)},As=function(n){return _S(n).replace(/\./g,"")},Va=function(n){try{return xa.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Jl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var vS=()=>Jl().__FIREBASE_DEFAULTS__,IS=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ES=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Va(n[1]);return e&&JSON.parse(e)},Ua=()=>{try{return s_()||vS()||IS()||ES()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ql=n=>{var e,t;return(t=(e=Ua())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},u_=n=>{let e=Ql(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Yl=()=>{var n;return(n=Ua())===null||n===void 0?void 0:n.config},Xl=n=>{var e;return(e=Ua())===null||e===void 0?void 0:e[`_${n}`]};var Xn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function mn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Fa(n){return(await fetch(n,{credentials:"include"})).ok}function l_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[As(JSON.stringify(t)),As(JSON.stringify(o)),""].join(".")}var bs={};function wS(){let n={prod:[],emulator:[]};for(let e of Object.keys(bs))bs[e]?n.emulator.push(e):n.prod.push(e);return n}function TS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var o_=!1;function ja(n,e){if(typeof window>"u"||typeof document>"u"||!mn(window.location.host)||bs[n]===e||bs[n]||o_)return;bs[n]=e;function t(g){return`__firebase__banner__${g}`}let r="__firebase__banner",s=wS().prod.length>0;function o(){let g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,A){g.setAttribute("width","24"),g.setAttribute("id",A),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){let g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{o_=!0,o()},g}function f(g,A){g.setAttribute("id",A),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){let g=TS(r),A=t("text"),C=document.getElementById(A)||document.createElement("span"),D=t("learnmore"),R=document.getElementById(D)||document.createElement("a"),M=t("preprendIcon"),V=document.getElementById(M)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){let F=g.element;c(F),f(R,D);let $=h();u(V,M),F.append(V,C,R,$),document.body.appendChild(F)}s?(C.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Se(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function h_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Se())}function bS(){var n;let e=(n=Ua())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function d_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function f_(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function p_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function m_(){let n=Se();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function g_(){return!bS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ss(){try{return typeof indexedDB=="object"}catch{return!1}}function y_(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var AS="FirebaseError",Qe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=AS,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ht.prototype.create)}},ht=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?SS(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Qe(i,c,r)}};function SS(n,e){return n.replace(RS,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var RS=/\{\$([^}]+)}/g;function __(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function It(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(a_(s)&&a_(o)){if(!It(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function a_(n){return n!==null&&typeof n=="object"}function Rs(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Jr(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Qr(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function v_(n,e){let t=new Kl(n,e);return t.subscribe.bind(t)}var Kl=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");CS(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Wl),i.error===void 0&&(i.error=Wl),i.complete===void 0&&(i.complete=Wl);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function CS(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Wl(){}var wL=14400*1e3;function _e(n){return n&&n._delegate?n._delegate:n}var qe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Zn="[DEFAULT]";var Zl=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Xn;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kS(e))try{this.getOrInitializeService({instanceIdentifier:Zn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Zn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zn){return this.instances.has(e)}getOptions(e=Zn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:PS(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Zn){return this.component?this.component.multipleInstances?e:Zn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function PS(n){return n===Zn?void 0:n}function kS(n){return n.instantiationMode==="EAGER"}var Ba=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Zl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var DS=[],Q=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(Q||{}),NS={debug:Q.DEBUG,verbose:Q.VERBOSE,info:Q.INFO,warn:Q.WARN,error:Q.ERROR,silent:Q.SILENT},OS=Q.INFO,MS={[Q.DEBUG]:"log",[Q.VERBOSE]:"log",[Q.INFO]:"info",[Q.WARN]:"warn",[Q.ERROR]:"error"},LS=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=MS[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Et=class{constructor(e){this.name=e,this._logLevel=OS,this._logHandler=LS,this._userLogHandler=null,DS.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?NS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Q.DEBUG,...e),this._logHandler(this,Q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Q.VERBOSE,...e),this._logHandler(this,Q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Q.INFO,...e),this._logHandler(this,Q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Q.WARN,...e),this._logHandler(this,Q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Q.ERROR,...e),this._logHandler(this,Q.ERROR,...e)}};var xS=(n,e)=>e.some(t=>n instanceof t),I_,E_;function VS(){return I_||(I_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function US(){return E_||(E_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var w_=new WeakMap,th=new WeakMap,T_=new WeakMap,eh=new WeakMap,rh=new WeakMap;function FS(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(wt(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&w_.set(t,n)}).catch(()=>{}),rh.set(e,n),e}function jS(n){if(th.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});th.set(n,e)}var nh={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return th.get(n);if(e==="objectStoreNames")return n.objectStoreNames||T_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return wt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function b_(n){nh=n(nh)}function BS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call($a(this),e,...t);return T_.set(r,e.sort?e.sort():[e]),wt(r)}:US().includes(n)?function(...e){return n.apply($a(this),e),wt(w_.get(this))}:function(...e){return wt(n.apply($a(this),e))}}function $S(n){return typeof n=="function"?BS(n):(n instanceof IDBTransaction&&jS(n),xS(n,VS())?new Proxy(n,nh):n)}function wt(n){if(n instanceof IDBRequest)return FS(n);if(eh.has(n))return eh.get(n);let e=$S(n);return e!==n&&(eh.set(n,e),rh.set(e,n)),e}var $a=n=>rh.get(n);function za(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),c=wt(o);return r&&o.addEventListener("upgradeneeded",u=>{r(wt(o.result),u.oldVersion,u.newVersion,wt(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}var zS=["get","getKey","getAll","getAllKeys","count"],qS=["put","add","delete","clear"],ih=new Map;function A_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ih.get(e))return ih.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=qS.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||zS.includes(t)))return;let s=async function(o,...c){let u=this.transaction(o,i?"readwrite":"readonly"),h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),i&&u.done]))[0]};return ih.set(e,s),s}b_(n=>ye(O({},n),{get:(e,t,r)=>A_(e,t)||n.get(e,t,r),has:(e,t)=>!!A_(e,t)||n.has(e,t)}));var oh=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(HS(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function HS(n){let e=n.getComponent();return e?.type==="VERSION"}var ah="@firebase/app",S_="0.13.2";var $t=new Et("@firebase/app"),WS="@firebase/app-compat",GS="@firebase/analytics-compat",KS="@firebase/analytics",JS="@firebase/app-check-compat",QS="@firebase/app-check",YS="@firebase/auth",XS="@firebase/auth-compat",ZS="@firebase/database",eR="@firebase/data-connect",tR="@firebase/database-compat",nR="@firebase/functions",rR="@firebase/functions-compat",iR="@firebase/installations",sR="@firebase/installations-compat",oR="@firebase/messaging",aR="@firebase/messaging-compat",cR="@firebase/performance",uR="@firebase/performance-compat",lR="@firebase/remote-config",hR="@firebase/remote-config-compat",dR="@firebase/storage",fR="@firebase/storage-compat",pR="@firebase/firestore",mR="@firebase/ai",gR="@firebase/firestore-compat",yR="firebase",_R="11.10.0";var ch="[DEFAULT]",vR={[ah]:"fire-core",[WS]:"fire-core-compat",[KS]:"fire-analytics",[GS]:"fire-analytics-compat",[QS]:"fire-app-check",[JS]:"fire-app-check-compat",[YS]:"fire-auth",[XS]:"fire-auth-compat",[ZS]:"fire-rtdb",[eR]:"fire-data-connect",[tR]:"fire-rtdb-compat",[nR]:"fire-fn",[rR]:"fire-fn-compat",[iR]:"fire-iid",[sR]:"fire-iid-compat",[oR]:"fire-fcm",[aR]:"fire-fcm-compat",[cR]:"fire-perf",[uR]:"fire-perf-compat",[lR]:"fire-rc",[hR]:"fire-rc-compat",[dR]:"fire-gcs",[fR]:"fire-gcs-compat",[pR]:"fire-fst",[gR]:"fire-fst-compat",[mR]:"fire-vertex","fire-js":"fire-js",[yR]:"fire-js-all"};var Cs=new Map,IR=new Map,uh=new Map;function R_(n,e){try{n.container.addComponent(e)}catch(t){$t.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function dt(n){let e=n.name;if(uh.has(e))return $t.debug(`There were multiple attempts to register component ${e}.`),!1;uh.set(e,n);for(let t of Cs.values())R_(t,n);for(let t of IR.values())R_(t,n);return!0}function Yr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function We(n){return n==null?!1:n.settings!==void 0}var ER={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},gn=new ht("app","Firebase",ER);var lh=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gn.create("app-deleted",{appName:this._name})}};var yn=_R;function fh(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ch,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw gn.create("bad-app-name",{appName:String(i)});if(t||(t=Yl()),!t)throw gn.create("no-options");let s=Cs.get(i);if(s){if(It(t,s.options)&&It(r,s.config))return s;throw gn.create("duplicate-app",{appName:i})}let o=new Ba(i);for(let u of uh.values())o.addComponent(u);let c=new lh(t,r,o);return Cs.set(i,c),c}function er(n=ch){let e=Cs.get(n);if(!e&&n===ch&&Yl())return fh();if(!e)throw gn.create("no-app",{appName:n});return e}function qa(){return Array.from(Cs.values())}function pe(n,e,t){var r;let i=(r=vR[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$t.warn(c.join(" "));return}dt(new qe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var wR="firebase-heartbeat-database",TR=1,Ps="firebase-heartbeat-store",sh=null;function D_(){return sh||(sh=za(wR,TR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ps)}catch(t){console.warn(t)}}}}).catch(n=>{throw gn.create("idb-open",{originalErrorMessage:n.message})})),sh}async function bR(n){try{let t=(await D_()).transaction(Ps),r=await t.objectStore(Ps).get(N_(n));return await t.done,r}catch(e){if(e instanceof Qe)$t.warn(e.message);else{let t=gn.create("idb-get",{originalErrorMessage:e?.message});$t.warn(t.message)}}}async function C_(n,e){try{let r=(await D_()).transaction(Ps,"readwrite");await r.objectStore(Ps).put(e,N_(n)),await r.done}catch(t){if(t instanceof Qe)$t.warn(t.message);else{let r=gn.create("idb-set",{originalErrorMessage:t?.message});$t.warn(r.message)}}}function N_(n){return`${n.name}!${n.options.appId}`}var AR=1024,SR=30,hh=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new dh(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=P_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>SR){let o=CR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){$t.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=P_(),{heartbeatsToSend:r,unsentEntries:i}=RR(this._heartbeatsCache.heartbeats),s=As(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return $t.warn(t),""}}};function P_(){return new Date().toISOString().substring(0,10)}function RR(n,e=AR){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),k_(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),k_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var dh=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ss()?y_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await bR(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return C_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return C_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function k_(n){return As(JSON.stringify({version:2,heartbeats:n})).length}function CR(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function PR(n){dt(new qe("platform-logger",e=>new oh(e),"PRIVATE")),dt(new qe("heartbeat",e=>new hh(e),"PRIVATE")),pe(ah,S_,n),pe(ah,S_,"esm2017"),pe("fire-js","")}PR("");var kR="firebase",DR="11.10.0";pe(kR,DR,"app");function O_(n){n===void 0&&(n=L(ct));let e=n.get(Or);return t=>new st(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let c=t.subscribe({next:u=>{r.next(u),o()},complete:()=>{r.complete(),o()},error:u=>{r.error(u),o()}});return c.add(()=>{r.unsubscribe(),o()}),c})}var _n=new lg("ANGULARFIRE2_VERSION");function ks(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Zr=(n,e)=>{let t=e?[e]:qa(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Xr=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(Xr||{}),M_=cl()&&typeof Zone<"u"?Xr.WARN:Xr.SILENT;var Ha=class{zone;delegate;constructor(e,t=sg){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},vn=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=L($e);this.outsideAngular=t.runOutsideAngular(()=>new Ha(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Ha(typeof Zone>"u"?void 0:Zone.current,ig))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),L_=!1;function NR(n,e){!L_&&(M_>Xr.SILENT||cl())&&(L_=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),M_>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function OR(n){let e=L($e,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function tr(n){let e=L($e,{optional:!0});return e?e.run(()=>n()):n()}var MR=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),ke(t,()=>tr(()=>n.apply(void 0,r)))),Te=(n,e,t)=>(t||=e?Xr.WARN:Xr.VERBOSE,function(){let r,i=arguments,s,o,c;try{s=L(vn),o=L(Or),c=L(at)}catch{return NR(n,t),n.apply(this,i)}for(let h=0;h<arguments.length;h++)typeof i[h]=="function"&&(e&&(r||=tr(()=>o.add())),i[h]=MR(i[h],r,c));let u=OR(()=>n.apply(this,i));return e?u instanceof st?u.pipe(el(s.outsideAngular),Zu(s.insideAngular),O_(c)):u instanceof Promise?tr(()=>{let h=o.add();return new Promise((f,m)=>{u.then(g=>ke(c,()=>tr(()=>f(g))),g=>ke(c,()=>tr(()=>m(g)))).finally(h)})}):typeof u=="function"&&r?function(){return setTimeout(r,0),u.apply(this,arguments)}:tr(()=>u):u instanceof st?u.pipe(el(s.outsideAngular),Zu(s.insideAngular)):tr(()=>u)});var zt=class{constructor(e){return e}},nr=class{constructor(){return qa()}};function LR(n){return n&&n.length===1?n[0]:new zt(er())}var ph=new ne("angularfire2._apps"),xR={provide:zt,useFactory:LR,deps:[[new tt,ph]]},VR={provide:nr,deps:[[new tt,ph]]};function UR(n){return(e,t)=>{let r=t.get(Mr);pe("angularfire",_n.full,"core"),pe("angularfire",_n.full,"app"),pe("angular",hg.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new zt(i)}}function mx(n,...e){return ot([xR,VR,{provide:ph,useFactory:UR(n),multi:!0,deps:[$e,ct,vn,...e]}])}var gx=Te(fh,!0);var FR=new Map,jR={activated:!1,tokenObservers:[]},BR={initialized:!1,enabled:!1};function ft(n){return FR.get(n)||Object.assign({},jR)}function F_(){return BR}var $R="https://content-firebaseappcheck.googleapis.com/v1";var zR="exchangeDebugToken",x_={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},Ax=1440*60*1e3;var yh=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Xn,this.pending.promise.catch(t=>{}),await qR(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Xn,this.pending.promise.catch(t=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function qR(n){return new Promise(e=>{setTimeout(e,n)})}var HR={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},In=new ht("appCheck","AppCheck",HR);function j_(n){if(!ft(n).activated)throw In.create("use-before-activation",{appName:n.name})}async function B_({url:n,body:e},t){let r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){let m=await i.getHeartbeatsHeader();m&&(r["X-Firebase-Client"]=m)}let s={method:"POST",body:JSON.stringify(e),headers:r},o;try{o=await fetch(n,s)}catch(m){throw In.create("fetch-network-error",{originalErrorMessage:m?.message})}if(o.status!==200)throw In.create("fetch-status-error",{httpStatus:o.status});let c;try{c=await o.json()}catch(m){throw In.create("fetch-parse-error",{originalErrorMessage:m?.message})}let u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw In.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let h=Number(u[1])*1e3,f=Date.now();return{token:c.token,expireTimeMillis:f+h,issuedAtTimeMillis:f}}function $_(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${$R}/projects/${t}/apps/${r}:${zR}?key=${i}`,body:{debug_token:e}}}var WR="firebase-app-check-database",GR=1,_h="firebase-app-check-store";var Wa=null;function KR(){return Wa||(Wa=new Promise((n,e)=>{try{let t=indexedDB.open(WR,GR);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(In.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(_h,{keyPath:"compositeKey"})}}}catch(t){e(In.create("storage-open",{originalErrorMessage:t?.message}))}}),Wa)}function JR(n,e){return QR(YR(n),e)}async function QR(n,e){let r=(await KR()).transaction(_h,"readwrite"),s=r.objectStore(_h).put({compositeKey:n,value:e});return new Promise((o,c)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var h;c(In.create("storage-set",{originalErrorMessage:(h=u.target.error)===null||h===void 0?void 0:h.message}))}})}function YR(n){return`${n.options.appId}-${n.name}`}var Ds=new Et("@firebase/app-check");function mh(n,e){return Ss()?JR(n,e).catch(t=>{Ds.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function z_(){return F_().enabled}async function q_(){let n=F_();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}var XR={error:"UNKNOWN_ERROR"};function ZR(n){return xa.encodeString(JSON.stringify(n),!1)}async function vh(n,e=!1,t=!1){let r=n.app;j_(r);let i=ft(r),s=i.token,o;if(s&&!Ns(s)&&(i.token=void 0,s=void 0),!s){let h=await i.cachedTokenPromise;h&&(Ns(h)?s=h:await mh(r,void 0))}if(!e&&s&&Ns(s))return{token:s.token};let c=!1;if(z_())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=B_($_(r,await q_()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),c=!0);let h=await i.exchangeTokenPromise;return await mh(r,h),i.token=h,{token:h.token}}catch(h){return h.code==="appCheck/throttled"||h.code==="appCheck/initial-throttle"?Ds.warn(h.message):t&&Ds.error(h),gh(h)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),c=!0),s=await ft(r).exchangeTokenPromise}catch(h){h.code==="appCheck/throttled"||h.code==="appCheck/initial-throttle"?Ds.warn(h.message):t&&Ds.error(h),o=h}let u;return s?o?Ns(s)?u={token:s.token,internalError:o}:u=gh(o):(u={token:s.token},i.token=s,await mh(r,s)):u=gh(o),c&&rC(r,u),u}async function eC(n){let e=n.app;j_(e);let{provider:t}=ft(e);if(z_()){let r=await q_(),{token:i}=await B_($_(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=await t.getToken();return{token:r}}}function tC(n,e,t,r){let{app:i}=n,s=ft(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ns(s.token)){let c=s.token;Promise.resolve().then(()=>{t({token:c.token}),V_(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>V_(n))}function H_(n,e){let t=ft(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function V_(n){let{app:e}=n,t=ft(e),r=t.tokenRefresher;r||(r=nC(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function nC(n){let{app:e}=n;return new yh(async()=>{let t=ft(e),r;if(t.token?r=await vh(n,!0):r=await vh(n),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{let t=ft(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},x_.RETRIAL_MIN_WAIT,x_.RETRIAL_MAX_WAIT)}function rC(n,e){let t=ft(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ns(n){return n.expireTimeMillis-Date.now()>0}function gh(n){return{token:ZR(XR),error:n}}var Ih=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=ft(this.app);for(let t of e)H_(this.app,t.next);return Promise.resolve()}};function iC(n,e){return new Ih(n,e)}function sC(n){return{getToken:e=>vh(n,e),getLimitedUseToken:()=>eC(n),addTokenListener:e=>tC(n,"INTERNAL",e),removeTokenListener:e=>H_(n.app,e)}}var oC="@firebase/app-check",aC="0.10.1";var cC="app-check",U_="app-check-internal";function uC(){dt(new qe(cC,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return iC(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(U_).initialize()})),dt(new qe(U_,n=>{let e=n.getProvider("app-check").getImmediate();return sC(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),pe(oC,aC)}uC();var lC="app-check";var ei=class{constructor(){return Zr(lC)}};var hC=["localhost","0.0.0.0","127.0.0.1"],Vx=typeof window<"u"&&hC.includes(window.location.hostname);var W_=()=>{};var J_=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},dC=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Q_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,f=s>>2,m=(s&3)<<4|c>>4,g=(c&15)<<2|h>>6,A=h&63;u||(A=64,o||(g=64)),r.push(t[f],t[m],t[g],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(J_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):dC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||m==null)throw new wh;let g=s<<2|c>>4;if(r.push(g),h!==64){let A=c<<4&240|h>>2;if(r.push(A),m!==64){let C=h<<6&192|m;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},wh=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},fC=function(n){let e=J_(n);return Q_.encodeByteArray(e,!0)},Ms=function(n){return fC(n).replace(/\./g,"")},Ka=function(n){try{return Q_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function pC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var mC=()=>pC().__FIREBASE_DEFAULTS__,gC=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},yC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Ka(n[1]);return e&&JSON.parse(e)},Ja=()=>{try{return W_()||mC()||gC()||yC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Y_=n=>Ja()?.emulatorHosts?.[n],$x=n=>{let e=Y_(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},bh=()=>Ja()?.config,X_=n=>Ja()?.[`_${n}`];var Ga=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Qa(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _C(n){return(await fetch(n,{credentials:"include"})).ok}function zx(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=O({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ms(JSON.stringify(t)),Ms(JSON.stringify(o)),""].join(".")}var Os={};function vC(){let n={prod:[],emulator:[]};for(let e of Object.keys(Os))Os[e]?n.emulator.push(e):n.prod.push(e);return n}function IC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var G_=!1;function EC(n,e){if(typeof window>"u"||typeof document>"u"||!Qa(window.location.host)||Os[n]===e||Os[n]||G_)return;Os[n]=e;function t(g){return`__firebase__banner__${g}`}let r="__firebase__banner",s=vC().prod.length>0;function o(){let g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,A){g.setAttribute("width","24"),g.setAttribute("id",A),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){let g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{G_=!0,o()},g}function f(g,A){g.setAttribute("id",A),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){let g=IC(r),A=t("text"),C=document.getElementById(A)||document.createElement("span"),D=t("learnmore"),R=document.getElementById(D)||document.createElement("a"),M=t("preprendIcon"),V=document.getElementById(M)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){let F=g.element;c(F),f(R,D);let $=h();u(V,M),F.append(V,C,R,$),document.body.appendChild(F)}s?(C.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function pt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Z_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pt())}function wC(){let n=Ja()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ev(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tv(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function nv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function qx(){return!wC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rv(){try{return typeof indexedDB=="object"}catch{return!1}}function iv(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var TC="FirebaseError",Tt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=TC,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qt.prototype.create)}},qt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?bC(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Tt(i,c,r)}};function bC(n,e){return n.replace(AC,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var AC=/\{\$([^}]+)}/g;function Ls(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(K_(s)&&K_(o)){if(!Ls(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function K_(n){return n!==null&&typeof n=="object"}function Ah(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function sv(n,e){let t=new Th(n,e);return t.subscribe.bind(t)}var Th=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");SC(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Eh),i.error===void 0&&(i.error=Eh),i.complete===void 0&&(i.complete=Eh);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function SC(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Eh(){}var Hx=14400*1e3;function ti(n){return n&&n._delegate?n._delegate:n}var bt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var rr="[DEFAULT]";var Sh=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Ga;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(CC(e))try{this.getOrInitializeService({instanceIdentifier:rr})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=rr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rr){return this.instances.has(e)}getOptions(e=rr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:RC(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=rr){return this.component?this.component.multipleInstances?e:rr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function RC(n){return n===rr?void 0:n}function CC(n){return n.instantiationMode==="EAGER"}var Ya=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Sh(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var PC=[],ue=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(ue||{}),kC={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},DC=ue.INFO,NC={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},OC=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=NC[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ni=class{constructor(e){this.name=e,this._logLevel=DC,this._logHandler=OC,this._userLogHandler=null,PC.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}};var Ch=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(MC(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function MC(n){return n.getComponent()?.type==="VERSION"}var Ph="@firebase/app",ov="0.14.6";var Ht=new ni("@firebase/app"),LC="@firebase/app-compat",xC="@firebase/analytics-compat",VC="@firebase/analytics",UC="@firebase/app-check-compat",FC="@firebase/app-check",jC="@firebase/auth",BC="@firebase/auth-compat",$C="@firebase/database",zC="@firebase/data-connect",qC="@firebase/database-compat",HC="@firebase/functions",WC="@firebase/functions-compat",GC="@firebase/installations",KC="@firebase/installations-compat",JC="@firebase/messaging",QC="@firebase/messaging-compat",YC="@firebase/performance",XC="@firebase/performance-compat",ZC="@firebase/remote-config",eP="@firebase/remote-config-compat",tP="@firebase/storage",nP="@firebase/storage-compat",rP="@firebase/firestore",iP="@firebase/ai",sP="@firebase/firestore-compat",oP="firebase",aP="12.6.0";var kh="[DEFAULT]",cP={[Ph]:"fire-core",[LC]:"fire-core-compat",[VC]:"fire-analytics",[xC]:"fire-analytics-compat",[FC]:"fire-app-check",[UC]:"fire-app-check-compat",[jC]:"fire-auth",[BC]:"fire-auth-compat",[$C]:"fire-rtdb",[zC]:"fire-data-connect",[qC]:"fire-rtdb-compat",[HC]:"fire-fn",[WC]:"fire-fn-compat",[GC]:"fire-iid",[KC]:"fire-iid-compat",[JC]:"fire-fcm",[QC]:"fire-fcm-compat",[YC]:"fire-perf",[XC]:"fire-perf-compat",[ZC]:"fire-rc",[eP]:"fire-rc-compat",[tP]:"fire-gcs",[nP]:"fire-gcs-compat",[rP]:"fire-fst",[sP]:"fire-fst-compat",[iP]:"fire-vertex","fire-js":"fire-js",[oP]:"fire-js-all"};var xs=new Map,uP=new Map,Dh=new Map;function av(n,e){try{n.container.addComponent(e)}catch(t){Ht.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ii(n){let e=n.name;if(Dh.has(e))return Ht.debug(`There were multiple attempts to register component ${e}.`),!1;Dh.set(e,n);for(let t of xs.values())av(t,n);for(let t of uP.values())av(t,n);return!0}function lP(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ir(n){return n==null?!1:n.settings!==void 0}var hP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},En=new qt("app","Firebase",hP);var Nh=class{constructor(e,t,r){this._isDeleted=!1,this._options=O({},e),this._config=O({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw En.create("app-deleted",{appName:this._name})}};var Xa=aP;function dP(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=O({name:kh,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw En.create("bad-app-name",{appName:String(i)});if(t||(t=bh()),!t)throw En.create("no-options");let s=xs.get(i);if(s){if(Ls(t,s.options)&&Ls(r,s.config))return s;throw En.create("duplicate-app",{appName:i})}let o=new Ya(i);for(let u of Dh.values())o.addComponent(u);let c=new Nh(t,r,o);return xs.set(i,c),c}function fP(n=kh){let e=xs.get(n);if(!e&&n===kh&&bh())return dP();if(!e)throw En.create("no-app",{appName:n});return e}function sV(){return Array.from(xs.values())}function ri(n,e,t){let r=cP[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ht.warn(o.join(" "));return}ii(new bt(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var pP="firebase-heartbeat-database",mP=1,Vs="firebase-heartbeat-store",Rh=null;function hv(){return Rh||(Rh=za(pP,mP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Vs)}catch(t){console.warn(t)}}}}).catch(n=>{throw En.create("idb-open",{originalErrorMessage:n.message})})),Rh}async function gP(n){try{let t=(await hv()).transaction(Vs),r=await t.objectStore(Vs).get(dv(n));return await t.done,r}catch(e){if(e instanceof Tt)Ht.warn(e.message);else{let t=En.create("idb-get",{originalErrorMessage:e?.message});Ht.warn(t.message)}}}async function cv(n,e){try{let r=(await hv()).transaction(Vs,"readwrite");await r.objectStore(Vs).put(e,dv(n)),await r.done}catch(t){if(t instanceof Tt)Ht.warn(t.message);else{let r=En.create("idb-set",{originalErrorMessage:t?.message});Ht.warn(r.message)}}}function dv(n){return`${n.name}!${n.options.appId}`}var yP=1024,_P=30,Oh=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Mh(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=uv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>_P){let i=IP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ht.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=uv(),{heartbeatsToSend:t,unsentEntries:r}=vP(this._heartbeatsCache.heartbeats),i=Ms(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ht.warn(e),""}}};function uv(){return new Date().toISOString().substring(0,10)}function vP(n,e=yP){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),lv(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),lv(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Mh=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rv()?iv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await gP(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return cv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return cv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function lv(n){return Ms(JSON.stringify({version:2,heartbeats:n})).length}function IP(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function EP(n){ii(new bt("platform-logger",e=>new Ch(e),"PRIVATE")),ii(new bt("heartbeat",e=>new Oh(e),"PRIVATE")),ri(Ph,ov,n),ri(Ph,ov,"esm2020"),ri("fire-js","")}EP("");function Iv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Ev=Iv,wv=new qt("auth","Firebase",Iv());var nc=new ni("@firebase/auth");function wP(n,...e){nc.logLevel<=ue.WARN&&nc.warn(`Auth (${Xa}): ${n}`,...e)}function ec(n,...e){nc.logLevel<=ue.ERROR&&nc.error(`Auth (${Xa}): ${n}`,...e)}function fv(n,...e){throw Wh(n,...e)}function Hh(n,...e){return Wh(n,...e)}function Tv(n,e,t){let r=ye(O({},Ev()),{[e]:t});return new qt("auth","Firebase",r).create(e,{appName:n.name})}function tc(n){return Tv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Wh(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return wv.create(n,...e)}function ie(n,e,...t){if(!n)throw Wh(e,...t)}function Us(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ec(e),new Error(e)}function rc(n,e){n||Us(e)}function TP(){return pv()==="http:"||pv()==="https:"}function pv(){return typeof self<"u"&&self.location?.protocol||null}function bP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(TP()||tv()||"connection"in navigator)?navigator.onLine:!0}function AP(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var ar=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,rc(t>e,"Short delay should be less than long delay!"),this.isMobile=Z_()||nv()}get(){return bP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function SP(n,e){rc(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var ic=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Us("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Us("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Us("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var RP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var CP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],PP=new ar(3e4,6e4);function bv(n,e){return n.tenantId&&!e.tenantId?ye(O({},e),{tenantId:n.tenantId}):e}async function uc(n,e,t,r,i={}){return Av(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let c=Ah(O({key:n.config.apiKey},o)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);let h=O({method:e,headers:u},s);return ev()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Qa(n.emulatorConfig.host)&&(h.credentials="include"),ic.fetch()(await Sv(n,n.config.apiHost,t,c),h)})}async function Av(n,e,t){n._canInitEmulator=!1;let r=O(O({},RP),e);try{let i=new Vh(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw Za(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Za(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Za(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Za(n,"user-disabled",o);let f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Tv(n,f,h);fv(n,f)}}catch(i){if(i instanceof Tt)throw i;fv(n,"network-request-failed",{message:String(i)})}}async function Sv(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?SP(n.config,i):`${n.config.apiScheme}://${i}`;return CP.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}var Vh=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Hh(this.auth,"network-request-failed")),PP.get())})}};function Za(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Hh(n,e,r);return i.customData._tokenResponse=t,i}async function kP(n,e){return uc(n,"POST","/v1/accounts:delete",e)}async function sc(n,e){return uc(n,"POST","/v1/accounts:lookup",e)}function Fs(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Rv(n,e=!1){let t=ti(n),r=await t.getIdToken(e),i=Cv(r);ie(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Fs(Lh(i.auth_time)),issuedAtTime:Fs(Lh(i.iat)),expirationTime:Fs(Lh(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Lh(n){return Number(n)*1e3}function Cv(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ec("JWT malformed, contained fewer than 3 sections"),null;try{let i=Ka(t);return i?JSON.parse(i):(ec("Failed to decode base64 JWT payload"),null)}catch(i){return ec("Caught error parsing JWT payload as JSON",i?.toString()),null}}function mv(n){let e=Cv(n);return ie(e,"internal-error"),ie(typeof e.exp<"u","internal-error"),ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Uh(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Tt&&DP(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function DP({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Fh=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Bs=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fs(this.lastLoginAt),this.creationTime=Fs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function oc(n){let e=n.auth,t=await n.getIdToken(),r=await Uh(n,sc(e,{idToken:t}));ie(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let s=i.providerUserInfo?.length?kv(i.providerUserInfo):[],o=NP(n.providerData,s),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Bs(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function Pv(n){let e=ti(n);await oc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function NP(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function kv(n){return n.map(r=>{var i=r,{providerId:e}=i,t=Vo(i,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function OP(n,e){let t=await Av(n,{},async()=>{let r=Ah({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await Sv(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Qa(n.emulatorConfig.host)&&(u.credentials="include"),ic.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function MP(n,e){return uc(n,"POST","/v2/accounts:revokeToken",bv(n,e))}var js=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ie(e.idToken,"internal-error"),ie(typeof e.idToken<"u","internal-error"),ie(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):mv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ie(e.length!==0,"internal-error");let t=mv(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await OP(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(ie(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ie(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ie(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Us("not implemented")}};function wn(n,e){ie(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var sr=class n{constructor(s){var o=s,{uid:e,auth:t,stsTokenManager:r}=o,i=Vo(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Fh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Bs(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await Uh(this,this.stsTokenManager.getToken(this.auth,e));return ie(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Rv(this,e)}reload(){return Pv(this)}_assign(e){this!==e&&(ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>O({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(ye(O({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await oc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ir(this.auth.app))return Promise.reject(tc(this.auth));let e=await this.getIdToken();return await Uh(this,kP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return ye(O({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>O({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:A,providerData:C,stsTokenManager:D}=t;ie(m&&D,e,"internal-error");let R=js.fromJSON(this.name,D);ie(typeof m=="string",e,"internal-error"),wn(r,e.name),wn(i,e.name),ie(typeof g=="boolean",e,"internal-error"),ie(typeof A=="boolean",e,"internal-error"),wn(s,e.name),wn(o,e.name),wn(c,e.name),wn(u,e.name),wn(h,e.name),wn(f,e.name);let M=new n({uid:m,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:A,photoURL:o,phoneNumber:s,tenantId:c,stsTokenManager:R,createdAt:h,lastLoginAt:f});return C&&Array.isArray(C)&&(M.providerData=C.map(V=>O({},V))),u&&(M._redirectEventId=u),M}static async _fromIdTokenResponse(e,t,r=!1){let i=new js;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await oc(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];ie(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?kv(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new js;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Bs(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u}};var gv=new Map;function or(n){rc(n instanceof Function,"Expected a class definition");let e=gv.get(n);return e?(rc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,gv.set(n,e),e)}var LP=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),jh=LP;function xh(n,e,t){return`firebase:${n}:${e}:${t}`}var ac=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=xh(this.userKey,i.apiKey,s),this.fullPersistenceKey=xh("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await sc(this.auth,{idToken:e}).catch(()=>{});return t?sr._fromGetAccountInfoResponse(this.auth,t,e):null}return sr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(or(jh),e,r);let i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h),s=i[0]||or(jh),o=xh(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let f=await h._get(o);if(f){let m;if(typeof f=="string"){let g=await sc(e,{idToken:f}).catch(()=>{});if(!g)break;m=await sr._fromGetAccountInfoResponse(e,g,f)}else m=sr._fromJSON(e,f);h!==s&&(c=m),s=h;break}}catch{}let u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&await s._set(o,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new n(s,e,r))}};function yv(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(FP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BP(e))return"Blackberry";if($P(e))return"Webos";if(VP(e))return"Safari";if((e.includes("chrome/")||UP(e))&&!e.includes("edge/"))return"Chrome";if(jP(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function xP(n=pt()){return/firefox\//i.test(n)}function VP(n=pt()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function UP(n=pt()){return/crios\//i.test(n)}function FP(n=pt()){return/iemobile/i.test(n)}function jP(n=pt()){return/android/i.test(n)}function BP(n=pt()){return/blackberry/i.test(n)}function $P(n=pt()){return/webos/i.test(n)}function Dv(n,e=[]){let t;switch(n){case"Browser":t=yv(pt());break;case"Worker":t=`${yv(pt())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xa}/${r}`}var Bh=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let u=e(s);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function zP(n,e={}){return uc(n,"GET","/v2/passwordPolicy",bv(n,e))}var qP=6,$h=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??qP,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var zh=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cc(this),this.idTokenSubscription=new cc(this),this.beforeStateQueue=new Bh(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=or(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ac.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await sc(this,{idToken:e}),r=await sr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ir(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!s||s===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await oc(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=AP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ir(this.app))return Promise.reject(tc(this));let t=e?ti(e):null;return t&&ie(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ir(this.app)?Promise.reject(tc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ir(this.app)?Promise.reject(tc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(or(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await zP(this),t=new $h(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await MP(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&or(e)||this._popupRedirectResolver;ie(t,this,"argument-error"),this.redirectPersistenceManager=await ac.create(this,[or(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ie(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Dv(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ir(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&wP(`Error while retrieving App Check token: ${e.error}`),e?.token}};function HP(n){return ti(n)}var cc=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=sv(t=>this.observer=t)}get next(){return ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var WP={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function GP(n){WP=n}function KP(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function JP(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(or);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Gh(n,e,t,r){return ti(n).onIdTokenChanged(e,t,r)}var yV=KP("rcb"),_V=new ar(3e4,6e4);var vV=new ar(2e3,1e4);var IV=600*1e3;var EV=new ar(3e4,6e4);var wV=new ar(5e3,15e3);var TV=encodeURIComponent("fac");var _v="@firebase/auth",vv="1.12.0";var qh=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function QP(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function YP(n){ii(new bt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;ie(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Dv(n)},h=new zh(r,i,s,u);return JP(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ii(new bt("auth-internal",e=>{let t=HP(e.getProvider("auth").getImmediate());return(r=>new qh(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ri(_v,vv,QP(n)),ri(_v,vv,"esm2020")}var XP=300,bV=X_("authIdTokenMaxAge")||XP;function ZP(){return document.getElementsByTagName("head")?.[0]??document}GP({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Hh("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",ZP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});YP("Browser");function Nv(n){return new st(function(e){var t=Gh(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}function Kv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Jv=Kv,Qv=new ht("auth","Firebase",Kv());var mc=new Et("@firebase/auth");function n0(n,...e){mc.logLevel<=Q.WARN&&mc.warn(`Auth (${yn}): ${n}`,...e)}function hc(n,...e){mc.logLevel<=Q.ERROR&&mc.error(`Auth (${yn}): ${n}`,...e)}function St(n,...e){throw _d(n,...e)}function cr(n,...e){return _d(n,...e)}function Yv(n,e,t){let r=Object.assign(Object.assign({},Jv()),{[e]:t});return new ht("auth","Firebase",r).create(e,{appName:n.name})}function Kt(n){return Yv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _d(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Qv.create(n,...e)}function z(n,e,...t){if(!n)throw _d(e,...t)}function Wt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw hc(e),new Error(e)}function An(n,e){n||Wt(e)}function Yh(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function r0(){return Ov()==="http:"||Ov()==="https:"}function Ov(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function i0(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(r0()||f_()||"connection"in navigator)?navigator.onLine:!0}function s0(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var ur=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,An(t>e,"Short delay should be less than long delay!"),this.isMobile=h_()||p_()}get(){return i0()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function vd(n,e){An(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var gc=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var o0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var a0=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],c0=new ur(3e4,6e4);function Sn(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Rn(n,e,t,r,i={}){return Xv(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let c=Rs(Object.assign({key:n.config.apiKey},o)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);let h=Object.assign({method:e,headers:u},s);return d_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&mn(n.emulatorConfig.host)&&(h.credentials="include"),gc.fetch()(await Zv(n,n.config.apiHost,t,c),h)})}async function Xv(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},o0),e);try{let i=new Xh(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw lc(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw lc(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw lc(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw lc(n,"user-disabled",o);let f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Yv(n,f,h);St(n,f)}}catch(i){if(i instanceof Qe)throw i;St(n,"network-request-failed",{message:String(i)})}}async function Qs(n,e,t,r,i={}){let s=await Rn(n,e,t,r,i);return"mfaPendingCredential"in s&&St(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Zv(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?vd(n.config,i):`${n.config.apiScheme}://${i}`;return a0.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function u0(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Xh=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(cr(this.auth,"network-request-failed")),c0.get())})}};function lc(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=cr(n,e,r);return i.customData._tokenResponse=t,i}function Mv(n){return n!==void 0&&n.enterprise!==void 0}var Zh=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return u0(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function l0(n,e){return Rn(n,"GET","/v2/recaptchaConfig",Sn(n,e))}async function h0(n,e){return Rn(n,"POST","/v1/accounts:delete",e)}async function yc(n,e){return Rn(n,"POST","/v1/accounts:lookup",e)}function zs(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Id(n,e=!1){let t=_e(n),r=await t.getIdToken(e),i=Ed(r);z(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:zs(Kh(i.auth_time)),issuedAtTime:zs(Kh(i.iat)),expirationTime:zs(Kh(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Kh(n){return Number(n)*1e3}function Ed(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return hc("JWT malformed, contained fewer than 3 sections"),null;try{let i=Va(t);return i?JSON.parse(i):(hc("Failed to decode base64 JWT payload"),null)}catch(i){return hc("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Lv(n){let e=Ed(n);return z(e,"internal-error"),z(typeof e.exp<"u","internal-error"),z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Hs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Qe&&d0(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function d0({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ed=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Ws=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zs(this.lastLoginAt),this.creationTime=zs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function _c(n){var e;let t=n.auth,r=await n.getIdToken(),i=await Hs(n,yc(t,{idToken:r}));z(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?eI(s.providerUserInfo):[],c=f0(n.providerData,o),u=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!c?.length,f=u?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Ws(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,m)}async function wd(n){let e=_e(n);await _c(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function f0(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function eI(n){return n.map(e=>{var{providerId:t}=e,r=Xu(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function p0(n,e){let t=await Xv(n,{},async()=>{let r=Rs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await Zv(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let u={method:"POST",headers:c,body:r};return n.emulatorConfig&&mn(n.emulatorConfig.host)&&(u.credentials="include"),gc.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function m0(n,e){return Rn(n,"POST","/v2/accounts:revokeToken",Sn(n,e))}var qs=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){z(e.idToken,"internal-error"),z(typeof e.idToken<"u","internal-error"),z(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Lv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){z(e.length!==0,"internal-error");let t=Lv(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await p0(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(z(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(z(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(z(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Wt("not implemented")}};function Tn(n,e){z(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var bn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Xu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ed(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ws(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){let t=await Hs(this,this.stsTokenManager.getToken(this.auth,e));return z(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Id(this,e)}reload(){return wd(this)}_assign(e){this!==e&&(z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await _c(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(We(this.auth.app))return Promise.reject(Kt(this.auth));let e=await this.getIdToken();return await Hs(this,h0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,c,u,h,f;let m=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,C=(o=t.photoURL)!==null&&o!==void 0?o:void 0,D=(c=t.tenantId)!==null&&c!==void 0?c:void 0,R=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,M=(h=t.createdAt)!==null&&h!==void 0?h:void 0,V=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:F,emailVerified:$,isAnonymous:ge,providerData:X,stsTokenManager:E}=t;z(F&&E,e,"internal-error");let y=qs.fromJSON(this.name,E);z(typeof F=="string",e,"internal-error"),Tn(m,e.name),Tn(g,e.name),z(typeof $=="boolean",e,"internal-error"),z(typeof ge=="boolean",e,"internal-error"),Tn(A,e.name),Tn(C,e.name),Tn(D,e.name),Tn(R,e.name),Tn(M,e.name),Tn(V,e.name);let v=new n({uid:F,auth:e,email:g,emailVerified:$,displayName:m,isAnonymous:ge,photoURL:C,phoneNumber:A,tenantId:D,stsTokenManager:y,createdAt:M,lastLoginAt:V});return X&&Array.isArray(X)&&(v.providerData=X.map(I=>Object.assign({},I))),R&&(v._redirectEventId=R),v}static async _fromIdTokenResponse(e,t,r=!1){let i=new qs;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await _c(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];z(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?eI(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new qs;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ws(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u}};var xv=new Map;function Gt(n){An(n instanceof Function,"Expected a class definition");let e=xv.get(n);return e?(An(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,xv.set(n,e),e)}var g0=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),td=g0;function dc(n,e,t){return`firebase:${n}:${e}:${t}`}var vc=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=dc(this.userKey,i.apiKey,s),this.fullPersistenceKey=dc("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await yc(this.auth,{idToken:e}).catch(()=>{});return t?bn._fromGetAccountInfoResponse(this.auth,t,e):null}return bn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(Gt(td),e,r);let i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h),s=i[0]||Gt(td),o=dc(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let f=await h._get(o);if(f){let m;if(typeof f=="string"){let g=await yc(e,{idToken:f}).catch(()=>{});if(!g)break;m=await bn._fromGetAccountInfoResponse(e,g,f)}else m=bn._fromJSON(e,f);h!==s&&(c=m),s=h;break}}catch{}let u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&await s._set(o,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new n(s,e,r))}};function Vv(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(iI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oI(e))return"Blackberry";if(aI(e))return"Webos";if(nI(e))return"Safari";if((e.includes("chrome/")||rI(e))&&!e.includes("edge/"))return"Chrome";if(sI(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function tI(n=Se()){return/firefox\//i.test(n)}function nI(n=Se()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rI(n=Se()){return/crios\//i.test(n)}function iI(n=Se()){return/iemobile/i.test(n)}function sI(n=Se()){return/android/i.test(n)}function oI(n=Se()){return/blackberry/i.test(n)}function aI(n=Se()){return/webos/i.test(n)}function Td(n=Se()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function y0(n=Se()){var e;return Td(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _0(){return m_()&&document.documentMode===10}function cI(n=Se()){return Td(n)||sI(n)||aI(n)||oI(n)||/windows phone/i.test(n)||iI(n)}function uI(n,e=[]){let t;switch(n){case"Browser":t=Vv(Se());break;case"Worker":t=`${Vv(Se())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${yn}/${r}`}var nd=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let u=e(s);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function v0(n,e={}){return Rn(n,"GET","/v2/passwordPolicy",Sn(n,e))}var I0=6,rd=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:I0,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,c;let u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var id=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ic(this),this.idTokenSubscription=new Ic(this),this.beforeStateQueue=new nd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Qv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Gt(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await vc.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await yc(this,{idToken:e}),r=await bn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(We(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&u?.user&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await _c(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=s0()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(We(this.app))return Promise.reject(Kt(this));let t=e?_e(e):null;return t&&z(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return We(this.app)?Promise.reject(Kt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return We(this.app)?Promise.reject(Kt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await v0(this),t=new rd(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ht("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await m0(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Gt(e)||this._popupRedirectResolver;z(t,this,"argument-error"),this.redirectPersistenceManager=await vc.create(this,[Gt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(z(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=uI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(We(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&n0(`Error while retrieving App Check token: ${t.error}`),t?.token}};function hr(n){return _e(n)}var Ic=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=v_(t=>this.observer=t)}get next(){return z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Rc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function E0(n){Rc=n}function lI(n){return Rc.loadJS(n)}function w0(){return Rc.recaptchaEnterpriseScript}function T0(){return Rc.gapiScript}function hI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var sd=class{constructor(){this.enterprise=new od}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},od=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var b0="recaptcha-enterprise",dI="NO_RECAPTCHA",ad=class{constructor(e){this.type=b0,this.auth=hr(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,c)=>{l0(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let h=new Zh(u);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(u=>{c(u)})})}function i(s,o,c){let u=window.grecaptcha;Mv(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(dI)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new sd().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(c=>{if(!t&&Mv(window.grecaptcha))i(c,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=w0();u.length!==0&&(u+=c),lI(u).then(()=>{i(c,s,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}};async function $s(n,e,t,r=!1,i=!1){let s=new ad(n),o;if(i)o=dI;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}let c=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function cd(n,e,t,r,i){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let c=await $s(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let u=await $s(n,e,t,t==="getOobCode");return r(n,u)}else return Promise.reject(c)});else if(i==="PHONE_PROVIDER")if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){let c=await $s(n,e,t);return r(n,c).catch(async u=>{var h;if(((h=n._getRecaptchaConfig())===null||h===void 0?void 0:h.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let f=await $s(n,e,t,!1,!0);return r(n,f)}return Promise.reject(u)})}else{let c=await $s(n,e,t,!1,!0);return r(n,c)}else return Promise.reject(i+" provider is not supported.")}function bd(n,e){let t=Yr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(It(s,e??{}))return i;St(i,"already-initialized")}return t.initialize({options:e})}function A0(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Gt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Ad(n,e,t){let r=hr(n);z(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=fI(e),{host:o,port:c}=S0(e),u=c===null?"":`:${c}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){z(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),z(It(h,r.config.emulator)&&It(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,mn(o)?(Fa(`${s}//${o}${u}`),ja("Auth",!0)):i||R0()}function fI(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function S0(n){let e=fI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Uv(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Uv(o)}}}function Uv(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function R0(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Gs=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wt("not implemented")}_getIdTokenResponse(e){return Wt("not implemented")}_linkToIdToken(e,t){return Wt("not implemented")}_getReauthenticationResolver(e){return Wt("not implemented")}};async function C0(n,e){return Rn(n,"POST","/v1/accounts:signUp",e)}async function P0(n,e){return Qs(n,"POST","/v1/accounts:signInWithPassword",Sn(n,e))}async function k0(n,e){return Qs(n,"POST","/v1/accounts:signInWithEmailLink",Sn(n,e))}async function D0(n,e){return Qs(n,"POST","/v1/accounts:signInWithEmailLink",Sn(n,e))}var Ks=class n extends Gs{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cd(e,t,"signInWithPassword",P0,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return k0(e,{email:this._email,oobCode:this._password});default:St(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cd(e,r,"signUpPassword",C0,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return D0(e,{idToken:t,email:this._email,oobCode:this._password});default:St(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function Jh(n,e){return Qs(n,"POST","/v1/accounts:signInWithIdp",Sn(n,e))}function N0(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function O0(n){let e=Jr(Qr(n)).link,t=e?Jr(Qr(e)).deep_link_id:null,r=Jr(Qr(n)).deep_link_id;return(r?Jr(Qr(r)).link:null)||r||t||e||n}var Ec=class n{constructor(e){var t,r,i,s,o,c;let u=Jr(Qr(e)),h=(t=u.apiKey)!==null&&t!==void 0?t:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,m=N0((i=u.mode)!==null&&i!==void 0?i:null);z(h&&f&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=f,this.continueUrl=(s=u.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=u.lang)!==null&&o!==void 0?o:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){let t=O0(e);try{return new n(t)}catch{return null}}};var pI=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Ks._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Ec.parseLink(r);return z(i,"argument-error"),Ks._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),wc=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ud=class extends wc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};async function M0(n,e){return Qs(n,"POST","/v1/accounts:signUp",Sn(n,e))}var si=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await bn._fromIdTokenResponse(e,r,i),o=Fv(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=Fv(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function Fv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var ld=class n extends Qe{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function mI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ld._fromErrorAndOperation(n,s,e,r):s})}async function L0(n,e,t=!1){let r=await Hs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return si._forOperation(n,"link",r)}async function x0(n,e,t=!1){let{auth:r}=n;if(We(r.app))return Promise.reject(Kt(r));let i="reauthenticate";try{let s=await Hs(n,mI(r,i,e,n),t);z(s.idToken,r,"internal-error");let o=Ed(s.idToken);z(o,r,"internal-error");let{sub:c}=o;return z(n.uid===c,r,"user-mismatch"),si._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&St(r,"user-mismatch"),s}}async function gI(n,e,t=!1){if(We(n.app))return Promise.reject(Kt(n));let r="signIn",i=await mI(n,r,e),s=await si._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Sd(n,e){return gI(hr(n),e)}async function yI(n){let e=hr(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Rd(n,e,t){if(We(n.app))return Promise.reject(Kt(n));let r=hr(n),o=await cd(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",M0,"EMAIL_PASSWORD_PROVIDER").catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&yI(n),u}),c=await si._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function Cd(n,e,t){return We(n.app)?Promise.reject(Kt(n)):Sd(_e(n),pI.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&yI(n),r})}function Pd(n,e){return _e(n).setPersistence(e)}function kd(n,e,t,r){return _e(n).onIdTokenChanged(e,t,r)}function Dd(n,e,t){return _e(n).beforeAuthStateChanged(e,t)}function Nd(n){return _e(n).signOut()}var Tc="__sak";var bc=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Tc,"1"),this.storage.removeItem(Tc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var V0=1e3,U0=10,F0=(()=>{class n extends bc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cI(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);_0()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,U0):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},V0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),_I=F0;var j0=(()=>{class n extends bc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Ys=j0;function B0(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var $0=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:s,data:o}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let u=Array.from(c).map(async f=>f(r.origin,o)),h=await B0(u);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:h})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function vI(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var hd=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((c,u)=>{let h=vI("",20);i.port1.start();let f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){let g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(g.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function At(){return window}function z0(n){At().location.href=n}function II(){return typeof At().WorkerGlobalScope<"u"&&typeof At().importScripts=="function"}async function q0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function H0(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function W0(){return II()?self:null}var EI="firebaseLocalStorageDb",G0=1,Ac="firebaseLocalStorage",wI="fbase_key",lr=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Cc(n,e){return n.transaction([Ac],e?"readwrite":"readonly").objectStore(Ac)}function K0(){let n=indexedDB.deleteDatabase(EI);return new lr(n).toPromise()}function dd(){let n=indexedDB.open(EI,G0);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Ac,{keyPath:wI})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(Ac)?e(r):(r.close(),await K0(),e(await dd()))})})}async function jv(n,e,t){let r=Cc(n,!0).put({[wI]:e,value:t});return new lr(r).toPromise()}async function J0(n,e){let t=Cc(n,!1).get(e),r=await new lr(t).toPromise();return r===void 0?null:r.value}function Bv(n,e){let t=Cc(n,!0).delete(e);return new lr(t).toPromise()}var Q0=800,Y0=3,X0=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dd(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>Y0)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return II()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$0._getInstance(W0()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await q0(),!this.activeServiceWorker)return;this.sender=new hd(this.activeServiceWorker);let i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||H0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await dd();return await jv(t,Tc,"1"),await Bv(t,Tc),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>jv(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>J0(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Bv(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(s=>{let o=Cc(s,!1).getAll();return new lr(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Q0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),TI=X0;var fF=hI("rcb"),pF=new ur(3e4,6e4);function Z0(n,e){return e?Gt(e):(z(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Js=class extends Gs{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jh(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function ek(n){return gI(n.auth,new Js(n),n.bypassAuthState)}function tk(n){let{auth:e,user:t}=n;return z(t,e,"internal-error"),x0(t,new Js(n),n.bypassAuthState)}async function nk(n){let{auth:e,user:t}=n;return z(t,e,"internal-error"),L0(t,new Js(n),n.bypassAuthState)}var fd=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ek;case"linkViaPopup":case"linkViaRedirect":return nk;case"reauthViaPopup":case"reauthViaRedirect":return tk;default:St(this.auth,"internal-error")}}resolve(e){An(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){An(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var mF=new ur(2e3,1e4);var rk="pendingRedirect",fc=new Map,pd=class extends fd{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=fc.get(this.auth._key());if(!e){try{let r=await ik(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}fc.set(this.auth._key(),e)}return this.bypassAuthState||fc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function ik(n,e){let t=ak(e),r=ok(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function sk(n,e){fc.set(n._key(),e)}function ok(n){return Gt(n._redirectPersistence)}function ak(n){return dc(rk,n.config.apiKey,n.name)}async function ck(n,e,t=!1){if(We(n.app))return Promise.reject(Kt(n));let r=hr(n),i=Z0(r,e),o=await new pd(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}var uk=600*1e3,md=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!lk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!bI(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(cr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=uk&&this.cachedEventUids.clear(),this.cachedEventUids.has($v(e))}saveEventToCache(e){this.cachedEventUids.add($v(e)),this.lastProcessedEventTime=Date.now()}};function $v(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function bI({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function lk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bI(n);default:return!1}}async function hk(n,e={}){return Rn(n,"GET","/v1/projects",e)}var dk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fk=/^https?/;async function pk(n){if(n.config.emulator)return;let{authorizedDomains:e}=await hk(n);for(let t of e)try{if(mk(t))return}catch{}St(n,"unauthorized-domain")}function mk(n){let e=Yh(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!fk.test(t))return!1;if(dk.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var gk=new ur(3e4,6e4);function zv(){let n=At().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function yk(n){return new Promise((e,t)=>{var r,i,s;function o(){zv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zv(),t(cr(n,"network-request-failed"))},timeout:gk.get()})}if(!((i=(r=At().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=At().gapi)===null||s===void 0)&&s.load)o();else{let c=hI("iframefcb");return At()[c]=()=>{gapi.load?o():t(cr(n,"network-request-failed"))},lI(`${T0()}?onload=${c}`).catch(u=>t(u))}}).catch(e=>{throw pc=null,e})}var pc=null;function _k(n){return pc=pc||yk(n),pc}var vk=new ur(5e3,15e3),Ik="__/auth/iframe",Ek="emulator/auth/iframe",wk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Tk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function bk(n){let e=n.config;z(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?vd(e,Ek):`https://${n.config.authDomain}/${Ik}`,r={apiKey:e.apiKey,appName:n.name,v:yn},i=Tk.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Rs(r).slice(1)}`}async function Ak(n){let e=await _k(n),t=At().gapi;return z(t,n,"internal-error"),e.open({where:document.body,url:bk(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wk,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=cr(n,"network-request-failed"),c=At().setTimeout(()=>{s(o)},vk.get());function u(){At().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{s(o)})}))}var Sk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Rk=500,Ck=600,Pk="_blank",kk="http://localhost",Sc=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Dk(n,e,t,r=Rk,i=Ck){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",u=Object.assign(Object.assign({},Sk),{width:r.toString(),height:i.toString(),top:s,left:o}),h=Se().toLowerCase();t&&(c=rI(h)?Pk:t),tI(h)&&(e=e||kk,u.scrollbars="yes");let f=Object.entries(u).reduce((g,[A,C])=>`${g}${A}=${C},`,"");if(y0(h)&&c!=="_self")return Nk(e||"",c),new Sc(null);let m=window.open(e||"",c,f);z(m,n,"popup-blocked");try{m.focus()}catch{}return new Sc(m)}function Nk(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var Ok="__/auth/handler",Mk="emulator/auth/handler",Lk=encodeURIComponent("fac");async function qv(n,e,t,r,i,s){z(n.config.authDomain,n,"auth-domain-config-required"),z(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:yn,eventId:i};if(e instanceof wc){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",__(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,m]of Object.entries(s||{}))o[f]=m}if(e instanceof ud){let f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let f of Object.keys(c))c[f]===void 0&&delete c[f];let u=await n._getAppCheckToken(),h=u?`#${Lk}=${encodeURIComponent(u)}`:"";return`${xk(n)}?${Rs(c).slice(1)}${h}`}function xk({config:n}){return n.emulator?vd(n,Mk):`https://${n.authDomain}/${Ok}`}var Qh="webStorageSupport",gd=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ys,this._completeRedirectFn=ck,this._overrideRedirectResult=sk}async _openPopup(e,t,r,i){var s;An((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=await qv(e,t,r,Yh(),i);return Dk(e,o,vI())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await qv(e,t,r,Yh(),i);return z0(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(An(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await Ak(e),r=new md(e);return t.register("authEvent",i=>(z(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qh,{type:Qh},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[Qh];o!==void 0&&t(!!o),St(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cI()||nI()||Td()}},AI=gd;var Hv="@firebase/auth",Wv="1.10.8";var yd=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Vk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Uk(n){dt(new qe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;z(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:uI(n)},h=new id(r,i,s,u);return A0(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),dt(new qe("auth-internal",e=>{let t=hr(e.getProvider("auth").getImmediate());return(r=>new yd(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pe(Hv,Wv,Vk(n)),pe(Hv,Wv,"esm2017")}var Fk=300,jk=Xl("authIdTokenMaxAge")||Fk,Gv=null,Bk=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>jk)return;let i=t?.token;Gv!==i&&(Gv=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Od(n=er()){let e=Yr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=bd(n,{popupRedirectResolver:AI,persistence:[TI,_I,Ys]}),r=Xl("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=Bk(s.toString());Dd(t,o,()=>o(t.currentUser)),kd(t,c=>o(c))}}let i=Ql("auth");return i&&Ad(t,`http://${i}`),t}function $k(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}E0({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=cr("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",$k().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Uk("Browser");var SI="auth",dr=class{constructor(e){return e}},Xs=class{constructor(){return Zr(SI)}};var Md=new ne("angularfire2.auth-instances");function kD(n,e){let t=ks(SI,n,e);return t&&new dr(t)}function DD(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new dr(r)}}var ND={provide:Xs,deps:[[new tt,Md]]},OD={provide:dr,useFactory:kD,deps:[[new tt,Md],zt]};function r2(n,...e){return pe("angularfire",_n.full,"auth"),ot([OD,ND,{provide:Md,useFactory:DD(n),multi:!0,deps:[$e,ct,vn,nr,[new tt,ei],...e]}])}var RI=Te(Nv,!0);var CI=Te(Rd,!0,2);var i2=Te(Od,!0);var PI=Te(Pd,!0);var kI=Te(Cd,!0,2);var Ld=Te(Nd,!0,2);var DI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},NI={};var Jt,xd;(function(){var n;function e(E,y){function v(){}v.prototype=y.prototype,E.D=y.prototype,E.prototype=new v,E.prototype.constructor=E,E.C=function(I,w,b){for(var _=Array(arguments.length-2),Mt=2;Mt<arguments.length;Mt++)_[Mt-2]=arguments[Mt];return y.prototype[w].apply(I,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,y,v){v||(v=0);var I=Array(16);if(typeof y=="string")for(var w=0;16>w;++w)I[w]=y.charCodeAt(v++)|y.charCodeAt(v++)<<8|y.charCodeAt(v++)<<16|y.charCodeAt(v++)<<24;else for(w=0;16>w;++w)I[w]=y[v++]|y[v++]<<8|y[v++]<<16|y[v++]<<24;y=E.g[0],v=E.g[1],w=E.g[2];var b=E.g[3],_=y+(b^v&(w^b))+I[0]+3614090360&4294967295;y=v+(_<<7&4294967295|_>>>25),_=b+(w^y&(v^w))+I[1]+3905402710&4294967295,b=y+(_<<12&4294967295|_>>>20),_=w+(v^b&(y^v))+I[2]+606105819&4294967295,w=b+(_<<17&4294967295|_>>>15),_=v+(y^w&(b^y))+I[3]+3250441966&4294967295,v=w+(_<<22&4294967295|_>>>10),_=y+(b^v&(w^b))+I[4]+4118548399&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(w^y&(v^w))+I[5]+1200080426&4294967295,b=y+(_<<12&4294967295|_>>>20),_=w+(v^b&(y^v))+I[6]+2821735955&4294967295,w=b+(_<<17&4294967295|_>>>15),_=v+(y^w&(b^y))+I[7]+4249261313&4294967295,v=w+(_<<22&4294967295|_>>>10),_=y+(b^v&(w^b))+I[8]+1770035416&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(w^y&(v^w))+I[9]+2336552879&4294967295,b=y+(_<<12&4294967295|_>>>20),_=w+(v^b&(y^v))+I[10]+4294925233&4294967295,w=b+(_<<17&4294967295|_>>>15),_=v+(y^w&(b^y))+I[11]+2304563134&4294967295,v=w+(_<<22&4294967295|_>>>10),_=y+(b^v&(w^b))+I[12]+1804603682&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(w^y&(v^w))+I[13]+4254626195&4294967295,b=y+(_<<12&4294967295|_>>>20),_=w+(v^b&(y^v))+I[14]+2792965006&4294967295,w=b+(_<<17&4294967295|_>>>15),_=v+(y^w&(b^y))+I[15]+1236535329&4294967295,v=w+(_<<22&4294967295|_>>>10),_=y+(w^b&(v^w))+I[1]+4129170786&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^w&(y^v))+I[6]+3225465664&4294967295,b=y+(_<<9&4294967295|_>>>23),_=w+(y^v&(b^y))+I[11]+643717713&4294967295,w=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(w^b))+I[0]+3921069994&4294967295,v=w+(_<<20&4294967295|_>>>12),_=y+(w^b&(v^w))+I[5]+3593408605&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^w&(y^v))+I[10]+38016083&4294967295,b=y+(_<<9&4294967295|_>>>23),_=w+(y^v&(b^y))+I[15]+3634488961&4294967295,w=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(w^b))+I[4]+3889429448&4294967295,v=w+(_<<20&4294967295|_>>>12),_=y+(w^b&(v^w))+I[9]+568446438&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^w&(y^v))+I[14]+3275163606&4294967295,b=y+(_<<9&4294967295|_>>>23),_=w+(y^v&(b^y))+I[3]+4107603335&4294967295,w=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(w^b))+I[8]+1163531501&4294967295,v=w+(_<<20&4294967295|_>>>12),_=y+(w^b&(v^w))+I[13]+2850285829&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^w&(y^v))+I[2]+4243563512&4294967295,b=y+(_<<9&4294967295|_>>>23),_=w+(y^v&(b^y))+I[7]+1735328473&4294967295,w=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(w^b))+I[12]+2368359562&4294967295,v=w+(_<<20&4294967295|_>>>12),_=y+(v^w^b)+I[5]+4294588738&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^w)+I[8]+2272392833&4294967295,b=y+(_<<11&4294967295|_>>>21),_=w+(b^y^v)+I[11]+1839030562&4294967295,w=b+(_<<16&4294967295|_>>>16),_=v+(w^b^y)+I[14]+4259657740&4294967295,v=w+(_<<23&4294967295|_>>>9),_=y+(v^w^b)+I[1]+2763975236&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^w)+I[4]+1272893353&4294967295,b=y+(_<<11&4294967295|_>>>21),_=w+(b^y^v)+I[7]+4139469664&4294967295,w=b+(_<<16&4294967295|_>>>16),_=v+(w^b^y)+I[10]+3200236656&4294967295,v=w+(_<<23&4294967295|_>>>9),_=y+(v^w^b)+I[13]+681279174&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^w)+I[0]+3936430074&4294967295,b=y+(_<<11&4294967295|_>>>21),_=w+(b^y^v)+I[3]+3572445317&4294967295,w=b+(_<<16&4294967295|_>>>16),_=v+(w^b^y)+I[6]+76029189&4294967295,v=w+(_<<23&4294967295|_>>>9),_=y+(v^w^b)+I[9]+3654602809&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^w)+I[12]+3873151461&4294967295,b=y+(_<<11&4294967295|_>>>21),_=w+(b^y^v)+I[15]+530742520&4294967295,w=b+(_<<16&4294967295|_>>>16),_=v+(w^b^y)+I[2]+3299628645&4294967295,v=w+(_<<23&4294967295|_>>>9),_=y+(w^(v|~b))+I[0]+4096336452&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~w))+I[7]+1126891415&4294967295,b=y+(_<<10&4294967295|_>>>22),_=w+(y^(b|~v))+I[14]+2878612391&4294967295,w=b+(_<<15&4294967295|_>>>17),_=v+(b^(w|~y))+I[5]+4237533241&4294967295,v=w+(_<<21&4294967295|_>>>11),_=y+(w^(v|~b))+I[12]+1700485571&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~w))+I[3]+2399980690&4294967295,b=y+(_<<10&4294967295|_>>>22),_=w+(y^(b|~v))+I[10]+4293915773&4294967295,w=b+(_<<15&4294967295|_>>>17),_=v+(b^(w|~y))+I[1]+2240044497&4294967295,v=w+(_<<21&4294967295|_>>>11),_=y+(w^(v|~b))+I[8]+1873313359&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~w))+I[15]+4264355552&4294967295,b=y+(_<<10&4294967295|_>>>22),_=w+(y^(b|~v))+I[6]+2734768916&4294967295,w=b+(_<<15&4294967295|_>>>17),_=v+(b^(w|~y))+I[13]+1309151649&4294967295,v=w+(_<<21&4294967295|_>>>11),_=y+(w^(v|~b))+I[4]+4149444226&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~w))+I[11]+3174756917&4294967295,b=y+(_<<10&4294967295|_>>>22),_=w+(y^(b|~v))+I[2]+718787259&4294967295,w=b+(_<<15&4294967295|_>>>17),_=v+(b^(w|~y))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(w+(_<<21&4294967295|_>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+b&4294967295}r.prototype.u=function(E,y){y===void 0&&(y=E.length);for(var v=y-this.blockSize,I=this.B,w=this.h,b=0;b<y;){if(w==0)for(;b<=v;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<y;)if(I[w++]=E.charCodeAt(b++),w==this.blockSize){i(this,I),w=0;break}}else for(;b<y;)if(I[w++]=E[b++],w==this.blockSize){i(this,I),w=0;break}}this.h=w,this.o+=y},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;var v=8*this.o;for(y=E.length-8;y<E.length;++y)E[y]=v&255,v/=256;for(this.u(E),E=Array(16),y=v=0;4>y;++y)for(var I=0;32>I;I+=8)E[v++]=this.g[y]>>>I&255;return E};function s(E,y){var v=c;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=y(E)}function o(E,y){this.h=y;for(var v=[],I=!0,w=E.length-1;0<=w;w--){var b=E[w]|0;I&&b==y||(v[w]=b,I=!1)}this.g=v}var c={};function u(E){return-128<=E&&128>E?s(E,function(y){return new o([y|0],0>y?-1:0)}):new o([E|0],0>E?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(0>E)return R(h(-E));for(var y=[],v=1,I=0;E>=v;I++)y[I]=E/v|0,v*=4294967296;return new o(y,0)}function f(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return R(f(E.substring(1),y));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(y,8)),I=m,w=0;w<E.length;w+=8){var b=Math.min(8,E.length-w),_=parseInt(E.substring(w,w+b),y);8>b?(b=h(Math.pow(y,b)),I=I.j(b).add(h(_))):(I=I.j(v),I=I.add(h(_)))}return I}var m=u(0),g=u(1),A=u(16777216);n=o.prototype,n.m=function(){if(D(this))return-R(this).m();for(var E=0,y=1,v=0;v<this.g.length;v++){var I=this.i(v);E+=(0<=I?I:4294967296+I)*y,y*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(C(this))return"0";if(D(this))return"-"+R(this).toString(E);for(var y=h(Math.pow(E,6)),v=this,I="";;){var w=$(v,y).g;v=M(v,w.j(y));var b=((0<v.g.length?v.g[0]:v.h)>>>0).toString(E);if(v=w,C(v))return b+I;for(;6>b.length;)b="0"+b;I=b+I}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function C(E){if(E.h!=0)return!1;for(var y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function D(E){return E.h==-1}n.l=function(E){return E=M(this,E),D(E)?-1:C(E)?0:1};function R(E){for(var y=E.g.length,v=[],I=0;I<y;I++)v[I]=~E.g[I];return new o(v,~E.h).add(g)}n.abs=function(){return D(this)?R(this):this},n.add=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],I=0,w=0;w<=y;w++){var b=I+(this.i(w)&65535)+(E.i(w)&65535),_=(b>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);I=_>>>16,b&=65535,_&=65535,v[w]=_<<16|b}return new o(v,v[v.length-1]&-2147483648?-1:0)};function M(E,y){return E.add(R(y))}n.j=function(E){if(C(this)||C(E))return m;if(D(this))return D(E)?R(this).j(R(E)):R(R(this).j(E));if(D(E))return R(this.j(R(E)));if(0>this.l(A)&&0>E.l(A))return h(this.m()*E.m());for(var y=this.g.length+E.g.length,v=[],I=0;I<2*y;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(var w=0;w<E.g.length;w++){var b=this.i(I)>>>16,_=this.i(I)&65535,Mt=E.i(w)>>>16,Oi=E.i(w)&65535;v[2*I+2*w]+=_*Oi,V(v,2*I+2*w),v[2*I+2*w+1]+=b*Oi,V(v,2*I+2*w+1),v[2*I+2*w+1]+=_*Mt,V(v,2*I+2*w+1),v[2*I+2*w+2]+=b*Mt,V(v,2*I+2*w+2)}for(I=0;I<y;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=y;I<2*y;I++)v[I]=0;return new o(v,0)};function V(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function F(E,y){this.g=E,this.h=y}function $(E,y){if(C(y))throw Error("division by zero");if(C(E))return new F(m,m);if(D(E))return y=$(R(E),y),new F(R(y.g),R(y.h));if(D(y))return y=$(E,R(y)),new F(R(y.g),y.h);if(30<E.g.length){if(D(E)||D(y))throw Error("slowDivide_ only works with positive integers.");for(var v=g,I=y;0>=I.l(E);)v=ge(v),I=ge(I);var w=X(v,1),b=X(I,1);for(I=X(I,2),v=X(v,2);!C(I);){var _=b.add(I);0>=_.l(E)&&(w=w.add(v),b=_),I=X(I,1),v=X(v,1)}return y=M(E,w.j(y)),new F(w,y)}for(w=m;0<=E.l(y);){for(v=Math.max(1,Math.floor(E.m()/y.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),b=h(v),_=b.j(y);D(_)||0<_.l(E);)v-=I,b=h(v),_=b.j(y);C(b)&&(b=g),w=w.add(b),E=M(E,_)}return new F(w,E)}n.A=function(E){return $(this,E).h},n.and=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],I=0;I<y;I++)v[I]=this.i(I)&E.i(I);return new o(v,this.h&E.h)},n.or=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],I=0;I<y;I++)v[I]=this.i(I)|E.i(I);return new o(v,this.h|E.h)},n.xor=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],I=0;I<y;I++)v[I]=this.i(I)^E.i(I);return new o(v,this.h^E.h)};function ge(E){for(var y=E.g.length+1,v=[],I=0;I<y;I++)v[I]=E.i(I)<<1|E.i(I-1)>>>31;return new o(v,E.h)}function X(E,y){var v=y>>5;y%=32;for(var I=E.g.length-v,w=[],b=0;b<I;b++)w[b]=0<y?E.i(b+v)>>>y|E.i(b+v+1)<<32-y:E.i(b+v);return new o(w,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xd=NI.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,Jt=NI.Integer=o}).apply(typeof DI<"u"?DI:typeof self<"u"?self:typeof window<"u"?window:{});var Pc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qt={};var Vd,MD,oi,Ud,Zs,kc,Fd,jd,Bd;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,l,d){return a==Array.prototype||a==Object.prototype||(a[l]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pc=="object"&&Pc];for(var l=0;l<a.length;++l){var d=a[l];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(a,l){if(l)e:{var d=r;a=a.split(".");for(var p=0;p<a.length-1;p++){var T=a[p];if(!(T in d))break e;d=d[T]}a=a[a.length-1],p=d[a],l=l(p),l!=p&&l!=null&&e(d,a,{configurable:!0,writable:!0,value:l})}}function s(a,l){a instanceof String&&(a+="");var d=0,p=!1,T={next:function(){if(!p&&d<a.length){var S=d++;return{value:l(S,a[S]),done:!1}}return p=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(a){return a||function(){return s(this,function(l,d){return d})}});var o=o||{},c=this||self;function u(a){var l=typeof a;return l=l!="object"?l:a?Array.isArray(a)?"array":l:"null",l=="array"||l=="object"&&typeof a.length=="number"}function h(a){var l=typeof a;return l=="object"&&a!=null||l=="function"}function f(a,l,d){return a.call.apply(a.bind,arguments)}function m(a,l,d){if(!a)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,p),a.apply(l,T)}}return function(){return a.apply(l,arguments)}}function g(a,l,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,g.apply(null,arguments)}function A(a,l){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),a.apply(this,p)}}function C(a,l){function d(){}d.prototype=l.prototype,a.aa=l.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(p,T,S){for(var N=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)N[ae-2]=arguments[ae];return l.prototype[T].apply(p,N)}}function D(a){let l=a.length;if(0<l){let d=Array(l);for(let p=0;p<l;p++)d[p]=a[p];return d}return[]}function R(a,l){for(let d=1;d<arguments.length;d++){let p=arguments[d];if(u(p)){let T=a.length||0,S=p.length||0;a.length=T+S;for(let N=0;N<S;N++)a[T+N]=p[N]}else a.push(p)}}class M{constructor(l,d){this.i=l,this.j=d,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function V(a){return/^[\s\xa0]*$/.test(a)}function F(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function $(a){return $[" "](a),a}$[" "]=function(){};var ge=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function X(a,l,d){for(let p in a)l.call(d,a[p],p,a)}function E(a,l){for(let d in a)l.call(void 0,a[d],d,a)}function y(a){let l={};for(let d in a)l[d]=a[d];return l}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,l){let d,p;for(let T=1;T<arguments.length;T++){p=arguments[T];for(d in p)a[d]=p[d];for(let S=0;S<v.length;S++)d=v[S],Object.prototype.hasOwnProperty.call(p,d)&&(a[d]=p[d])}}function w(a){var l=1;a=a.split(":");let d=[];for(;0<l&&a.length;)d.push(a.shift()),l--;return a.length&&d.push(a.join(":")),d}function b(a){c.setTimeout(()=>{throw a},0)}function _(){var a=Ru;let l=null;return a.g&&(l=a.g,a.g=a.g.next,a.g||(a.h=null),l.next=null),l}class Mt{constructor(){this.h=this.g=null}add(l,d){let p=Oi.get();p.set(l,d),this.h?this.h.next=p:this.g=p,this.h=p}}var Oi=new M(()=>new lT,a=>a.reset());class lT{constructor(){this.next=this.g=this.h=null}set(l,d){this.h=l,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Mi,Li=!1,Ru=new Mt,tm=()=>{let a=c.Promise.resolve(void 0);Mi=()=>{a.then(hT)}};var hT=()=>{for(var a;a=_();){try{a.h.call(a.g)}catch(d){b(d)}var l=Oi;l.j(a),100>l.h&&(l.h++,a.next=l.g,l.g=a)}Li=!1};function rn(){this.s=this.s,this.C=this.C}rn.prototype.s=!1,rn.prototype.ma=function(){this.s||(this.s=!0,this.N())},rn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ne(a,l){this.type=a,this.g=this.target=l,this.defaultPrevented=!1}Ne.prototype.h=function(){this.defaultPrevented=!0};var dT=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,l=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};c.addEventListener("test",d,l),c.removeEventListener("test",d,l)}catch{}return a})();function xi(a,l){if(Ne.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,p=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=l,l=a.relatedTarget){if(ge){e:{try{$(l.nodeName);var T=!0;break e}catch{}T=!1}T||(l=null)}}else d=="mouseover"?l=a.fromElement:d=="mouseout"&&(l=a.toElement);this.relatedTarget=l,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:fT[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&xi.aa.h.call(this)}}C(xi,Ne);var fT={2:"touch",3:"pen",4:"mouse"};xi.prototype.h=function(){xi.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Vi="closure_listenable_"+(1e6*Math.random()|0),pT=0;function mT(a,l,d,p,T){this.listener=a,this.proxy=null,this.src=l,this.type=d,this.capture=!!p,this.ha=T,this.key=++pT,this.da=this.fa=!1}function Io(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Eo(a){this.src=a,this.g={},this.h=0}Eo.prototype.add=function(a,l,d,p,T){var S=a.toString();a=this.g[S],a||(a=this.g[S]=[],this.h++);var N=Pu(a,l,p,T);return-1<N?(l=a[N],d||(l.fa=!1)):(l=new mT(l,this.src,S,!!p,T),l.fa=d,a.push(l)),l};function Cu(a,l){var d=l.type;if(d in a.g){var p=a.g[d],T=Array.prototype.indexOf.call(p,l,void 0),S;(S=0<=T)&&Array.prototype.splice.call(p,T,1),S&&(Io(l),a.g[d].length==0&&(delete a.g[d],a.h--))}}function Pu(a,l,d,p){for(var T=0;T<a.length;++T){var S=a[T];if(!S.da&&S.listener==l&&S.capture==!!d&&S.ha==p)return T}return-1}var ku="closure_lm_"+(1e6*Math.random()|0),Du={};function nm(a,l,d,p,T){if(p&&p.once)return im(a,l,d,p,T);if(Array.isArray(l)){for(var S=0;S<l.length;S++)nm(a,l[S],d,p,T);return null}return d=Lu(d),a&&a[Vi]?a.K(l,d,h(p)?!!p.capture:!!p,T):rm(a,l,d,!1,p,T)}function rm(a,l,d,p,T,S){if(!l)throw Error("Invalid event type");var N=h(T)?!!T.capture:!!T,ae=Ou(a);if(ae||(a[ku]=ae=new Eo(a)),d=ae.add(l,d,p,N,S),d.proxy)return d;if(p=gT(),d.proxy=p,p.src=a,p.listener=d,a.addEventListener)dT||(T=N),T===void 0&&(T=!1),a.addEventListener(l.toString(),p,T);else if(a.attachEvent)a.attachEvent(om(l.toString()),p);else if(a.addListener&&a.removeListener)a.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function gT(){function a(d){return l.call(a.src,a.listener,d)}let l=yT;return a}function im(a,l,d,p,T){if(Array.isArray(l)){for(var S=0;S<l.length;S++)im(a,l[S],d,p,T);return null}return d=Lu(d),a&&a[Vi]?a.L(l,d,h(p)?!!p.capture:!!p,T):rm(a,l,d,!0,p,T)}function sm(a,l,d,p,T){if(Array.isArray(l))for(var S=0;S<l.length;S++)sm(a,l[S],d,p,T);else p=h(p)?!!p.capture:!!p,d=Lu(d),a&&a[Vi]?(a=a.i,l=String(l).toString(),l in a.g&&(S=a.g[l],d=Pu(S,d,p,T),-1<d&&(Io(S[d]),Array.prototype.splice.call(S,d,1),S.length==0&&(delete a.g[l],a.h--)))):a&&(a=Ou(a))&&(l=a.g[l.toString()],a=-1,l&&(a=Pu(l,d,p,T)),(d=-1<a?l[a]:null)&&Nu(d))}function Nu(a){if(typeof a!="number"&&a&&!a.da){var l=a.src;if(l&&l[Vi])Cu(l.i,a);else{var d=a.type,p=a.proxy;l.removeEventListener?l.removeEventListener(d,p,a.capture):l.detachEvent?l.detachEvent(om(d),p):l.addListener&&l.removeListener&&l.removeListener(p),(d=Ou(l))?(Cu(d,a),d.h==0&&(d.src=null,l[ku]=null)):Io(a)}}}function om(a){return a in Du?Du[a]:Du[a]="on"+a}function yT(a,l){if(a.da)a=!0;else{l=new xi(l,this);var d=a.listener,p=a.ha||a.src;a.fa&&Nu(a),a=d.call(p,l)}return a}function Ou(a){return a=a[ku],a instanceof Eo?a:null}var Mu="__closure_events_fn_"+(1e9*Math.random()>>>0);function Lu(a){return typeof a=="function"?a:(a[Mu]||(a[Mu]=function(l){return a.handleEvent(l)}),a[Mu])}function Oe(){rn.call(this),this.i=new Eo(this),this.M=this,this.F=null}C(Oe,rn),Oe.prototype[Vi]=!0,Oe.prototype.removeEventListener=function(a,l,d,p){sm(this,a,l,d,p)};function Fe(a,l){var d,p=a.F;if(p)for(d=[];p;p=p.F)d.push(p);if(a=a.M,p=l.type||l,typeof l=="string")l=new Ne(l,a);else if(l instanceof Ne)l.target=l.target||a;else{var T=l;l=new Ne(p,a),I(l,T)}if(T=!0,d)for(var S=d.length-1;0<=S;S--){var N=l.g=d[S];T=wo(N,p,!0,l)&&T}if(N=l.g=a,T=wo(N,p,!0,l)&&T,T=wo(N,p,!1,l)&&T,d)for(S=0;S<d.length;S++)N=l.g=d[S],T=wo(N,p,!1,l)&&T}Oe.prototype.N=function(){if(Oe.aa.N.call(this),this.i){var a=this.i,l;for(l in a.g){for(var d=a.g[l],p=0;p<d.length;p++)Io(d[p]);delete a.g[l],a.h--}}this.F=null},Oe.prototype.K=function(a,l,d,p){return this.i.add(String(a),l,!1,d,p)},Oe.prototype.L=function(a,l,d,p){return this.i.add(String(a),l,!0,d,p)};function wo(a,l,d,p){if(l=a.i.g[String(l)],!l)return!0;l=l.concat();for(var T=!0,S=0;S<l.length;++S){var N=l[S];if(N&&!N.da&&N.capture==d){var ae=N.listener,Pe=N.ha||N.src;N.fa&&Cu(a.i,N),T=ae.call(Pe,p)!==!1&&T}}return T&&!p.defaultPrevented}function am(a,l,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:c.setTimeout(a,l||0)}function cm(a){a.g=am(()=>{a.g=null,a.i&&(a.i=!1,cm(a))},a.l);let l=a.h;a.h=null,a.m.apply(null,l)}class _T extends rn{constructor(l,d){super(),this.m=l,this.l=d,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:cm(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ui(a){rn.call(this),this.h=a,this.g={}}C(Ui,rn);var um=[];function lm(a){X(a.g,function(l,d){this.g.hasOwnProperty(d)&&Nu(l)},a),a.g={}}Ui.prototype.N=function(){Ui.aa.N.call(this),lm(this)},Ui.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xu=c.JSON.stringify,vT=c.JSON.parse,IT=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function Vu(){}Vu.prototype.h=null;function hm(a){return a.h||(a.h=a.i())}function dm(){}var Fi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Uu(){Ne.call(this,"d")}C(Uu,Ne);function Fu(){Ne.call(this,"c")}C(Fu,Ne);var Un={},fm=null;function To(){return fm=fm||new Oe}Un.La="serverreachability";function pm(a){Ne.call(this,Un.La,a)}C(pm,Ne);function ji(a){let l=To();Fe(l,new pm(l))}Un.STAT_EVENT="statevent";function mm(a,l){Ne.call(this,Un.STAT_EVENT,a),this.stat=l}C(mm,Ne);function je(a){let l=To();Fe(l,new mm(l,a))}Un.Ma="timingevent";function gm(a,l){Ne.call(this,Un.Ma,a),this.size=l}C(gm,Ne);function Bi(a,l){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},l)}function $i(){this.g=!0}$i.prototype.xa=function(){this.g=!1};function ET(a,l,d,p,T,S){a.info(function(){if(a.g)if(S)for(var N="",ae=S.split("&"),Pe=0;Pe<ae.length;Pe++){var ee=ae[Pe].split("=");if(1<ee.length){var Me=ee[0];ee=ee[1];var Le=Me.split("_");N=2<=Le.length&&Le[1]=="type"?N+(Me+"="+ee+"&"):N+(Me+"=redacted&")}}else N=null;else N=S;return"XMLHTTP REQ ("+p+") [attempt "+T+"]: "+l+`
`+d+`
`+N})}function wT(a,l,d,p,T,S,N){a.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+T+"]: "+l+`
`+d+`
`+S+" "+N})}function Sr(a,l,d,p){a.info(function(){return"XMLHTTP TEXT ("+l+"): "+bT(a,d)+(p?" "+p:"")})}function TT(a,l){a.info(function(){return"TIMEOUT: "+l})}$i.prototype.info=function(){};function bT(a,l){if(!a.g)return l;if(!l)return null;try{var d=JSON.parse(l);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var p=d[a];if(!(2>p.length)){var T=p[1];if(Array.isArray(T)&&!(1>T.length)){var S=T[0];if(S!="noop"&&S!="stop"&&S!="close")for(var N=1;N<T.length;N++)T[N]=""}}}}return xu(d)}catch{return l}}var bo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ym={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ju;function Ao(){}C(Ao,Vu),Ao.prototype.g=function(){return new XMLHttpRequest},Ao.prototype.i=function(){return{}},ju=new Ao;function sn(a,l,d,p){this.j=a,this.i=l,this.l=d,this.R=p||1,this.U=new Ui(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new _m}function _m(){this.i=null,this.g="",this.h=!1}var vm={},Bu={};function $u(a,l,d){a.L=1,a.v=Po(Lt(l)),a.m=d,a.P=!0,Im(a,null)}function Im(a,l){a.F=Date.now(),So(a),a.A=Lt(a.v);var d=a.A,p=a.R;Array.isArray(p)||(p=[String(p)]),Mm(d.i,"t",p),a.C=0,d=a.j.J,a.h=new _m,a.g=Xm(a.j,d?l:null,!a.m),0<a.O&&(a.M=new _T(g(a.Y,a,a.g),a.O)),l=a.U,d=a.g,p=a.ca;var T="readystatechange";Array.isArray(T)||(T&&(um[0]=T.toString()),T=um);for(var S=0;S<T.length;S++){var N=nm(d,T[S],p||l.handleEvent,!1,l.h||l);if(!N)break;l.g[N.key]=N}l=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,l)):(a.u="GET",a.g.ea(a.A,a.u,null,l)),ji(),ET(a.i,a.u,a.A,a.l,a.R,a.m)}sn.prototype.ca=function(a){a=a.target;let l=this.M;l&&xt(a)==3?l.j():this.Y(a)},sn.prototype.Y=function(a){try{if(a==this.g)e:{let Le=xt(this.g);var l=this.g.Ba();let Pr=this.g.Z();if(!(3>Le)&&(Le!=3||this.g&&(this.h.h||this.g.oa()||Bm(this.g)))){this.J||Le!=4||l==7||(l==8||0>=Pr?ji(3):ji(2)),zu(this);var d=this.g.Z();this.X=d;t:if(Em(this)){var p=Bm(this.g);a="";var T=p.length,S=xt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fn(this),zi(this);var N="";break t}this.h.i=new c.TextDecoder}for(l=0;l<T;l++)this.h.h=!0,a+=this.h.i.decode(p[l],{stream:!(S&&l==T-1)});p.length=0,this.h.g+=a,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=d==200,wT(this.i,this.u,this.A,this.l,this.R,Le,d),this.o){if(this.T&&!this.K){t:{if(this.g){var ae,Pe=this.g;if((ae=Pe.g?Pe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(ae)){var ee=ae;break t}}ee=null}if(d=ee)Sr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qu(this,d);else{this.o=!1,this.s=3,je(12),Fn(this),zi(this);break e}}if(this.P){d=!0;let it;for(;!this.J&&this.C<N.length;)if(it=AT(this,N),it==Bu){Le==4&&(this.s=4,je(14),d=!1),Sr(this.i,this.l,null,"[Incomplete Response]");break}else if(it==vm){this.s=4,je(15),Sr(this.i,this.l,N,"[Invalid Chunk]"),d=!1;break}else Sr(this.i,this.l,it,null),qu(this,it);if(Em(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Le!=4||N.length!=0||this.h.h||(this.s=1,je(16),d=!1),this.o=this.o&&d,!d)Sr(this.i,this.l,N,"[Invalid Chunked Response]"),Fn(this),zi(this);else if(0<N.length&&!this.W){this.W=!0;var Me=this.j;Me.g==this&&Me.ba&&!Me.M&&(Me.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),Qu(Me),Me.M=!0,je(11))}}else Sr(this.i,this.l,N,null),qu(this,N);Le==4&&Fn(this),this.o&&!this.J&&(Le==4?Km(this.j,this):(this.o=!1,So(this)))}else $T(this.g),d==400&&0<N.indexOf("Unknown SID")?(this.s=3,je(12)):(this.s=0,je(13)),Fn(this),zi(this)}}}catch{}finally{}};function Em(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function AT(a,l){var d=a.C,p=l.indexOf(`
`,d);return p==-1?Bu:(d=Number(l.substring(d,p)),isNaN(d)?vm:(p+=1,p+d>l.length?Bu:(l=l.slice(p,p+d),a.C=p+d,l)))}sn.prototype.cancel=function(){this.J=!0,Fn(this)};function So(a){a.S=Date.now()+a.I,wm(a,a.I)}function wm(a,l){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Bi(g(a.ba,a),l)}function zu(a){a.B&&(c.clearTimeout(a.B),a.B=null)}sn.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(TT(this.i,this.A),this.L!=2&&(ji(),je(17)),Fn(this),this.s=2,zi(this)):wm(this,this.S-a)};function zi(a){a.j.G==0||a.J||Km(a.j,a)}function Fn(a){zu(a);var l=a.M;l&&typeof l.ma=="function"&&l.ma(),a.M=null,lm(a.U),a.g&&(l=a.g,a.g=null,l.abort(),l.ma())}function qu(a,l){try{var d=a.j;if(d.G!=0&&(d.g==a||Hu(d.h,a))){if(!a.K&&Hu(d.h,a)&&d.G==3){try{var p=d.Da.g.parse(l)}catch{p=null}if(Array.isArray(p)&&p.length==3){var T=p;if(T[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)Mo(d),No(d);else break e;Ju(d),je(18)}}else d.za=T[1],0<d.za-d.T&&37500>T[2]&&d.F&&d.v==0&&!d.C&&(d.C=Bi(g(d.Za,d),6e3));if(1>=Am(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else Bn(d,11)}else if((a.K||d.g==a)&&Mo(d),!V(l))for(T=d.Da.g.parse(l),l=0;l<T.length;l++){let ee=T[l];if(d.T=ee[0],ee=ee[1],d.G==2)if(ee[0]=="c"){d.K=ee[1],d.ia=ee[2];let Me=ee[3];Me!=null&&(d.la=Me,d.j.info("VER="+d.la));let Le=ee[4];Le!=null&&(d.Aa=Le,d.j.info("SVER="+d.Aa));let Pr=ee[5];Pr!=null&&typeof Pr=="number"&&0<Pr&&(p=1.5*Pr,d.L=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let it=a.g;if(it){let xo=it.g?it.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xo){var S=p.h;S.g||xo.indexOf("spdy")==-1&&xo.indexOf("quic")==-1&&xo.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(Wu(S,S.h),S.h=null))}if(p.D){let Yu=it.g?it.g.getResponseHeader("X-HTTP-Session-Id"):null;Yu&&(p.ya=Yu,le(p.I,p.D,Yu))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),p=d;var N=a;if(p.qa=Ym(p,p.J?p.ia:null,p.W),N.K){Sm(p.h,N);var ae=N,Pe=p.L;Pe&&(ae.I=Pe),ae.B&&(zu(ae),So(ae)),p.g=N}else Wm(p);0<d.i.length&&Oo(d)}else ee[0]!="stop"&&ee[0]!="close"||Bn(d,7);else d.G==3&&(ee[0]=="stop"||ee[0]=="close"?ee[0]=="stop"?Bn(d,7):Ku(d):ee[0]!="noop"&&d.l&&d.l.ta(ee),d.v=0)}}ji(4)}catch{}}var ST=class{constructor(a,l){this.g=a,this.map=l}};function Tm(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bm(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Am(a){return a.h?1:a.g?a.g.size:0}function Hu(a,l){return a.h?a.h==l:a.g?a.g.has(l):!1}function Wu(a,l){a.g?a.g.add(l):a.h=l}function Sm(a,l){a.h&&a.h==l?a.h=null:a.g&&a.g.has(l)&&a.g.delete(l)}Tm.prototype.cancel=function(){if(this.i=Rm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Rm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let l=a.i;for(let d of a.g.values())l=l.concat(d.D);return l}return D(a.i)}function RT(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var l=[],d=a.length,p=0;p<d;p++)l.push(a[p]);return l}l=[],d=0;for(p in a)l[d++]=a[p];return l}function CT(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var l=[];a=a.length;for(var d=0;d<a;d++)l.push(d);return l}l=[],d=0;for(let p in a)l[d++]=p;return l}}}function Cm(a,l){if(a.forEach&&typeof a.forEach=="function")a.forEach(l,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,l,void 0);else for(var d=CT(a),p=RT(a),T=p.length,S=0;S<T;S++)l.call(void 0,p[S],d&&d[S],a)}var Pm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PT(a,l){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var p=a[d].indexOf("="),T=null;if(0<=p){var S=a[d].substring(0,p);T=a[d].substring(p+1)}else S=a[d];l(S,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function jn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof jn){this.h=a.h,Ro(this,a.j),this.o=a.o,this.g=a.g,Co(this,a.s),this.l=a.l;var l=a.i,d=new Wi;d.i=l.i,l.g&&(d.g=new Map(l.g),d.h=l.h),km(this,d),this.m=a.m}else a&&(l=String(a).match(Pm))?(this.h=!1,Ro(this,l[1]||"",!0),this.o=qi(l[2]||""),this.g=qi(l[3]||"",!0),Co(this,l[4]),this.l=qi(l[5]||"",!0),km(this,l[6]||"",!0),this.m=qi(l[7]||"")):(this.h=!1,this.i=new Wi(null,this.h))}jn.prototype.toString=function(){var a=[],l=this.j;l&&a.push(Hi(l,Dm,!0),":");var d=this.g;return(d||l=="file")&&(a.push("//"),(l=this.o)&&a.push(Hi(l,Dm,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(Hi(d,d.charAt(0)=="/"?NT:DT,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",Hi(d,MT)),a.join("")};function Lt(a){return new jn(a)}function Ro(a,l,d){a.j=d?qi(l,!0):l,a.j&&(a.j=a.j.replace(/:$/,""))}function Co(a,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);a.s=l}else a.s=null}function km(a,l,d){l instanceof Wi?(a.i=l,LT(a.i,a.h)):(d||(l=Hi(l,OT)),a.i=new Wi(l,a.h))}function le(a,l,d){a.i.set(l,d)}function Po(a){return le(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function qi(a,l){return a?l?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Hi(a,l,d){return typeof a=="string"?(a=encodeURI(a).replace(l,kT),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function kT(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Dm=/[#\/\?@]/g,DT=/[#\?:]/g,NT=/[#\?]/g,OT=/[#\?@]/g,MT=/#/g;function Wi(a,l){this.h=this.g=null,this.i=a||null,this.j=!!l}function on(a){a.g||(a.g=new Map,a.h=0,a.i&&PT(a.i,function(l,d){a.add(decodeURIComponent(l.replace(/\+/g," ")),d)}))}n=Wi.prototype,n.add=function(a,l){on(this),this.i=null,a=Rr(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(l),this.h+=1,this};function Nm(a,l){on(a),l=Rr(a,l),a.g.has(l)&&(a.i=null,a.h-=a.g.get(l).length,a.g.delete(l))}function Om(a,l){return on(a),l=Rr(a,l),a.g.has(l)}n.forEach=function(a,l){on(this),this.g.forEach(function(d,p){d.forEach(function(T){a.call(l,T,p,this)},this)},this)},n.na=function(){on(this);let a=Array.from(this.g.values()),l=Array.from(this.g.keys()),d=[];for(let p=0;p<l.length;p++){let T=a[p];for(let S=0;S<T.length;S++)d.push(l[p])}return d},n.V=function(a){on(this);let l=[];if(typeof a=="string")Om(this,a)&&(l=l.concat(this.g.get(Rr(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)l=l.concat(a[d])}return l},n.set=function(a,l){return on(this),this.i=null,a=Rr(this,a),Om(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[l]),this.h+=1,this},n.get=function(a,l){return a?(a=this.V(a),0<a.length?String(a[0]):l):l};function Mm(a,l,d){Nm(a,l),0<d.length&&(a.i=null,a.g.set(Rr(a,l),D(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],l=Array.from(this.g.keys());for(var d=0;d<l.length;d++){var p=l[d];let S=encodeURIComponent(String(p)),N=this.V(p);for(p=0;p<N.length;p++){var T=S;N[p]!==""&&(T+="="+encodeURIComponent(String(N[p]))),a.push(T)}}return this.i=a.join("&")};function Rr(a,l){return l=String(l),a.j&&(l=l.toLowerCase()),l}function LT(a,l){l&&!a.j&&(on(a),a.i=null,a.g.forEach(function(d,p){var T=p.toLowerCase();p!=T&&(Nm(this,p),Mm(this,T,d))},a)),a.j=l}function xT(a,l){let d=new $i;if(c.Image){let p=new Image;p.onload=A(an,d,"TestLoadImage: loaded",!0,l,p),p.onerror=A(an,d,"TestLoadImage: error",!1,l,p),p.onabort=A(an,d,"TestLoadImage: abort",!1,l,p),p.ontimeout=A(an,d,"TestLoadImage: timeout",!1,l,p),c.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=a}else l(!1)}function VT(a,l){let d=new $i,p=new AbortController,T=setTimeout(()=>{p.abort(),an(d,"TestPingServer: timeout",!1,l)},1e4);fetch(a,{signal:p.signal}).then(S=>{clearTimeout(T),S.ok?an(d,"TestPingServer: ok",!0,l):an(d,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(T),an(d,"TestPingServer: error",!1,l)})}function an(a,l,d,p,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),p(d)}catch{}}function UT(){this.g=new IT}function FT(a,l,d){let p=d||"";try{Cm(a,function(T,S){let N=T;h(T)&&(N=xu(T)),l.push(p+S+"="+encodeURIComponent(N))})}catch(T){throw l.push(p+"type="+encodeURIComponent("_badmap")),T}}function Gi(a){this.l=a.Ub||null,this.j=a.eb||!1}C(Gi,Vu),Gi.prototype.g=function(){return new ko(this.l,this.j)},Gi.prototype.i=(function(a){return function(){return a}})({});function ko(a,l){Oe.call(this),this.D=a,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(ko,Oe),n=ko.prototype,n.open=function(a,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=l,this.readyState=1,Ji(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(l.body=a),(this.D||c).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ki(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ji(this)),this.g&&(this.readyState=3,Ji(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var l=a.value?a.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!a.done}))&&(this.response=this.responseText+=l)}a.done?Ki(this):Ji(this),this.readyState==3&&Lm(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Ki(this))},n.Qa=function(a){this.g&&(this.response=a,Ki(this))},n.ga=function(){this.g&&Ki(this)};function Ki(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ji(a)}n.setRequestHeader=function(a,l){this.u.append(a,l)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],l=this.h.entries();for(var d=l.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=l.next();return a.join(`\r
`)};function Ji(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ko.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function xm(a){let l="";return X(a,function(d,p){l+=p,l+=":",l+=d,l+=`\r
`}),l}function Gu(a,l,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=xm(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):le(a,l,d))}function fe(a){Oe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(fe,Oe);var jT=/^https?$/i,BT=["POST","PUT"];n=fe.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,l,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);l=l?l.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ju.g(),this.v=this.o?hm(this.o):hm(ju),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(l,String(a),!0),this.B=!1}catch(S){Vm(this,S);return}if(a=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var T in p)d.set(T,p[T]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let S of p.keys())d.set(S,p.get(S));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),T=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(BT,l,void 0))||p||T||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,N]of d)this.g.setRequestHeader(S,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{jm(this),this.u=!0,this.g.send(a),this.u=!1}catch(S){Vm(this,S)}};function Vm(a,l){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=l,a.m=5,Um(a),Do(a)}function Um(a){a.A||(a.A=!0,Fe(a,"complete"),Fe(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Fe(this,"complete"),Fe(this,"abort"),Do(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Do(this,!0)),fe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Fm(this):this.bb())},n.bb=function(){Fm(this)};function Fm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||xt(a)!=4||a.Z()!=2)){if(a.u&&xt(a)==4)am(a.Ea,0,a);else if(Fe(a,"readystatechange"),xt(a)==4){a.h=!1;try{let N=a.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var d;if(!(d=l)){var p;if(p=N===0){var T=String(a.D).match(Pm)[1]||null;!T&&c.self&&c.self.location&&(T=c.self.location.protocol.slice(0,-1)),p=!jT.test(T?T.toLowerCase():"")}d=p}if(d)Fe(a,"complete"),Fe(a,"success");else{a.m=6;try{var S=2<xt(a)?a.g.statusText:""}catch{S=""}a.l=S+" ["+a.Z()+"]",Um(a)}}finally{Do(a)}}}}function Do(a,l){if(a.g){jm(a);let d=a.g,p=a.v[0]?()=>{}:null;a.g=null,a.v=null,l||Fe(a,"ready");try{d.onreadystatechange=p}catch{}}}function jm(a){a.I&&(c.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function xt(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<xt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var l=this.g.responseText;return a&&l.indexOf(a)==0&&(l=l.substring(a.length)),vT(l)}};function Bm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function $T(a){let l={};a=(a.g&&2<=xt(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<a.length;p++){if(V(a[p]))continue;var d=w(a[p]);let T=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=l[T]||[];l[T]=S,S.push(d)}E(l,function(p){return p.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qi(a,l,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||l}function $m(a){this.Aa=0,this.i=[],this.j=new $i,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qi("baseRetryDelayMs",5e3,a),this.cb=Qi("retryDelaySeedMs",1e4,a),this.Wa=Qi("forwardChannelMaxRetries",2,a),this.wa=Qi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Tm(a&&a.concurrentRequestLimit),this.Da=new UT,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=$m.prototype,n.la=8,n.G=1,n.connect=function(a,l,d,p){je(0),this.W=a,this.H=l||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.I=Ym(this,null,this.W),Oo(this)};function Ku(a){if(zm(a),a.G==3){var l=a.U++,d=Lt(a.I);if(le(d,"SID",a.K),le(d,"RID",l),le(d,"TYPE","terminate"),Yi(a,d),l=new sn(a,a.j,l),l.L=2,l.v=Po(Lt(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(l.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=l.v,d=!0),d||(l.g=Xm(l.j,null),l.g.ea(l.v)),l.F=Date.now(),So(l)}Qm(a)}function No(a){a.g&&(Qu(a),a.g.cancel(),a.g=null)}function zm(a){No(a),a.u&&(c.clearTimeout(a.u),a.u=null),Mo(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function Oo(a){if(!bm(a.h)&&!a.s){a.s=!0;var l=a.Ga;Mi||tm(),Li||(Mi(),Li=!0),Ru.add(l,a),a.B=0}}function zT(a,l){return Am(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=l.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Bi(g(a.Ga,a,l),Jm(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let T=new sn(this,this.j,a),S=this.o;if(this.S&&(S?(S=y(S),I(S,this.S)):S=this.S),this.m!==null||this.O||(T.H=S,S=null),this.P)e:{for(var l=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(l+=p,4096<l){l=d;break e}if(l===4096||d===this.i.length-1){l=d+1;break e}}l=1e3}else l=1e3;l=Hm(this,T,l),d=Lt(this.I),le(d,"RID",a),le(d,"CVER",22),this.D&&le(d,"X-HTTP-Session-Id",this.D),Yi(this,d),S&&(this.O?l="headers="+encodeURIComponent(String(xm(S)))+"&"+l:this.m&&Gu(d,this.m,S)),Wu(this.h,T),this.Ua&&le(d,"TYPE","init"),this.P?(le(d,"$req",l),le(d,"SID","null"),T.T=!0,$u(T,d,null)):$u(T,d,l),this.G=2}}else this.G==3&&(a?qm(this,a):this.i.length==0||bm(this.h)||qm(this))};function qm(a,l){var d;l?d=l.l:d=a.U++;let p=Lt(a.I);le(p,"SID",a.K),le(p,"RID",d),le(p,"AID",a.T),Yi(a,p),a.m&&a.o&&Gu(p,a.m,a.o),d=new sn(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),l&&(a.i=l.D.concat(a.i)),l=Hm(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Wu(a.h,d),$u(d,p,l)}function Yi(a,l){a.H&&X(a.H,function(d,p){le(l,p,d)}),a.l&&Cm({},function(d,p){le(l,p,d)})}function Hm(a,l,d){d=Math.min(a.i.length,d);var p=a.l?g(a.l.Na,a.l,a):null;e:{var T=a.i;let S=-1;for(;;){let N=["count="+d];S==-1?0<d?(S=T[0].g,N.push("ofs="+S)):S=0:N.push("ofs="+S);let ae=!0;for(let Pe=0;Pe<d;Pe++){let ee=T[Pe].g,Me=T[Pe].map;if(ee-=S,0>ee)S=Math.max(0,T[Pe].g-100),ae=!1;else try{FT(Me,N,"req"+ee+"_")}catch{p&&p(Me)}}if(ae){p=N.join("&");break e}}}return a=a.i.splice(0,d),l.D=a,p}function Wm(a){if(!a.g&&!a.u){a.Y=1;var l=a.Fa;Mi||tm(),Li||(Mi(),Li=!0),Ru.add(l,a),a.v=0}}function Ju(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Bi(g(a.Fa,a),Jm(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,Gm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Bi(g(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,je(10),No(this),Gm(this))};function Qu(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function Gm(a){a.g=new sn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var l=Lt(a.qa);le(l,"RID","rpc"),le(l,"SID",a.K),le(l,"AID",a.T),le(l,"CI",a.F?"0":"1"),!a.F&&a.ja&&le(l,"TO",a.ja),le(l,"TYPE","xmlhttp"),Yi(a,l),a.m&&a.o&&Gu(l,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Po(Lt(l)),d.m=null,d.P=!0,Im(d,a)}n.Za=function(){this.C!=null&&(this.C=null,No(this),Ju(this),je(19))};function Mo(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function Km(a,l){var d=null;if(a.g==l){Mo(a),Qu(a),a.g=null;var p=2}else if(Hu(a.h,l))d=l.D,Sm(a.h,l),p=1;else return;if(a.G!=0){if(l.o)if(p==1){d=l.m?l.m.length:0,l=Date.now()-l.F;var T=a.B;p=To(),Fe(p,new gm(p,d)),Oo(a)}else Wm(a);else if(T=l.s,T==3||T==0&&0<l.X||!(p==1&&zT(a,l)||p==2&&Ju(a)))switch(d&&0<d.length&&(l=a.h,l.i=l.i.concat(d)),T){case 1:Bn(a,5);break;case 4:Bn(a,10);break;case 3:Bn(a,6);break;default:Bn(a,2)}}}function Jm(a,l){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*l}function Bn(a,l){if(a.j.info("Error code "+l),l==2){var d=g(a.fb,a),p=a.Xa;let T=!p;p=new jn(p||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Ro(p,"https"),Po(p),T?xT(p.toString(),d):VT(p.toString(),d)}else je(2);a.G=0,a.l&&a.l.sa(l),Qm(a),zm(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function Qm(a){if(a.G=0,a.ka=[],a.l){let l=Rm(a.h);(l.length!=0||a.i.length!=0)&&(R(a.ka,l),R(a.ka,a.i),a.h.i.length=0,D(a.i),a.i.length=0),a.l.ra()}}function Ym(a,l,d){var p=d instanceof jn?Lt(d):new jn(d);if(p.g!="")l&&(p.g=l+"."+p.g),Co(p,p.s);else{var T=c.location;p=T.protocol,l=l?l+"."+T.hostname:T.hostname,T=+T.port;var S=new jn(null);p&&Ro(S,p),l&&(S.g=l),T&&Co(S,T),d&&(S.l=d),p=S}return d=a.D,l=a.ya,d&&l&&le(p,d,l),le(p,"VER",a.la),Yi(a,p),p}function Xm(a,l,d){if(l&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=a.Ca&&!a.pa?new fe(new Gi({eb:d})):new fe(a.pa),l.Ha(a.J),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zm(){}n=Zm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Lo(){}Lo.prototype.g=function(a,l){return new Ge(a,l)};function Ge(a,l){Oe.call(this),this.g=new $m(l),this.l=a,this.h=l&&l.messageUrlParams||null,a=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(a?a["X-WebChannel-Content-Type"]=l.messageContentType:a={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(a?a["X-WebChannel-Client-Profile"]=l.va:a={"X-WebChannel-Client-Profile":l.va}),this.g.S=a,(a=l&&l.Sb)&&!V(a)&&(this.g.m=a),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!V(l)&&(this.g.D=l,a=this.h,a!==null&&l in a&&(a=this.h,l in a&&delete a[l])),this.j=new Cr(this)}C(Ge,Oe),Ge.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ge.prototype.close=function(){Ku(this.g)},Ge.prototype.o=function(a){var l=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=xu(a),a=d);l.i.push(new ST(l.Ya++,a)),l.G==3&&Oo(l)},Ge.prototype.N=function(){this.g.l=null,delete this.j,Ku(this.g),delete this.g,Ge.aa.N.call(this)};function eg(a){Uu.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var l=a.__sm__;if(l){e:{for(let d in l){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,l=l!==null&&a in l?l[a]:void 0),this.data=l}else this.data=a}C(eg,Uu);function tg(){Fu.call(this),this.status=1}C(tg,Fu);function Cr(a){this.g=a}C(Cr,Zm),Cr.prototype.ua=function(){Fe(this.g,"a")},Cr.prototype.ta=function(a){Fe(this.g,new eg(a))},Cr.prototype.sa=function(a){Fe(this.g,new tg)},Cr.prototype.ra=function(){Fe(this.g,"b")},Lo.prototype.createWebChannel=Lo.prototype.g,Ge.prototype.send=Ge.prototype.o,Ge.prototype.open=Ge.prototype.m,Ge.prototype.close=Ge.prototype.close,Bd=Qt.createWebChannelTransport=function(){return new Lo},jd=Qt.getStatEventTarget=function(){return To()},Fd=Qt.Event=Un,kc=Qt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},bo.NO_ERROR=0,bo.TIMEOUT=8,bo.HTTP_ERROR=6,Zs=Qt.ErrorCode=bo,ym.COMPLETE="complete",Ud=Qt.EventType=ym,dm.EventType=Fi,Fi.OPEN="a",Fi.CLOSE="b",Fi.ERROR="c",Fi.MESSAGE="d",Oe.prototype.listen=Oe.prototype.K,oi=Qt.WebChannel=dm,MD=Qt.FetchXmlHttpFactory=Gi,fe.prototype.listenOnce=fe.prototype.L,fe.prototype.getLastError=fe.prototype.Ka,fe.prototype.getLastErrorCode=fe.prototype.Ba,fe.prototype.getStatus=fe.prototype.Z,fe.prototype.getResponseJson=fe.prototype.Oa,fe.prototype.getResponseText=fe.prototype.oa,fe.prototype.send=fe.prototype.ea,fe.prototype.setWithCredentials=fe.prototype.Ha,Vd=Qt.XhrIo=fe}).apply(typeof Pc<"u"?Pc:typeof self<"u"?self:typeof window<"u"?window:{});var OI="@firebase/firestore",MI="4.8.0";var Re=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Re.UNAUTHENTICATED=new Re(null),Re.GOOGLE_CREDENTIALS=new Re("google-credentials-uid"),Re.FIRST_PARTY=new Re("first-party-uid"),Re.MOCK_USER=new Re("mock-user");var Pi="11.10.0";var yr=new Et("@firebase/firestore");function ai(){return yr.logLevel}function x(n,...e){if(yr.logLevel<=Q.DEBUG){let t=e.map(Rp);yr.debug(`Firestore (${Pi}): ${n}`,...t)}}function Xt(n,...e){if(yr.logLevel<=Q.ERROR){let t=e.map(Rp);yr.error(`Firestore (${Pi}): ${n}`,...t)}}function Nn(n,...e){if(yr.logLevel<=Q.WARN){let t=e.map(Rp);yr.warn(`Firestore (${Pi}): ${n}`,...t)}}function Rp(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function B(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,wE(n,r,t)}function wE(n,e,t){let r=`FIRESTORE (${Pi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Xt(r),new Error(r)}function oe(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||wE(e,i,r)}function H(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},U=class extends Qe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var mt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Vc=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Wd=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Re.UNAUTHENTICATED))}shutdown(){}},Gd=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Kd=class{constructor(e){this.t=e,this.currentUser=Re.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){oe(this.o===void 0,42304);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new mt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new mt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new mt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(oe(typeof r.accessToken=="string",31837,{l:r}),new Vc(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string",2055,{h:e}),new Re(e)}},Jd=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Re.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Qd=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Jd(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Re.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Uc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Yd=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,We(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){oe(this.o===void 0,3512);let r=s=>{s.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,x("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Uc(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(oe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Uc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function LD(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function TE(){return new TextEncoder}var so=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=LD(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function K(n,e){return n<e?-1:n>e?1:0}function Xd(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return K(r,i);{let s=TE(),o=xD(s.encode(LI(n,t)),s.encode(LI(e,t)));return o!==0?o:K(r,i)}}t+=r>65535?2:1}return K(n.length,e.length)}function LI(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function xD(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return K(n[t],e[t]);return K(n.length,e.length)}function mi(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var xI="__name__",Fc=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&B(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return K(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Xd(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Jt.fromString(e.substring(4,e.length-2))}},de=class n extends Fc{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new U(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},VD=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xe=class n extends Fc{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return VD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===xI}static keyField(){return new n([xI])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new U(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new U(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new U(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new U(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var j=class n{constructor(e){this.path=e}static fromPath(e){return new n(de.fromString(e))}static fromName(e){return new n(de.fromString(e).popFirst(5))}static empty(){return new n(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&de.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return de.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new de(e.slice()))}};function bE(n,e,t){if(!t)throw new U(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function UD(n,e,t,r){if(e===!0&&r===!0)throw new U(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function VI(n){if(!j.isDocumentKey(n))throw new U(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function UI(n){if(j.isDocumentKey(n))throw new U(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function AE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Cp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B(12329,{type:typeof n})}function kt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new U(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Cp(n);throw new U(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Ee(n,e){let t={typeString:n};return e&&(t.value=e),t}function yo(n,e){if(!AE(n))throw new U(P.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new U(P.INVALID_ARGUMENT,t);return!0}var FI=-62135596800,jI=1e6,we=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*jI);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new U(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new U(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<FI)throw new U(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jI}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(yo(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-FI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};we._jsonSchemaVersion="firestore/timestamp/1.0",we._jsonSchema={type:Ee("string",we._jsonSchemaVersion),seconds:Ee("number"),nanoseconds:Ee("number")};var W=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new we(0,0))}static max(){return new n(new we(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var oo=-1,Zd=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Zd.UNKNOWN_ID=-1;function FD(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new we(t+1,0):new we(t,r));return new _r(i,j.empty(),e)}function jD(n){return new _r(n.readTime,n.key,oo)}var _r=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),j.empty(),oo)}static max(){return new n(W.max(),j.empty(),oo)}};function BD(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(n.documentKey,e.documentKey),t!==0?t:K(n.largestBatchId,e.largestBatchId))}var $D="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ef=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function ki(n){if(n.code!==P.FAILED_PRECONDITION||n.message!==$D)throw n;x("LocalStore","Unexpectedly lost primary lease")}var k=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),c=0;for(let u=0;u<s;u++){let h=u;t(e[h]).next(f=>{o[h]=f,++c,c===s&&r(o)},f=>i(f))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function zD(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Di(n){return n.name==="IndexedDbTransactionError"}var Pp=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),kp=-1;function _u(n){return n==null}function ao(n){return n===0&&1/n==-1/0}function qD(n){return typeof n=="number"&&Number.isInteger(n)&&!ao(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var SE="";function HD(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=BI(e)),e=WD(n.get(t),e);return BI(e)}function WD(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case SE:t+="";break;default:t+=s}}return t}function BI(n){return n+SE+""}var GD="remoteDocuments",RE="owner";var CE="mutationQueues";var PE="mutations";var kE="documentMutations",KD="remoteDocumentsV14";var DE="remoteDocumentGlobal";var NE="targets";var OE="targetDocuments";var ME="targetGlobal",LE="collectionParents";var xE="clientMetadata";var VE="bundles";var UE="namedQueries";var JD="indexConfiguration";var QD="indexState";var YD="indexEntries";var FE="documentOverlays";var XD="globals";var ZD=[CE,PE,kE,GD,NE,RE,ME,OE,xE,DE,LE,VE,UE],v2=[...ZD,FE],eN=[CE,PE,kE,KD,NE,RE,ME,OE,xE,DE,LE,VE,UE,FE],tN=eN,nN=[...tN,JD,QD,YD];var I2=[...nN,XD];function $I(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Vn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function jE(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var me=class n{constructor(e,t){this.comparator=e,this.root=t||Rt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hi(this.root,e,this.comparator,!1)}getReverseIterator(){return new hi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hi(this.root,e,this.comparator,!0)}},hi=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Rt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw B(43730,{key:this.key,value:this.value});if(this.right.isRed())throw B(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw B(27949);return e+(this.isRed()?0:1)}};Rt.EMPTY=null,Rt.RED=!0,Rt.BLACK=!1;Rt.EMPTY=new class{constructor(){this.size=0}get key(){throw B(57766)}get value(){throw B(16141)}get color(){throw B(16727)}get left(){throw B(29726)}get right(){throw B(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Rt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ce=class n{constructor(e){this.comparator=e,this.data=new me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jc(this.data.getIterator())}getIteratorFrom(e){return new jc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},jc=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var rt=class n{constructor(e){this.fields=e,e.sort(Xe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ce(Xe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mi(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Bc=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ue=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Bc("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ue.EMPTY_BYTE_STRING=new Ue("");var rN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zt(n){if(oe(!!n,39018),typeof n=="string"){let e=0,t=rN.exec(n);if(oe(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:he(n.seconds),nanos:he(n.nanos)}}function he(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function en(n){return typeof n=="string"?Ue.fromBase64String(n):Ue.fromUint8Array(n)}var BE="server_timestamp",$E="__type__",zE="__previous_value__",qE="__local_write_time__";function Dp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[$E])===null||t===void 0?void 0:t.stringValue)===BE}function vu(n){let e=n.mapValue.fields[zE];return Dp(e)?vu(e):e}function co(n){let e=Zt(n.mapValue.fields[qE].timestampValue);return new we(e.seconds,e.nanos)}var tf=class{constructor(e,t,r,i,s,o,c,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}},$c="(default)",zc=class n{constructor(e,t){this.projectId=e,this.database=t||$c}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===$c}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Np="__type__",HE="__max__",Dc={mapValue:{fields:{__type__:{stringValue:HE}}}},Op="__vector__",gi="value";function On(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Dp(n)?4:GE(n)?9007199254740991:WE(n)?10:11:B(28295,{value:n})}function Dt(n,e){if(n===e)return!0;let t=On(n);if(t!==On(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return co(n).isEqual(co(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Zt(i.timestampValue),c=Zt(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return en(i.bytesValue).isEqual(en(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return he(i.geoPointValue.latitude)===he(s.geoPointValue.latitude)&&he(i.geoPointValue.longitude)===he(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return he(i.integerValue)===he(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=he(i.doubleValue),c=he(s.doubleValue);return o===c?ao(o)===ao(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return mi(n.arrayValue.values||[],e.arrayValue.values||[],Dt);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},c=s.mapValue.fields||{};if($I(o)!==$I(c))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Dt(o[u],c[u])))return!1;return!0})(n,e);default:return B(52216,{left:n})}}function uo(n,e){return(n.values||[]).find(t=>Dt(t,e))!==void 0}function yi(n,e){if(n===e)return 0;let t=On(n),r=On(e);if(t!==r)return K(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return K(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let c=he(s.integerValue||s.doubleValue),u=he(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return zI(n.timestampValue,e.timestampValue);case 4:return zI(co(n),co(e));case 5:return Xd(n.stringValue,e.stringValue);case 6:return(function(s,o){let c=en(s),u=en(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let c=s.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){let f=K(c[h],u[h]);if(f!==0)return f}return K(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let c=K(he(s.latitude),he(o.latitude));return c!==0?c:K(he(s.longitude),he(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return qI(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var c,u,h,f;let m=s.fields||{},g=o.fields||{},A=(c=m[gi])===null||c===void 0?void 0:c.arrayValue,C=(u=g[gi])===null||u===void 0?void 0:u.arrayValue,D=K(((h=A?.values)===null||h===void 0?void 0:h.length)||0,((f=C?.values)===null||f===void 0?void 0:f.length)||0);return D!==0?D:qI(A,C)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Dc.mapValue&&o===Dc.mapValue)return 0;if(s===Dc.mapValue)return 1;if(o===Dc.mapValue)return-1;let c=s.fields||{},u=Object.keys(c),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){let g=Xd(u[m],f[m]);if(g!==0)return g;let A=yi(c[u[m]],h[f[m]]);if(A!==0)return A}return K(u.length,f.length)})(n.mapValue,e.mapValue);default:throw B(23264,{le:t})}}function zI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return K(n,e);let t=Zt(n),r=Zt(e),i=K(t.seconds,r.seconds);return i!==0?i:K(t.nanos,r.nanos)}function qI(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=yi(t[i],r[i]);if(s)return s}return K(t.length,r.length)}function _i(n){return nf(n)}function nf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=Zt(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return en(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return j.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=nf(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${nf(t.fields[o])}`;return i+"}"})(n.mapValue):B(61005,{value:n})}function Mc(n){switch(On(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=vu(n);return e?16+Mc(e):16;case 5:return 2*n.stringValue.length;case 6:return en(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+Mc(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Vn(r.fields,(s,o)=>{i+=s.length+Mc(o)}),i})(n.mapValue);default:throw B(13486,{value:n})}}function rf(n){return!!n&&"integerValue"in n}function Mp(n){return!!n&&"arrayValue"in n}function HI(n){return!!n&&"nullValue"in n}function WI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Lc(n){return!!n&&"mapValue"in n}function WE(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Np])===null||t===void 0?void 0:t.stringValue)===Op}function to(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Vn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=to(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=to(n.arrayValue.values[t]);return e}return Object.assign({},n)}function GE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===HE}var w2={mapValue:{fields:{[Np]:{stringValue:Op},[gi]:{arrayValue:{}}}}};var Ye=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Lc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=to(t)}setAll(e){let t=Xe.emptyPath(),r={},i=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=to(o):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Lc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Lc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Vn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(to(this.value))}};function KE(n){let e=[];return Vn(n.fields,(t,r)=>{let i=new Xe([t]);if(Lc(r)){let s=KE(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new rt(e)}var gt=class n{constructor(e,t,r,i,s,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),Ye.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),Ye.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),Ye.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ye.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ye.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var vi=class{constructor(e,t){this.position=e,this.inclusive=t}};function GI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=j.comparator(j.fromName(o.referenceValue),t.key):r=yi(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function KI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Dt(n.position[t],e.position[t]))return!1;return!0}var Ii=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function iN(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var qc=class{},be=class n extends qc{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new of(e,t,r):t==="array-contains"?new uf(e,r):t==="in"?new lf(e,r):t==="not-in"?new hf(e,r):t==="array-contains-any"?new df(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new af(e,r):new cf(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(yi(t,this.value)):t!==null&&On(this.value)===On(t)&&this.matchesComparison(yi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Nt=class n extends qc{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return JE(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function JE(n){return n.op==="and"}function QE(n){return sN(n)&&JE(n)}function sN(n){for(let e of n.filters)if(e instanceof Nt)return!1;return!0}function sf(n){if(n instanceof be)return n.field.canonicalString()+n.op.toString()+_i(n.value);if(QE(n))return n.filters.map(e=>sf(e)).join(",");{let e=n.filters.map(t=>sf(t)).join(",");return`${n.op}(${e})`}}function YE(n,e){return n instanceof be?(function(r,i){return i instanceof be&&r.op===i.op&&r.field.isEqual(i.field)&&Dt(r.value,i.value)})(n,e):n instanceof Nt?(function(r,i){return i instanceof Nt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,c)=>s&&YE(o,i.filters[c]),!0):!1})(n,e):void B(19439)}function XE(n){return n instanceof be?(function(t){return`${t.field.canonicalString()} ${t.op} ${_i(t.value)}`})(n):n instanceof Nt?(function(t){return t.op.toString()+" {"+t.getFilters().map(XE).join(" ,")+"}"})(n):"Filter"}var of=class extends be{constructor(e,t,r){super(e,t,r),this.key=j.fromName(r.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},af=class extends be{constructor(e,t){super(e,"in",t),this.keys=ZE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},cf=class extends be{constructor(e,t){super(e,"not-in",t),this.keys=ZE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function ZE(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>j.fromName(r.referenceValue))}var uf=class extends be{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Mp(t)&&uo(t.arrayValue,this.value)}},lf=class extends be{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&uo(this.value.arrayValue,t)}},hf=class extends be{constructor(e,t){super(e,"not-in",t)}matches(e){if(uo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!uo(this.value.arrayValue,t)}},df=class extends be{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Mp(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>uo(this.value.arrayValue,r))}};var ff=class{constructor(e,t=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Pe=null}};function JI(n,e=null,t=[],r=[],i=null,s=null,o=null){return new ff(n,e,t,r,i,s,o)}function Lp(n){let e=H(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>sf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),_u(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>_i(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>_i(r)).join(",")),e.Pe=t}return e.Pe}function xp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!iN(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!YE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!KI(n.startAt,e.startAt)&&KI(n.endAt,e.endAt)}function pf(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ei=class{constructor(e,t=null,r=[],i=[],s=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function oN(n,e,t,r,i,s,o,c){return new Ei(n,e,t,r,i,s,o,c)}function Vp(n){return new Ei(n)}function QI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function aN(n){return n.collectionGroup!==null}function no(n){let e=H(n);if(e.Te===null){e.Te=[];let t=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Ce(Xe.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Ii(s,r))}),t.has(Xe.keyField().canonicalString())||e.Te.push(new Ii(Xe.keyField(),r))}return e.Te}function Ct(n){let e=H(n);return e.Ie||(e.Ie=cN(e,no(n))),e.Ie}function cN(n,e){if(n.limitType==="F")return JI(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Ii(i.field,s)});let t=n.endAt?new vi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new vi(n.startAt.position,n.startAt.inclusive):null;return JI(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function mf(n,e,t){return new Ei(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Iu(n,e){return xp(Ct(n),Ct(e))&&n.limitType===e.limitType}function ew(n){return`${Lp(Ct(n))}|lt:${n.limitType}`}function ci(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>XE(i)).join(", ")}]`),_u(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>_i(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>_i(i)).join(",")),`Target(${r})`})(Ct(n))}; limitType=${n.limitType})`}function Eu(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):j.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of no(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){let h=GI(o,c,u);return o.inclusive?h<=0:h<0})(r.startAt,no(r),i)||r.endAt&&!(function(o,c,u){let h=GI(o,c,u);return o.inclusive?h>=0:h>0})(r.endAt,no(r),i))})(n,e)}function uN(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function tw(n){return(e,t)=>{let r=!1;for(let i of no(n)){let s=lN(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function lN(n,e,t){let r=n.field.isKeyField()?j.comparator(e.key,t.key):(function(s,o,c){let u=o.data.field(s),h=c.data.field(s);return u!==null&&h!==null?yi(u,h):B(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B(19790,{direction:n.dir})}}var tn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Vn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return jE(this.inner)}size(){return this.innerSize}};var hN=new me(j.comparator);function nn(){return hN}var nw=new me(j.comparator);function eo(...n){let e=nw;for(let t of n)e=e.insert(t.key,t);return e}function rw(n){let e=nw;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function fr(){return ro()}function iw(){return ro()}function ro(){return new tn(n=>n.toString(),(n,e)=>n.isEqual(e))}var dN=new me(j.comparator),fN=new Ce(j.comparator);function Y(...n){let e=fN;for(let t of n)e=e.add(t);return e}var pN=new Ce(K);function mN(){return pN}function Up(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ao(e)?"-0":e}}function sw(n){return{integerValue:""+n}}function gN(n,e){return qD(e)?sw(e):Up(n,e)}var wi=class{constructor(){this._=void 0}};function yN(n,e,t){return n instanceof Ti?(function(i,s){let o={fields:{[$E]:{stringValue:BE},[qE]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Dp(s)&&(s=vu(s)),s&&(o.fields[zE]=s),{mapValue:o}})(t,e):n instanceof vr?aw(n,e):n instanceof Ir?cw(n,e):(function(i,s){let o=ow(i,s),c=YI(o)+YI(i.Ee);return rf(o)&&rf(i.Ee)?sw(c):Up(i.serializer,c)})(n,e)}function _N(n,e,t){return n instanceof vr?aw(n,e):n instanceof Ir?cw(n,e):t}function ow(n,e){return n instanceof bi?(function(r){return rf(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var Ti=class extends wi{},vr=class extends wi{constructor(e){super(),this.elements=e}};function aw(n,e){let t=uw(e);for(let r of n.elements)t.some(i=>Dt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ir=class extends wi{constructor(e){super(),this.elements=e}};function cw(n,e){let t=uw(e);for(let r of n.elements)t=t.filter(i=>!Dt(i,r));return{arrayValue:{values:t}}}var bi=class extends wi{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function YI(n){return he(n.integerValue||n.doubleValue)}function uw(n){return Mp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function vN(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof vr&&i instanceof vr||r instanceof Ir&&i instanceof Ir?mi(r.elements,i.elements,Dt):r instanceof bi&&i instanceof bi?Dt(r.Ee,i.Ee):r instanceof Ti&&i instanceof Ti})(n.transform,e.transform)}var gf=class{constructor(e,t){this.version=e,this.transformResults=t}},Yt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function xc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Ai=class{};function lw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new lo(n.key,Yt.none()):new Er(n.key,n.data,Yt.none());{let t=n.data,r=Ye.empty(),i=new Ce(Xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ot(n.key,r,new rt(i.toArray()),Yt.none())}}function IN(n,e,t){n instanceof Er?(function(i,s,o){let c=i.value.clone(),u=ZI(i.fieldTransforms,s,o.transformResults);c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Ot?(function(i,s,o){if(!xc(i.precondition,s))return void s.convertToUnknownDocument(o.version);let c=ZI(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(hw(i)),u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function io(n,e,t,r){return n instanceof Er?(function(s,o,c,u){if(!xc(s.precondition,o))return c;let h=s.value.clone(),f=eE(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ot?(function(s,o,c,u){if(!xc(s.precondition,o))return c;let h=eE(s.fieldTransforms,u,o),f=o.data;return f.setAll(hw(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))})(n,e,t,r):(function(s,o,c){return xc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function EN(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=ow(r.transform,i||null);s!=null&&(t===null&&(t=Ye.empty()),t.set(r.field,s))}return t||null}function XI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&mi(r,i,(s,o)=>vN(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Er=class extends Ai{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ot=class extends Ai{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function hw(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function ZI(n,e,t){let r=new Map;oe(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,_N(o,c,t[i]))}return r}function eE(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,yN(s,o,e))}return r}var lo=class extends Ai{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},yf=class extends Ai{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var _f=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&IN(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=io(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=io(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=iw();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(i.key)?null:c;let u=lw(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Y())}isEqual(e){return this.batchId===e.batchId&&mi(this.mutations,e.mutations,(t,r)=>XI(t,r))&&mi(this.baseMutations,e.baseMutations,(t,r)=>XI(t,r))}},vf=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){oe(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return dN})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var If=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Ef=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ve,Z;function wN(n){switch(n){case P.OK:return B(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return B(15467,{code:n})}}function dw(n){if(n===void 0)return Xt("GRPC error has no .code"),P.UNKNOWN;switch(n){case ve.OK:return P.OK;case ve.CANCELLED:return P.CANCELLED;case ve.UNKNOWN:return P.UNKNOWN;case ve.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case ve.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case ve.INTERNAL:return P.INTERNAL;case ve.UNAVAILABLE:return P.UNAVAILABLE;case ve.UNAUTHENTICATED:return P.UNAUTHENTICATED;case ve.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case ve.NOT_FOUND:return P.NOT_FOUND;case ve.ALREADY_EXISTS:return P.ALREADY_EXISTS;case ve.PERMISSION_DENIED:return P.PERMISSION_DENIED;case ve.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case ve.ABORTED:return P.ABORTED;case ve.OUT_OF_RANGE:return P.OUT_OF_RANGE;case ve.UNIMPLEMENTED:return P.UNIMPLEMENTED;case ve.DATA_LOSS:return P.DATA_LOSS;default:return B(39323,{code:n})}}(Z=ve||(ve={}))[Z.OK=0]="OK",Z[Z.CANCELLED=1]="CANCELLED",Z[Z.UNKNOWN=2]="UNKNOWN",Z[Z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Z[Z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Z[Z.NOT_FOUND=5]="NOT_FOUND",Z[Z.ALREADY_EXISTS=6]="ALREADY_EXISTS",Z[Z.PERMISSION_DENIED=7]="PERMISSION_DENIED",Z[Z.UNAUTHENTICATED=16]="UNAUTHENTICATED",Z[Z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Z[Z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Z[Z.ABORTED=10]="ABORTED",Z[Z.OUT_OF_RANGE=11]="OUT_OF_RANGE",Z[Z.UNIMPLEMENTED=12]="UNIMPLEMENTED",Z[Z.INTERNAL=13]="INTERNAL",Z[Z.UNAVAILABLE=14]="UNAVAILABLE",Z[Z.DATA_LOSS=15]="DATA_LOSS";var tE=null;var TN=new Jt([4294967295,4294967295],0);function nE(n){let e=TE().encode(n),t=new xd;return t.update(e),new Uint8Array(t.digest())}function rE(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Jt([t,r],0),new Jt([i,s],0)]}var wf=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new pr(`Invalid padding: ${t}`);if(r<0)throw new pr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new pr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new pr(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Jt.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Jt.fromNumber(r)));return i.compare(TN)===1&&(i=new Jt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=nE(e),[r,i]=rE(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.fe===0)return;let t=nE(e),[r,i]=rE(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);this.we(o)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},pr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Hc=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,ho.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new me(K),nn(),Y())}},ho=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Y(),Y(),Y())}};var di=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},Wc=class{constructor(e,t){this.targetId=e,this.De=t}},Gc=class{constructor(e,t,r=Ue.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Kc=class{constructor(){this.ve=0,this.Ce=iE(),this.Fe=Ue.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Y(),t=Y(),r=Y();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:B(38017,{changeType:s})}}),new ho(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=iE()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,oe(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},Tf=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=nn(),this.je=Nc(),this.Je=Nc(),this.He=new me(K)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:B(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let s=i.target;if(pf(s))if(r===0){let o=new j(s.path);this.Xe(t,o,gt.newNoDocument(o,W.min()))}else oe(r===1,20013,{expectedCount:r});else{let o=this.ot(t);if(o!==r){let c=this._t(e),u=c?this.ut(c,e,o):1;if(u!==0){this.rt(t);let h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,h)}tE?.ct((function(f,m,g,A,C){var D,R,M,V,F,$;let ge={localCacheCount:f,existenceFilterCount:m.count,databaseId:g.database,projectId:g.projectId},X=m.unchangedNames;return X&&(ge.bloomFilter={applied:C===0,hashCount:(D=X?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(V=(M=(R=X?.bits)===null||R===void 0?void 0:R.bitmap)===null||M===void 0?void 0:M.length)!==null&&V!==void 0?V:0,padding:($=(F=X?.bits)===null||F===void 0?void 0:F.padding)!==null&&$!==void 0?$:0,mightContain:E=>{var y;return(y=A?.mightContain(E))!==null&&y!==void 0&&y}}),ge})(o,e.De,this.We.lt(),c,u))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,c;try{o=en(r).toUint8Array()}catch(u){if(u instanceof Bc)return Nn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new wf(o,i,s)}catch(u){return Nn(u instanceof pr?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.fe===0?null:c}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.We.lt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Xe(t,s,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((s,o)=>{let c=this.st(o);if(c){if(s.current&&pf(c.target)){let u=new j(c.target.path);this.Tt(u).has(o)||this.It(o,u)||this.Xe(o,u,gt.newNoDocument(u,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}});let r=Y();this.Je.forEach((s,o)=>{let c=!0;o.forEachWhile(u=>{let h=this.st(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));let i=new Hc(e,t,this.He,this.ze,r);return this.ze=nn(),this.je=Nc(),this.Je=Nc(),this.He=new me(K),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Kc,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Ce(K),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Ce(K),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||x("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Kc),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function Nc(){return new me(j.comparator)}function iE(){return new me(j.comparator)}var bN={asc:"ASCENDING",desc:"DESCENDING"},AN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},SN={and:"AND",or:"OR"},bf=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Af(n,e){return n.useProto3Json||_u(e)?e:{value:e}}function Jc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function RN(n,e){return Jc(n,e.toTimestamp())}function Pt(n){return oe(!!n,49232),W.fromTimestamp((function(t){let r=Zt(t);return new we(r.seconds,r.nanos)})(n))}function Fp(n,e){return Sf(n,e).canonicalString()}function Sf(n,e){let t=(function(i){return new de(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function pw(n){let e=de.fromString(n);return oe(vw(e),10190,{key:e.toString()}),e}function Rf(n,e){return Fp(n.databaseId,e.path)}function $d(n,e){let t=pw(e);if(t.get(1)!==n.databaseId.projectId)throw new U(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new U(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new j(gw(t))}function mw(n,e){return Fp(n.databaseId,e)}function CN(n){let e=pw(n);return e.length===4?de.emptyPath():gw(e)}function Cf(n){return new de(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function gw(n){return oe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function sE(n,e,t){return{name:Rf(n,e),fields:t.value.mapValue.fields}}function PN(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:B(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(h,f){return h.useProto3Json?(oe(f===void 0||typeof f=="string",58123),Ue.fromBase64String(f||"")):(oe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Ue.fromUint8Array(f||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){let f=h.code===void 0?P.UNKNOWN:dw(h.code);return new U(f,h.message||"")})(o);t=new Gc(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=$d(n,r.document.name),s=Pt(r.document.updateTime),o=r.document.createTime?Pt(r.document.createTime):W.min(),c=new Ye({mapValue:{fields:r.document.fields}}),u=gt.newFoundDocument(i,s,o,c),h=r.targetIds||[],f=r.removedTargetIds||[];t=new di(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=$d(n,r.document),s=r.readTime?Pt(r.readTime):W.min(),o=gt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new di([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=$d(n,r.document),s=r.removedTargetIds||[];t=new di([],s,i,null)}else{if(!("filter"in e))return B(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new Ef(i,s),c=r.targetId;t=new Wc(c,o)}}return t}function kN(n,e){let t;if(e instanceof Er)t={update:sE(n,e.key,e.value)};else if(e instanceof lo)t={delete:Rf(n,e.key)};else if(e instanceof Ot)t={update:sE(n,e.key,e.data),updateMask:FN(e.fieldMask)};else{if(!(e instanceof yf))return B(16599,{Rt:e.type});t={verify:Rf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,o){let c=o.transform;if(c instanceof Ti)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof vr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ir)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof bi)return{fieldPath:o.field.canonicalString(),increment:c.Ee};throw B(20930,{transform:o.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:RN(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:B(27497)})(n,e.precondition)),t}function DN(n,e){return n&&n.length>0?(oe(e!==void 0,14353),n.map(t=>(function(i,s){let o=i.updateTime?Pt(i.updateTime):Pt(s);return o.isEqual(W.min())&&(o=Pt(s)),new gf(o,i.transformResults||[])})(t,e))):[]}function NN(n,e){return{documents:[mw(n,e.path)]}}function ON(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=mw(n,i);let s=(function(h){if(h.length!==0)return _w(Nt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(h){if(h.length!==0)return h.map(f=>(function(g){return{field:ui(g.field),direction:xN(g.dir)}})(f))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=Af(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{Vt:t,parent:i}}function MN(n){let e=CN(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){oe(r===1,65062);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){let g=yw(m);return g instanceof Nt&&QE(g)?g.getFilters():[g]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map(g=>(function(C){return new Ii(li(C.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(g))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let g;return g=typeof m=="object"?m.value:m,_u(g)?null:g})(t.limit));let u=null;t.startAt&&(u=(function(m){let g=!!m.before,A=m.values||[];return new vi(A,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){let g=!m.before,A=m.values||[];return new vi(A,g)})(t.endAt)),oN(e,i,o,s,c,"F",u,h)}function LN(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function yw(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=li(t.unaryFilter.field);return be.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=li(t.unaryFilter.field);return be.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=li(t.unaryFilter.field);return be.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=li(t.unaryFilter.field);return be.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return B(61313);default:return B(60726)}})(n):n.fieldFilter!==void 0?(function(t){return be.create(li(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return B(58110);default:return B(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Nt.create(t.compositeFilter.filters.map(r=>yw(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B(1026)}})(t.compositeFilter.op))})(n):B(30097,{filter:n})}function xN(n){return bN[n]}function VN(n){return AN[n]}function UN(n){return SN[n]}function ui(n){return{fieldPath:n.canonicalString()}}function li(n){return Xe.fromServerFormat(n.fieldPath)}function _w(n){return n instanceof be?(function(t){if(t.op==="=="){if(WI(t.value))return{unaryFilter:{field:ui(t.field),op:"IS_NAN"}};if(HI(t.value))return{unaryFilter:{field:ui(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(WI(t.value))return{unaryFilter:{field:ui(t.field),op:"IS_NOT_NAN"}};if(HI(t.value))return{unaryFilter:{field:ui(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ui(t.field),op:VN(t.op),value:t.value}}})(n):n instanceof Nt?(function(t){let r=t.getFilters().map(i=>_w(i));return r.length===1?r[0]:{compositeFilter:{op:UN(t.op),filters:r}}})(n):B(54877,{filter:n})}function FN(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function vw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var fo=class n{constructor(e,t,r,i,s=W.min(),o=W.min(),c=Ue.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Pf=class{constructor(e){this.gt=e}};function jN(n){let e=MN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?mf(e,e.limit,"L"):e}var Qc=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(he(e.integerValue));else if("doubleValue"in e){let r=he(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),ao(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=Zt(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(en(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?GE(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):WE(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):B(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let s=e.fields||{};this.Ct(t,53);let o=gi,c=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(he(c)),this.xt(o,t),this.Dt(s[o],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),j.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};Qc.Ut=new Qc;var kf=class{constructor(){this.Dn=new Df}addToCollectionParentIndex(e,t){return this.Dn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(_r.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(_r.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}},Df=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ce(de.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ce(de.comparator)).toArray()}};var T2=new Uint8Array(0);var oE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Iw=41943040,nt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};nt.DEFAULT_COLLECTION_PERCENTILE=10,nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nt.DEFAULT=new nt(Iw,nt.DEFAULT_COLLECTION_PERCENTILE,nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nt.DISABLED=new nt(-1,0,0);var po=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var aE="LruGarbageCollector",BN=1048576;function cE([n,e],[t,r]){let i=K(n,t);return i===0?K(e,r):i}var Nf=class{constructor(e){this.Tr=e,this.buffer=new Ce(cE),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();cE(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Of=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){x(aE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Di(t)?x(aE,"Ignoring IndexedDB error during garbage collection: ",t):await ki(t)}await this.Rr(3e5)})}},Mf=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return k.resolve(Pp.ue);let r=new Nf(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(x("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(oE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oE):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,o,c,u,h,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(x("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,c=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(h=Date.now(),ai()<=Q.DEBUG&&x("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${s} targets in `+(u-c)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}};function $N(n,e){return new Mf(n,e)}var Lf=class{constructor(){this.changes=new tn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,gt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var xf=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Vf=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&io(r.mutation,i,rt.empty(),we.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Y()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Y()){let i=fr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=eo();return s.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=fr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Y()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,r,i){let s=nn(),o=ro(),c=(function(){return ro()})();return t.forEach((u,h)=>{let f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof Ot)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),io(f.mutation,h,f.mutation.getFieldMask(),we.now())):o.set(h.key,rt.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,f)=>o.set(h,f)),t.forEach((h,f)=>{var m;return c.set(h,new xf(f,(m=o.get(h))!==null&&m!==void 0?m:null))}),c))}recalculateAndSaveOverlays(e,t){let r=ro(),i=new me((o,c)=>o-c),s=Y();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let c of o)c.keys().forEach(u=>{let h=t.get(u);if(h===null)return;let f=r.get(u)||rt.empty();f=c.applyToLocalView(h,f),r.set(u,f);let m=(i.get(c.batchId)||Y()).add(u);i=i.insert(c.batchId,m)})}).next(()=>{let o=[],c=i.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),h=u.key,f=u.value,m=iw();f.forEach(g=>{if(!s.has(g)){let A=lw(t.get(g),r.get(g));A!==null&&m.set(g,A),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return k.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return j.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):aN(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):k.resolve(fr()),c=oo,u=s;return o.next(h=>k.forEach(h,(f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),s.get(f)?k.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,Y())).next(f=>({batchId:c,changes:rw(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(r=>{let i=eo();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=eo();return this.indexManager.getCollectionParents(e,s).next(c=>k.forEach(c,u=>{let h=(function(m,g){return new Ei(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,h)=>{let f=h.getKey();o.get(f)===null&&(o=o.insert(f,gt.newInvalidDocument(f)))});let c=eo();return o.forEach((u,h)=>{let f=s.get(u);f!==void 0&&io(f.mutation,h,rt.empty(),we.now()),Eu(t,h)&&(c=c.insert(u,h))}),c})}};var Uf=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return k.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Pt(i.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:jN(i.bundledQuery),readTime:Pt(i.readTime)}})(t)),k.resolve()}};var Ff=class{constructor(){this.overlays=new me(j.comparator),this.kr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){let r=fr();return k.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.wt(e,t,s)}),k.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){let i=fr(),s=t.length+1,o=new j(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return k.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new me((h,f)=>h-f),o=this.overlays.getIterator();for(;o.hasNext();){let h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=fr(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}let c=fr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return k.resolve(c)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new If(t,r));let s=this.kr.get(t);s===void 0&&(s=Y(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}};var jf=class{constructor(){this.sessionToken=Ue.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}};var mo=class{constructor(){this.qr=new Ce(Ie.Qr),this.$r=new Ce(Ie.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new Ie(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Ie(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new j(new de([])),r=new Ie(t,e),i=new Ie(t,e+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new j(new de([])),r=new Ie(t,e),i=new Ie(t,e+1),s=Y();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ie(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ie=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return j.comparator(e.key,t.key)||K(e.Hr,t.Hr)}static Ur(e,t){return K(e.Hr,t.Hr)||j.comparator(e.key,t.key)}};var Bf=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Ce(Ie.Qr)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new _f(s,t,r,i);this.mutationQueue.push(o);for(let c of i)this.Yr=this.Yr.add(new Ie(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,t){return k.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?kp:this.er-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ie(t,0),i=new Ie(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{let c=this.Zr(o.Hr);s.push(c)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ce(K);return t.forEach(i=>{let s=new Ie(i,0),o=new Ie(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],c=>{r=r.add(c.Hr)})}),k.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;j.isDocumentKey(s)||(s=s.child(""));let o=new Ie(new j(s),0),c=new Ce(K);return this.Yr.forEachWhile(u=>{let h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Hr)),!0)},o),k.resolve(this.ei(c))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){oe(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return k.forEach(t.mutations,i=>{let s=new Ie(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new Ie(t,0),i=this.Yr.firstAfterOrEqual(r);return k.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var $f=class{constructor(e){this.ni=e,this.docs=(function(){return new me(j.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():gt.newInvalidDocument(t))}getEntries(e,t){let r=nn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():gt.newInvalidDocument(i))}),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=nn(),o=t.path,c=new j(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||BD(jD(f),r)<=0||(i.has(f.key)||Eu(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return k.resolve(s)}getAllFromCollectionGroup(e,t,r,i){B(9500)}ri(e,t){return k.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new zf(this)}getSize(e){return k.resolve(this.size)}},zf=class extends Lf{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),k.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var qf=class{constructor(e){this.persistence=e,this.ii=new tn(t=>Lp(t),xp),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.si=0,this.oi=new mo,this.targetCount=0,this._i=po.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),k.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new po(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.hr(t),k.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ii.forEach((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),k.waitFor(s).next(()=>i)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),k.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this.oi.containsKey(t))}};var Yc=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new Pp(0),this.ci=!1,this.ci=!0,this.li=new jf,this.referenceDelegate=e(this),this.hi=new qf(this),this.indexManager=new kf,this.remoteDocumentCache=(function(i){return new $f(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new Pf(t),this.Ti=new Uf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ff,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new Bf(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){x("MemoryPersistence","Starting transaction:",e);let i=new Hf(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return k.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},Hf=class extends ef{constructor(e){super(),this.currentSequenceNumber=e}},Wf=class n{constructor(e){this.persistence=e,this.Ai=new mo,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw B(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.mi,r=>{let i=j.fromPath(r);return this.fi(e,i).next(s=>{s||t.removeEntry(i,W.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return k.or([()=>k.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Xc=class n{constructor(e,t){this.persistence=e,this.gi=new tn(r=>HD(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=$N(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return k.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?k.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,t).next(c=>{c||(r++,s.removeEntry(o,W.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),k.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Mc(e.data.value)),t}Sr(e,t,r){return k.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return k.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Gf=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=Y(),i=Y();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Kf=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Jf=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return g_()?8:zD(Se())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ps(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Kf;return this.ws(e,t,o).next(c=>{if(s.result=c,this.Rs)return this.Ss(e,t,o,c.size)})}).next(()=>s.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(ai()<=Q.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",ci(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),k.resolve()):(ai()<=Q.DEBUG&&x("QueryEngine","Query:",ci(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(ai()<=Q.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",ci(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ct(t))):k.resolve())}ps(e,t){if(QI(t))return k.resolve(null);let r=Ct(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=mf(t,null,"F"),r=Ct(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Y(...s);return this.gs.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{let h=this.bs(t,c);return this.Ds(t,h,o,u.readTime)?this.ps(e,mf(t,null,"F")):this.vs(e,h,t,u)}))})))}ys(e,t,r,i){return QI(t)||i.isEqual(W.min())?k.resolve(null):this.gs.getDocuments(e,r).next(s=>{let o=this.bs(t,s);return this.Ds(t,o,r,i)?k.resolve(null):(ai()<=Q.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ci(t)),this.vs(e,o,t,FD(i,oo)).next(c=>c))})}bs(e,t){let r=new Ce(tw(e));return t.forEach((i,s)=>{Eu(e,s)&&(r=r.add(s))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return ai()<=Q.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",ci(t)),this.gs.getDocumentsMatchingQuery(e,t,_r.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var jp="LocalStore",zN=3e8,Qf=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new me(K),this.Ms=new tn(s=>Lp(s),xp),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vf(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function qN(n,e,t,r){return new Qf(n,e,t,r)}async function Ew(n,e){let t=H(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],c=[],u=Y();for(let h of i){o.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}for(let h of s){c.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(r,u).next(h=>({Bs:h,removedBatchIds:o,addedBatchIds:c}))})})}function HN(n,e){let t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(c,u,h,f){let m=h.batch,g=m.keys(),A=k.resolve();return g.forEach(C=>{A=A.next(()=>f.getEntry(u,C)).next(D=>{let R=h.docVersions.get(C);oe(R!==null,48541),D.version.compareTo(R)<0&&(m.applyToRemoteDocument(D,h),D.isValidDocument()&&(D.setReadTime(h.commitVersion),f.addEntry(D)))})}),A.next(()=>c.mutationQueue.removeMutationBatch(u,m))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=Y();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function ww(n){let e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function WN(n,e){let t=H(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let c=[];e.targetChanges.forEach((f,m)=>{let g=i.get(m);if(!g)return;c.push(t.hi.removeMatchingKeys(s,f.removedDocuments,m).next(()=>t.hi.addMatchingKeys(s,f.addedDocuments,m)));let A=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?A=A.withResumeToken(Ue.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):f.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(f.resumeToken,r)),i=i.insert(m,A),(function(D,R,M){return D.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=zN?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0})(g,A,f)&&c.push(t.hi.updateTargetData(s,A))});let u=nn(),h=Y();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),c.push(GN(s,o,e.documentUpdates).next(f=>{u=f.Ls,h=f.ks})),!r.isEqual(W.min())){let f=t.hi.getLastRemoteSnapshotVersion(s).next(m=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(f)}return k.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(t.Fs=i,s))}function GN(n,e,t){let r=Y(),i=Y();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=nn();return t.forEach((c,u)=>{let h=s.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(W.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):x(jp,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Ls:o,ks:i}})}function KN(n,e){let t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=kp),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function JN(n,e){let t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(s=>s?(i=s,k.resolve(i)):t.hi.allocateTargetId(r).next(o=>(i=new fo(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}async function Yf(n,e,t){let r=H(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Di(o))throw o;x(jp,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function uE(n,e,t){let r=H(n),i=W.min(),s=Y();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(u,h,f){let m=H(u),g=m.Ms.get(f);return g!==void 0?k.resolve(m.Fs.get(g)):m.hi.getTargetData(h,f)})(r,o,Ct(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{s=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:W.min(),t?s:Y())).next(c=>(QN(r,uN(e),c),{documents:c,qs:s})))}function QN(n,e,t){let r=n.xs.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.xs.set(e,r)}var Zc=class{constructor(){this.activeTargetIds=mN()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Xf=class{constructor(){this.Fo=new Zc,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Zc,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Zf=class{xo(e){}shutdown(){}};var lE="ConnectivityMonitor",eu=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){x(lE,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){x(lE,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Oc=null;function ep(){return Oc===null?Oc=(function(){return 268435456+Math.round(2147483648*Math.random())})():Oc++,"0x"+Oc.toString(16)}var zd="RestConnection",YN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},tp=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===$c?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let o=ep(),c=this.Go(e,t.toUriEncodedString());x(zd,`Sending RPC '${e}' ${o}:`,c,r);let u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,i,s);let{host:h}=new URL(c),f=mn(h);return this.jo(e,c,u,r,f).then(m=>(x(zd,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Nn(zd,`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",r),m})}Jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Pi})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,t){let r=YN[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var np=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var Ve="WebChannelConnection",rp=class extends tp{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){let o=ep();return new Promise((c,u)=>{let h=new Vd;h.setWithCredentials(!0),h.listenOnce(Ud.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Zs.NO_ERROR:let m=h.getResponseJson();x(Ve,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),c(m);break;case Zs.TIMEOUT:x(Ve,`RPC '${e}' ${o} timed out`),u(new U(P.DEADLINE_EXCEEDED,"Request time out"));break;case Zs.HTTP_ERROR:let g=h.getStatus();if(x(Ve,`RPC '${e}' ${o} failed with status:`,g,"response text:",h.getResponseText()),g>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);let C=A?.error;if(C&&C.status&&C.message){let D=(function(M){let V=M.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(V)>=0?V:P.UNKNOWN})(C.status);u(new U(D,C.message))}else u(new U(P.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new U(P.UNAVAILABLE,"Connection failed."));break;default:B(9055,{c_:e,streamId:o,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{x(Ve,`RPC '${e}' ${o} completed.`)}});let f=JSON.stringify(i);x(Ve,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",f,r,15)})}P_(e,t,r){let i=ep(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Bd(),c=jd(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let f=s.join("");x(Ve,`Creating RPC '${e}' stream ${i}: ${f}`,u);let m=o.createWebChannel(f,u);this.T_(m);let g=!1,A=!1,C=new np({Ho:R=>{A?x(Ve,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(g||(x(Ve,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),x(Ve,`RPC '${e}' stream ${i} sending:`,R),m.send(R))},Yo:()=>m.close()}),D=(R,M,V)=>{R.listen(M,F=>{try{V(F)}catch($){setTimeout(()=>{throw $},0)}})};return D(m,oi.EventType.OPEN,()=>{A||(x(Ve,`RPC '${e}' stream ${i} transport opened.`),C.s_())}),D(m,oi.EventType.CLOSE,()=>{A||(A=!0,x(Ve,`RPC '${e}' stream ${i} transport closed`),C.__(),this.I_(m))}),D(m,oi.EventType.ERROR,R=>{A||(A=!0,Nn(Ve,`RPC '${e}' stream ${i} transport errored. Name:`,R.name,"Message:",R.message),C.__(new U(P.UNAVAILABLE,"The operation could not be completed")))}),D(m,oi.EventType.MESSAGE,R=>{var M;if(!A){let V=R.data[0];oe(!!V,16349);let F=V,$=F?.error||((M=F[0])===null||M===void 0?void 0:M.error);if($){x(Ve,`RPC '${e}' stream ${i} received error:`,$);let ge=$.status,X=(function(v){let I=ve[v];if(I!==void 0)return dw(I)})(ge),E=$.message;X===void 0&&(X=P.INTERNAL,E="Unknown error status: "+ge+" with message "+$.message),A=!0,C.__(new U(X,E)),m.close()}else x(Ve,`RPC '${e}' stream ${i} received:`,V),C.a_(V)}}),D(c,Fd.STAT_EVENT,R=>{R.stat===kc.PROXY?x(Ve,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===kc.NOPROXY&&x(Ve,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.o_()},0),C}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function qd(){return typeof document<"u"?document:null}function wu(n){return new bf(n,!0)}var tu=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&x("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var hE="PersistentStream",nu=class{constructor(e,t,r,i,s,o,c,u){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new tu(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(Xt(t.toString()),Xt("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new U(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return x(hE,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(x(hE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ip=class extends nu{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=PN(this.serializer,e),r=(function(s){if(!("targetChange"in s))return W.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?W.min():o.readTime?Pt(o.readTime):W.min()})(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=Cf(this.serializer),t.addTarget=(function(s,o){let c,u=o.target;if(c=pf(u)?{documents:NN(s,u)}:{query:ON(s,u).Vt},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=fw(s,o.resumeToken);let h=Af(s,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(W.min())>0){c.readTime=Jc(s,o.snapshotVersion.toTimestamp());let h=Af(s,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);let r=LN(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=Cf(this.serializer),t.removeTarget=e,this.k_(t)}},sp=class extends nu{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=DN(e.writeResults,e.commitTime),r=Pt(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=Cf(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>kN(this.serializer,r))};this.k_(t)}};var op=class{},ap=class extends op{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new U(P.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,Sf(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new U(P.UNKNOWN,s.toString())})}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Jo(e,Sf(t,r),i,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new U(P.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},cp=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Xt(t),this._a=!1):x("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var wr="RemoteStore",up=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Tr(this)&&(x(wr,"Restarting streams for network reachability change."),await(async function(u){let h=H(u);h.Ia.add(4),await _o(h),h.Aa.set("Unknown"),h.Ia.delete(4),await Tu(h)})(this))})}),this.Aa=new cp(r,i)}};async function Tu(n){if(Tr(n))for(let e of n.da)await e(!0)}async function _o(n){for(let e of n.da)await e(!1)}function Tw(n,e){let t=H(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),qp(t)?zp(t):Ni(t).x_()&&$p(t,e))}function Bp(n,e){let t=H(n),r=Ni(t);t.Ta.delete(e),r.x_()&&bw(t,e),t.Ta.size===0&&(r.x_()?r.B_():Tr(t)&&t.Aa.set("Unknown"))}function $p(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ni(n).H_(e)}function bw(n,e){n.Ra.$e(e),Ni(n).Y_(e)}function zp(n){n.Ra=new Tf({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Ni(n).start(),n.Aa.aa()}function qp(n){return Tr(n)&&!Ni(n).M_()&&n.Ta.size>0}function Tr(n){return H(n).Ia.size===0}function Aw(n){n.Ra=void 0}async function XN(n){n.Aa.set("Online")}async function ZN(n){n.Ta.forEach((e,t)=>{$p(n,e)})}async function eO(n,e){Aw(n),qp(n)?(n.Aa.la(e),zp(n)):n.Aa.set("Unknown")}async function tO(n,e,t){if(n.Aa.set("Online"),e instanceof Gc&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let c of s.targetIds)i.Ta.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ta.delete(c),i.Ra.removeTarget(c))})(n,e)}catch(r){x(wr,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ru(n,r)}else if(e instanceof di?n.Ra.Ye(e):e instanceof Wc?n.Ra.it(e):n.Ra.et(e),!t.isEqual(W.min()))try{let r=await ww(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let c=s.Ra.Pt(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){let f=s.Ta.get(h);f&&s.Ta.set(h,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{let f=s.Ta.get(u);if(!f)return;s.Ta.set(u,f.withResumeToken(Ue.EMPTY_BYTE_STRING,f.snapshotVersion)),bw(s,u);let m=new fo(f.target,u,h,f.sequenceNumber);$p(s,m)}),s.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){x(wr,"Failed to raise snapshot:",r),await ru(n,r)}}async function ru(n,e,t){if(!Di(e))throw e;n.Ia.add(1),await _o(n),n.Aa.set("Offline"),t||(t=()=>ww(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{x(wr,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Tu(n)})}function Sw(n,e){return e().catch(t=>ru(n,t,e))}async function bu(n){let e=H(n),t=Mn(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:kp;for(;nO(e);)try{let i=await KN(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,rO(e,i)}catch(i){await ru(e,i)}Rw(e)&&Cw(e)}function nO(n){return Tr(n)&&n.Pa.length<10}function rO(n,e){n.Pa.push(e);let t=Mn(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Rw(n){return Tr(n)&&!Mn(n).M_()&&n.Pa.length>0}function Cw(n){Mn(n).start()}async function iO(n){Mn(n).na()}async function sO(n){let e=Mn(n);for(let t of n.Pa)e.X_(t.mutations)}async function oO(n,e,t){let r=n.Pa.shift(),i=vf.from(r,e,t);await Sw(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await bu(n)}async function aO(n,e){e&&Mn(n).Z_&&await(async function(r,i){if((function(o){return wN(o)&&o!==P.ABORTED})(i.code)){let s=r.Pa.shift();Mn(r).N_(),await Sw(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await bu(r)}})(n,e),Rw(n)&&Cw(n)}async function dE(n,e){let t=H(n);t.asyncQueue.verifyOperationInProgress(),x(wr,"RemoteStore received new credentials");let r=Tr(t);t.Ia.add(3),await _o(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Tu(t)}async function cO(n,e){let t=H(n);e?(t.Ia.delete(2),await Tu(t)):e||(t.Ia.add(2),await _o(t),t.Aa.set("Unknown"))}function Ni(n){return n.Va||(n.Va=(function(t,r,i){let s=H(t);return s.ia(),new ip(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:XN.bind(null,n),e_:ZN.bind(null,n),n_:eO.bind(null,n),J_:tO.bind(null,n)}),n.da.push(async e=>{e?(n.Va.N_(),qp(n)?zp(n):n.Aa.set("Unknown")):(await n.Va.stop(),Aw(n))})),n.Va}function Mn(n){return n.ma||(n.ma=(function(t,r,i){let s=H(t);return s.ia(),new sp(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:iO.bind(null,n),n_:aO.bind(null,n),ea:sO.bind(null,n),ta:oO.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await bu(n)):(await n.ma.stop(),n.Pa.length>0&&(x(wr,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}var lp=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new mt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,c=new n(e,t,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Hp(n,e){if(Xt("AsyncQueue",`${e}: ${n}`),Di(n))return new U(P.UNAVAILABLE,`${e}: ${n}`);throw n}var iu=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||j.comparator(t.key,r.key):(t,r)=>j.comparator(t.key,r.key),this.keyedMap=eo(),this.sortedSet=new me(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var su=class{constructor(){this.fa=new me(j.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):B(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},Si=class n{constructor(e,t,r,i,s,o,c,u,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new n(e,t,iu.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Iu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var hp=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},dp=class{constructor(){this.queries=fE(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=H(t),s=i.queries;i.queries=fE(),s.forEach((o,c)=>{for(let u of c.wa)u.onError(r)})})(this,new U(P.ABORTED,"Firestore shutting down"))}};function fE(){return new tn(n=>ew(n),Iu)}async function Pw(n,e){let t=H(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new hp,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await t.onListen(i,!0);break;case 1:s.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let c=Hp(o,`Initialization of query '${ci(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&Wp(t)}async function kw(n,e){let t=H(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function uO(n,e){let t=H(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let c of o.wa)c.Ca(i)&&(r=!0);o.ya=i}}r&&Wp(t)}function lO(n,e,t){let r=H(n),i=r.queries.get(e);if(i)for(let s of i.wa)s.onError(t);r.queries.delete(e)}function Wp(n){n.Da.forEach(e=>{e.next()})}var fp,pE;(pE=fp||(fp={})).Fa="default",pE.Cache="cache";var ou=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Si(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Si.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==fp.Cache}};var au=class{constructor(e){this.key=e}},cu=class{constructor(e){this.key=e}},pp=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Y(),this.mutatedKeys=Y(),this.Xa=tw(e),this.eu=new iu(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new su,i=t?t.eu:this.eu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{let g=i.get(f),A=Eu(this.query,m)?m:null,C=!!g&&this.mutatedKeys.has(g.key),D=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations),R=!1;g&&A?g.data.isEqual(A.data)?C!==D&&(r.track({type:3,doc:A}),R=!0):this.iu(g,A)||(r.track({type:2,doc:A}),R=!0,(u&&this.Xa(A,u)>0||h&&this.Xa(A,h)<0)&&(c=!0)):!g&&A?(r.track({type:0,doc:A}),R=!0):g&&!A&&(r.track({type:1,doc:g}),R=!0,(u||h)&&(c=!0)),R&&(A?(o=o.add(A),s=D?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{eu:o,ru:r,Ds:c,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let o=e.ru.pa();o.sort((f,m)=>(function(A,C){let D=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B(20277,{At:R})}};return D(A)-D(C)})(f.type,m.type)||this.Xa(f.doc,m.doc)),this.su(r),i=i!=null&&i;let c=t&&!i?this.ou():[],u=this.Za.size===0&&this.current&&!i?1:0,h=u!==this.Ya;return this.Ya=u,o.length!==0||h?{snapshot:new Si(this.query,e.eu,s,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:c}:{_u:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new su,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=Y(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new cu(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new au(r))}),t}uu(e){this.Ha=e.qs,this.Za=Y();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Si.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},Gp="SyncEngine",mp=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},gp=class{constructor(e){this.key=e,this.lu=!1}},yp=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new tn(c=>ew(c),Iu),this.Tu=new Map,this.Iu=new Set,this.du=new me(j.comparator),this.Eu=new Map,this.Au=new mo,this.Ru={},this.Vu=new Map,this.mu=po.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};async function hO(n,e,t=!0){let r=xw(n),i,s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await Dw(r,e,t,!0),i}async function dO(n,e){let t=xw(n);await Dw(t,e,!0,!1)}async function Dw(n,e,t,r){let i=await JN(n.localStore,Ct(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=await fO(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Tw(n.remoteStore,i),c}async function fO(n,e,t,r,i){n.gu=(m,g,A)=>(async function(D,R,M,V){let F=R.view.nu(M);F.Ds&&(F=await uE(D.localStore,R.query,!1).then(({documents:E})=>R.view.nu(E,F)));let $=V&&V.targetChanges.get(R.targetId),ge=V&&V.targetMismatches.get(R.targetId)!=null,X=R.view.applyChanges(F,D.isPrimaryClient,$,ge);return gE(D,R.targetId,X._u),X.snapshot})(n,m,g,A);let s=await uE(n.localStore,e,!0),o=new pp(e,s.qs),c=o.nu(s.documents),u=ho.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=o.applyChanges(c,n.isPrimaryClient,u);gE(n,t,h._u);let f=new mp(e,t,o);return n.Pu.set(e,f),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),h.snapshot}async function pO(n,e,t){let r=H(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!Iu(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Yf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Bp(r.remoteStore,i.targetId),_p(r,i.targetId)}).catch(ki)):(_p(r,i.targetId),await Yf(r.localStore,i.targetId,!0))}async function mO(n,e){let t=H(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Bp(t.remoteStore,r.targetId))}async function gO(n,e,t){let r=TO(n);try{let i=await(function(o,c){let u=H(o),h=we.now(),f=c.reduce((A,C)=>A.add(C.key),Y()),m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",A=>{let C=nn(),D=Y();return u.Os.getEntries(A,f).next(R=>{C=R,C.forEach((M,V)=>{V.isValidDocument()||(D=D.add(M))})}).next(()=>u.localDocuments.getOverlayedDocuments(A,C)).next(R=>{m=R;let M=[];for(let V of c){let F=EN(V,m.get(V.key).overlayedDocument);F!=null&&M.push(new Ot(V.key,F,KE(F.value.mapValue),Yt.exists(!0)))}return u.mutationQueue.addMutationBatch(A,h,M,c)}).next(R=>{g=R;let M=R.applyToLocalDocumentSet(m,D);return u.documentOverlayCache.saveOverlays(A,R.batchId,M)})}).then(()=>({batchId:g.batchId,changes:rw(m)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let h=o.Ru[o.currentUser.toKey()];h||(h=new me(K)),h=h.insert(c,u),o.Ru[o.currentUser.toKey()]=h})(r,i.batchId,t),await vo(r,i.changes),await bu(r.remoteStore)}catch(i){let s=Hp(i,"Failed to persist write");t.reject(s)}}async function Nw(n,e){let t=H(n);try{let r=await WN(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Eu.get(s);o&&(oe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?oe(o.lu,14607):i.removedDocuments.size>0&&(oe(o.lu,42227),o.lu=!1))}),await vo(t,r,e)}catch(r){await ki(r)}}function mE(n,e,t){let r=H(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((s,o)=>{let c=o.view.va(e);c.snapshot&&i.push(c.snapshot)}),(function(o,c){let u=H(o);u.onlineState=c;let h=!1;u.queries.forEach((f,m)=>{for(let g of m.wa)g.va(c)&&(h=!0)}),h&&Wp(u)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function yO(n,e,t){let r=H(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),s=i&&i.key;if(s){let o=new me(j.comparator);o=o.insert(s,gt.newNoDocument(s,W.min()));let c=Y().add(s),u=new Hc(W.min(),new Map,new me(K),o,c);await Nw(r,u),r.du=r.du.remove(s),r.Eu.delete(e),Kp(r)}else await Yf(r.localStore,e,!1).then(()=>_p(r,e,t)).catch(ki)}async function _O(n,e){let t=H(n),r=e.batch.batchId;try{let i=await HN(t.localStore,e);Mw(t,r,null),Ow(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await vo(t,i)}catch(i){await ki(i)}}async function vO(n,e,t){let r=H(n);try{let i=await(function(o,c){let u=H(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(m=>(oe(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})})(r.localStore,e);Mw(r,e,t),Ow(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await vo(r,i)}catch(i){await ki(i)}}function Ow(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function Mw(n,e,t){let r=H(n),i=r.Ru[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function _p(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||Lw(n,r)})}function Lw(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(Bp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Kp(n))}function gE(n,e,t){for(let r of t)r instanceof au?(n.Au.addReference(r.key,e),IO(n,r)):r instanceof cu?(x(Gp,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||Lw(n,r.key)):B(19791,{yu:r})}function IO(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(x(Gp,"New document in limbo: "+t),n.Iu.add(r),Kp(n))}function Kp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new j(de.fromString(e)),r=n.mu.next();n.Eu.set(r,new gp(t)),n.du=n.du.insert(t,r),Tw(n.remoteStore,new fo(Ct(Vp(t.path)),r,"TargetPurposeLimboResolution",Pp.ue))}}async function vo(n,e,t){let r=H(n),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((c,u)=>{o.push(r.gu(u,e,t).then(h=>{var f;if((h||t)&&r.isPrimaryClient){let m=h?!h.fromCache:(f=t?.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(h){i.push(h);let m=Gf.Es(u.targetId,h);s.push(m)}}))}),await Promise.all(o),r.hu.J_(i),await(async function(u,h){let f=H(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>k.forEach(h,g=>k.forEach(g.Is,A=>f.persistence.referenceDelegate.addReference(m,g.targetId,A)).next(()=>k.forEach(g.ds,A=>f.persistence.referenceDelegate.removeReference(m,g.targetId,A)))))}catch(m){if(!Di(m))throw m;x(jp,"Failed to update sequence numbers: "+m)}for(let m of h){let g=m.targetId;if(!m.fromCache){let A=f.Fs.get(g),C=A.snapshotVersion,D=A.withLastLimboFreeSnapshotVersion(C);f.Fs=f.Fs.insert(g,D)}}})(r.localStore,s))}async function EO(n,e){let t=H(n);if(!t.currentUser.isEqual(e)){x(Gp,"User change. New user:",e.toKey());let r=await Ew(t.localStore,e);t.currentUser=e,(function(s,o){s.Vu.forEach(c=>{c.forEach(u=>{u.reject(new U(P.CANCELLED,o))})}),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await vo(t,r.Bs)}}function wO(n,e){let t=H(n),r=t.Eu.get(e);if(r&&r.lu)return Y().add(r.key);{let i=Y(),s=t.Tu.get(e);if(!s)return i;for(let o of s){let c=t.Pu.get(o);i=i.unionWith(c.view.tu)}return i}}function xw(n){let e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Nw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=yO.bind(null,e),e.hu.J_=uO.bind(null,e.eventManager),e.hu.pu=lO.bind(null,e.eventManager),e}function TO(n){let e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_O.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vO.bind(null,e),e}var Vw=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=wu(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,r){return null}Fu(t,r){return null}vu(t){return qN(this.persistence,new Jf,t.initialUser,this.serializer)}Du(t){return new Yc(Wf.Vi,this.serializer)}bu(t){return new Xf}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),vp=class extends Vw{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){oe(this.persistence.referenceDelegate instanceof Xc,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Of(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?nt.withCacheSize(this.cacheSizeBytes):nt.DEFAULT;return new Yc(r=>Xc.Vi(r,t),this.serializer)}};var bO=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>mE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=EO.bind(null,this.syncEngine),await cO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new dp})()}createDatastore(t){let r=wu(t.databaseInfo.databaseId),i=(function(o){return new rp(o)})(t.databaseInfo);return(function(o,c,u,h){return new ap(o,c,u,h)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,c,u){return new up(i,s,o,c,u)})(this.localStore,this.datastore,t.asyncQueue,r=>mE(this.syncEngine,r,0),(function(){return eu.C()?new eu:new Zf})())}createSyncEngine(t,r){return(function(s,o,c,u,h,f,m){let g=new yp(s,o,c,u,h,f);return m&&(g.fu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await(async function(s){let o=H(s);x(wr,"RemoteStore shutting down."),o.Ia.add(5),await _o(o),o.Ea.shutdown(),o.Aa.set("Unknown")})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}return n.provider={build:()=>new n},n})();var uu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Xt("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Ln="FirestoreClient",Ip=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Re.UNAUTHENTICATED,this.clientId=so.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{x(Ln,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(x(Ln,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new mt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Hp(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Hd(n,e){n.asyncQueue.verifyOperationInProgress(),x(Ln,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Ew(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{Nn("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{x("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Nn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e}async function yE(n,e){n.asyncQueue.verifyOperationInProgress();let t=await AO(n);x(Ln,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>dE(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>dE(e.remoteStore,i)),n._onlineComponents=e}async function AO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){x(Ln,"Using user provided OfflineComponentProvider");try{await Hd(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Nn("Error using user provided cache. Falling back to memory cache: "+t),await Hd(n,new Vw)}}else x(Ln,"Using default OfflineComponentProvider"),await Hd(n,new vp(void 0));return n._offlineComponents}async function Uw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(x(Ln,"Using user provided OnlineComponentProvider"),await yE(n,n._uninitializedComponentsProvider._online)):(x(Ln,"Using default OnlineComponentProvider"),await yE(n,new bO))),n._onlineComponents}function SO(n){return Uw(n).then(e=>e.syncEngine)}async function Fw(n){let e=await Uw(n),t=e.eventManager;return t.onListen=hO.bind(null,e.syncEngine),t.onUnlisten=pO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=dO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=mO.bind(null,e.syncEngine),t}function RO(n,e,t={}){let r=new mt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,c,u,h){let f=new uu({next:g=>{f.Ou(),o.enqueueAndForget(()=>kw(s,m));let A=g.docs.has(c);!A&&g.fromCache?h.reject(new U(P.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&g.fromCache&&u&&u.source==="server"?h.reject(new U(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new ou(Vp(c.path),f,{includeMetadataChanges:!0,ka:!0});return Pw(s,m)})(await Fw(n),n.asyncQueue,e,t,r)),r.promise}function CO(n,e,t={}){let r=new mt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,c,u,h){let f=new uu({next:g=>{f.Ou(),o.enqueueAndForget(()=>kw(s,m)),g.fromCache&&u.source==="server"?h.reject(new U(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new ou(c,f,{includeMetadataChanges:!0,ka:!0});return Pw(s,m)})(await Fw(n),n.asyncQueue,e,t,r)),r.promise}function jw(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var _E=new Map;var Bw="firestore.googleapis.com",vE=!0,lu=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new U(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Bw,this.ssl=vE}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:vE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Iw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BN)throw new U(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}UD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new U(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new U(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new U(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ri=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new U(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Wd;switch(r.type){case"firstParty":return new Qd(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new U(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=_E.get(t);r&&(x("ComponentProvider","Removing Datastore"),_E.delete(t),r.terminate())})(this),Promise.resolve()}};function $w(n,e,t,r={}){var i;n=kt(n,Ri);let s=mn(e),o=n._getSettings(),c=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),u=`${e}:${t}`;s&&(Fa(`https://${u}`),ja("Firestore",!0)),o.host!==Bw&&o.host!==u&&Nn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let h=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:r});if(!It(h,c)&&(n._setSettings(h),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=Re.MOCK_USER;else{f=l_(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new U(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Re(g)}n._authCredentials=new Gd(new Vc(f,m))}}var hu=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},De=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(yo(t,n._jsonSchema))return new n(e,r||null,new j(de.fromString(t.referencePath)))}};De._jsonSchemaVersion="firestore/documentReference/1.0",De._jsonSchema={type:Ee("string",De._jsonSchemaVersion),referencePath:Ee("string")};var Cn=class n extends hu{constructor(e,t,r){super(e,t,Vp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new De(this.firestore,null,new j(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function zw(n,e,...t){if(n=_e(n),bE("collection","path",e),n instanceof Ri){let r=de.fromString(e,...t);return UI(r),new Cn(n,null,r)}{if(!(n instanceof De||n instanceof Cn))throw new U(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(de.fromString(e,...t));return UI(r),new Cn(n.firestore,null,r)}}function qw(n,e,...t){if(n=_e(n),arguments.length===1&&(e=so.newId()),bE("doc","path",e),n instanceof Ri){let r=de.fromString(e,...t);return VI(r),new De(n,null,new j(r))}{if(!(n instanceof De||n instanceof Cn))throw new U(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(de.fromString(e,...t));return VI(r),new De(n.firestore,n instanceof Cn?n.converter:null,new j(r))}}var IE="AsyncQueue",du=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new tu(this,"async_queue_retry"),this.oc=()=>{let r=qd();r&&x(IE,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=qd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=qd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new mt;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Di(e))throw e;x(IE,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Xt("INTERNAL UNHANDLED ERROR: ",EE(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=lp.createAndSchedule(this,e,t,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&B(47125,{hc:EE(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function EE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var xn=class extends Ri{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new du,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new du(e),this._firestoreClient=void 0,await e}}};function Hw(n,e){let t=typeof n=="object"?n:er(),r=typeof n=="string"?n:e||$c,i=Yr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=u_("firestore");s&&$w(i,...s)}return i}function Jp(n){if(n._terminated)throw new U(P.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||PO(n),n._firestoreClient}function PO(n){var e,t,r;let i=n._freezeSettings(),s=(function(c,u,h,f){return new tf(c,u,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,jw(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Ip(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(c){let u=c?._online.build();return{_offline:c?._offline.build(u),_online:u}})(n._componentsProvider))}var Pn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ue.fromBase64String(e))}catch(t){throw new U(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ue.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(yo(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Pn._jsonSchemaVersion="firestore/bytes/1.0",Pn._jsonSchema={type:Ee("string",Pn._jsonSchemaVersion),bytes:Ee("string")};var Ci=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new U(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var go=class{constructor(e){this._methodName=e}};var kn=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new U(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new U(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(yo(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};kn._jsonSchemaVersion="firestore/geoPoint/1.0",kn._jsonSchema={type:Ee("string",kn._jsonSchemaVersion),latitude:Ee("number"),longitude:Ee("number")};var Dn=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(yo(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new U(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Dn._jsonSchemaVersion="firestore/vectorValue/1.0",Dn._jsonSchema={type:Ee("string",Dn._jsonSchemaVersion),vectorValues:Ee("object")};var kO=/^__.*__$/,Ep=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ot(e,this.data,this.fieldMask,t,this.fieldTransforms):new Er(e,this.data,t,this.fieldTransforms)}},fu=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ot(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Ww(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B(40011,{Ec:n})}}var wp=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return mu(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Ww(this.Ec)&&kO.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},Tp=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||wu(e)}Dc(e,t,r,i=!1){return new wp({Ec:e,methodName:t,bc:r,path:Xe.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Gw(n){let e=n._freezeSettings(),t=wu(n._databaseId);return new Tp(n._databaseId,!!e.ignoreUndefinedProperties,t)}function DO(n,e,t,r,i,s={}){let o=n.Dc(s.merge||s.mergeFields?2:0,e,t,i);Qp("Data must be an object, but it was:",o,r);let c=Kw(r,o),u,h;if(s.merge)u=new rt(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let m of s.mergeFields){let g=bp(e,m,t);if(!o.contains(g))throw new U(P.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Qw(f,g)||f.push(g)}u=new rt(f),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new Ep(new Ye(c),u,h)}var pu=class n extends go{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function NO(n,e,t,r){let i=n.Dc(1,e,t);Qp("Data must be an object, but it was:",i,r);let s=[],o=Ye.empty();Vn(r,(u,h)=>{let f=Yp(e,u,t);h=_e(h);let m=i.gc(f);if(h instanceof pu)s.push(f);else{let g=Au(h,m);g!=null&&(s.push(f),o.set(f,g))}});let c=new rt(s);return new fu(o,c,i.fieldTransforms)}function OO(n,e,t,r,i,s){let o=n.Dc(1,e,t),c=[bp(e,r,t)],u=[i];if(s.length%2!=0)throw new U(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)c.push(bp(e,s[g])),u.push(s[g+1]);let h=[],f=Ye.empty();for(let g=c.length-1;g>=0;--g)if(!Qw(h,c[g])){let A=c[g],C=u[g];C=_e(C);let D=o.gc(A);if(C instanceof pu)h.push(A);else{let R=Au(C,D);R!=null&&(h.push(A),f.set(A,R))}}let m=new rt(h);return new fu(f,m,o.fieldTransforms)}function Au(n,e){if(Jw(n=_e(n)))return Qp("Unsupported field value:",e,n),Kw(n,e);if(n instanceof go)return(function(r,i){if(!Ww(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let c of r){let u=Au(c,i.yc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=_e(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return gN(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=we.fromDate(r);return{timestampValue:Jc(i.serializer,s)}}if(r instanceof we){let s=new we(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Jc(i.serializer,s)}}if(r instanceof kn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pn)return{bytesValue:fw(i.serializer,r._byteString)};if(r instanceof De){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Fp(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Dn)return(function(o,c){return{mapValue:{fields:{[Np]:{stringValue:Op},[gi]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw c.wc("VectorValues must only contain numeric values.");return Up(c.serializer,h)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${Cp(r)}`)})(n,e)}function Kw(n,e){let t={};return jE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vn(n,(r,i)=>{let s=Au(i,e.Vc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function Jw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof we||n instanceof kn||n instanceof Pn||n instanceof De||n instanceof go||n instanceof Dn)}function Qp(n,e,t){if(!Jw(t)||!AE(t)){let r=Cp(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function bp(n,e,t){if((e=_e(e))instanceof Ci)return e._internalPath;if(typeof e=="string")return Yp(n,e);throw mu("Field path arguments must be of type string or ",n,!1,void 0,t)}var MO=new RegExp("[~\\*/\\[\\]]");function Yp(n,e,t){if(e.search(MO)>=0)throw mu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ci(...e.split("."))._internalPath}catch{throw mu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function mu(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new U(P.INVALID_ARGUMENT,c+n+u)}function Qw(n,e){return n.some(t=>t.isEqual(e))}var gu=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new De(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Ap(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Yw("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ap=class extends gu{data(){return super.data()}};function Yw(n,e){return typeof e=="string"?Yp(n,e):e instanceof Ci?e._internalPath:e._delegate._internalPath}function LO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new U(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Sp=class{convertValue(e,t="none"){switch(On(e)){case 0:return null;case 1:return e.booleanValue;case 2:return he(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(en(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Vn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[gi].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>he(o.doubleValue));return new Dn(s)}convertGeoPoint(e){return new kn(he(e.latitude),he(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=vu(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(co(e));default:return null}}convertTimestamp(e){let t=Zt(e);return new we(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=de.fromString(e);oe(vw(r),9688,{name:e});let i=new zc(r.get(1),r.get(3)),s=new j(r.popFirst(5));return i.isEqual(t)||Xt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function xO(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var mr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},gr=class n extends gu{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new fi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Yw("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new U(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};gr._jsonSchemaVersion="firestore/documentSnapshot/1.0",gr._jsonSchema={type:Ee("string",gr._jsonSchemaVersion),bundleSource:Ee("string","DocumentSnapshot"),bundleName:Ee("string"),bundle:Ee("string")};var fi=class extends gr{data(e={}){return super.data(e)}},pi=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new mr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new fi(this._firestore,this._userDataWriter,r.key,r,new mr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new U(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{let u=new fi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new mr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let u=new fi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new mr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,f=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:VO(c.type),doc:u,oldIndex:h,newIndex:f}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new U(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=so.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function VO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B(61501,{type:n})}}function Xw(n){n=kt(n,De);let e=kt(n.firestore,xn);return RO(Jp(e),n._key).then(t=>UO(e,n,t))}pi._jsonSchemaVersion="firestore/querySnapshot/1.0",pi._jsonSchema={type:Ee("string",pi._jsonSchemaVersion),bundleSource:Ee("string","QuerySnapshot"),bundleName:Ee("string"),bundle:Ee("string")};var yu=class extends Sp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new De(this.firestore,null,t)}};function Zw(n){n=kt(n,hu);let e=kt(n.firestore,xn),t=Jp(e),r=new yu(e);return LO(n._query),CO(t,n._query).then(i=>new pi(e,r,n,i))}function eT(n,e,t){n=kt(n,De);let r=kt(n.firestore,xn),i=xO(n.converter,e,t);return Xp(r,[DO(Gw(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Yt.none())])}function tT(n,e,t,...r){n=kt(n,De);let i=kt(n.firestore,xn),s=Gw(i),o;return o=typeof(e=_e(e))=="string"||e instanceof Ci?OO(s,"updateDoc",n._key,e,t,r):NO(s,"updateDoc",n._key,e),Xp(i,[o.toMutation(n._key,Yt.exists(!0))])}function nT(n){return Xp(kt(n.firestore,xn),[new lo(n._key,Yt.none())])}function Xp(n,e){return(function(r,i){let s=new mt;return r.asyncQueue.enqueueAndForget(async()=>gO(await SO(r),i,s)),s.promise})(Jp(n),e)}function UO(n,e,t){let r=t.docs.get(e._key),i=new yu(n);return new gr(n,i,e._key,r,new mr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Pi=i})(yn),dt(new qe("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),c=new xn(new Kd(r.getProvider("auth-internal")),new Yd(o,r.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new U(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zc(h.options.projectId,f)})(o,i),o);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),pe(OI,MI,e),pe(OI,MI,"esm2017")})();var br=class{constructor(e){return e}},rT="firestore",Zp=class{constructor(){return Zr(rT)}};var em=new ne("angularfire2.firestore-instances");function FO(n,e){let t=ks(rT,n,e);return t&&new br(t)}function jO(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new br(r)}}var BO={provide:Zp,deps:[[new tt,em]]},$O={provide:br,useFactory:FO,deps:[[new tt,em],zt]};function kj(n,...e){return pe("angularfire",_n.full,"fst"),ot([$O,BO,{provide:em,useFactory:jO(n),multi:!0,deps:[$e,ct,vn,nr,[new tt,Xs],[new tt,ei],...e]}])}var iT=Te(zw,!0,2);var sT=Te(nT,!0,2);var Ar=Te(qw,!0,2);var oT=Te(Xw,!0);var aT=Te(Zw,!0);var Dj=Te(Hw,!0);var cT=Te(eT,!0,2);var Su=Te(tT,!0,2);var uT=class n{auth=L(dr);firestore=L(br);router=L(Yn);user$=RI(this.auth);currentUser=ln(null);constructor(){try{PI(this.auth,Ys).then(()=>console.log("Auth Persistence set to SESSION")).catch(e=>console.error("Auth Persistence Failed:",e))}catch(e){console.error("Critical Auth Persistence Error:",e)}this.user$.pipe(Be(e=>e?this.getUserDocument(e.uid):G(null))).subscribe(e=>{this.currentUser.set(e)})}login(e,t){return xe(kI(this.auth,e,t)).pipe(Be(r=>this.getUserDocument(r.user.uid).pipe(ce(i=>({user:i,uid:r.user.uid})))),ce(({user:r,uid:i})=>{if(r){if(r.email==="admin@test.com"&&r.role!=="admin"){r.role="admin";let s=Ar(this.firestore,`users/${i}`);Su(s,{role:"admin"}).catch(o=>console.error("Admin auto-update failed",o))}return r.isActive?(r.role==="admin"?this.router.navigate(["/admin"]):this.router.navigate(["/dashboard"]),{success:!0,user:r}):(Ld(this.auth),{success:!1,message:"AUTH.USER_DISABLED"})}else{let s=this.auth.currentUser;if(s||i){let o={id:i,name:s?.displayName||"User",email:s?.email||e||"",role:(s?.email||e)==="admin@test.com"?"admin":"user",isActive:!0};return this.createUserDocument(o),this.router.navigate(["/dashboard"]),{success:!0,user:o}}return{success:!1,message:"AUTH.USER_NOT_FOUND"}}}),kr(r=>Xi(()=>this.mapFirebaseError(r))))}register(e){return xe(CI(this.auth,e.email,e.password)).pipe(Be(async t=>{let r={id:t.user.uid,name:e.name,email:e.email,role:e.email==="admin@test.com"?"admin":"user",isActive:!0,avatar:""};return await this.createUserDocument(r),{success:!0,user:r}}),kr(t=>Xi(()=>this.mapFirebaseError(t))))}logout(){Ld(this.auth).then(()=>{this.router.navigate(["/login"])})}mapFirebaseError(e){let t=e.code||"";switch(t){case"auth/email-already-in-use":return"AUTH.EMAIL_EXISTS";case"auth/invalid-credential":return"AUTH.INVALID_CREDENTIALS";case"auth/weak-password":return"AUTH.WEAK_PASSWORD";case"auth/user-disabled":return"AUTH.USER_DISABLED";case"auth/operation-not-allowed":return"AUTH.OPERATION_NOT_ALLOWED";case"auth/user-not-found":return"AUTH.USER_NOT_FOUND";case"auth/wrong-password":return"AUTH.WRONG_PASSWORD";case"auth/too-many-requests":return"AUTH.TOO_MANY_REQUESTS";case"auth/network-request-failed":return"AUTH.NETWORK_ERROR";default:return e.message&&(e.message.includes("offline")||e.message.includes("400"))?"AUTH.DATABASE_ERROR":t||e.message}}async createUserDocument(e){let t=Ar(this.firestore,`users/${e.id}`);await cT(t,e)}getUserDocument(e){let t=Ar(this.firestore,`users/${e}`);return xe(oT(t)).pipe(ce(r=>r.exists()?O({id:r.id},r.data()):null))}getAllUsers(){let e=iT(this.firestore,"users");return xe(aT(e)).pipe(ce(t=>t.docs.map(r=>O({id:r.id},r.data()))))}updateUserStatus(e,t){let r=Ar(this.firestore,`users/${e}`);Su(r,{isActive:t})}deleteUser(e){let t=Ar(this.firestore,`users/${e}`);sT(t)}updateUser(e){if(!this.currentUser())return;let t=Ar(this.firestore,`users/${e.id}`);Su(t,O({},e)).then(()=>{this.currentUser.set(e)})}get isLoggedIn(){return!!this.currentUser()}get isAdmin(){return this.currentUser()?.role==="admin"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})};export{nb as a,kb as b,mx as c,gx as d,$x as e,Qa as f,_C as g,zx as h,EC as i,pt as j,qx as k,Tt as l,Ls as m,ti as n,bt as o,ue as p,ni as q,ii as r,lP as s,ir as t,Xa as u,dP as v,fP as w,sV as x,ri as y,r2 as z,i2 as A,br as B,kj as C,Ar as D,oT as E,Dj as F,cT as G,Bt as H,jl as I,Yn as J,i_ as K,hS as L,uT as M};
