import{$ as tt,A as Uo,Aa as yg,Ab as rl,B as ln,Ba as Ho,Bb as il,C as Yu,Cb as Og,Da as _g,Db as Go,E as og,Ea as vg,Eb as es,F as Be,Fa as Vr,Fb as Mg,G as Fo,Ga as Ig,Gb as Lg,H as He,Ha as Eg,Hb as xg,I as ag,Ia as nl,Ib as Vg,J as cg,Ja as wg,Jb as Ko,K as se,L as Xu,La as Wo,N as J,P as ug,Pa as Tg,Q as ne,Qa as bg,Qb as Jo,R as te,Ra as Ag,Rb as Qo,S as x,Sa as Sg,T as at,Ta as Rg,Tb as Ug,V as lg,W as ct,X as De,Xa as Cg,_ as ut,a as Zm,aa as jo,b as eg,ba as hg,c as ot,ca as Mr,cb as Pg,d as Bn,da as $e,e as et,ea as Zu,f as tg,fa as Bo,g as ng,ga as hn,h as Vt,ha as Lr,i as Gu,j as Ku,ja as Ft,k as Ju,ka as nt,l as xe,la as $o,m as G,ma as zo,n as Yi,na as dg,o as Qu,p as rg,pa as fg,q as ce,qa as pg,r as ig,ra as el,s as un,sa as mg,t as sg,ta as xr,u as Vo,ua as tl,va as qo,w as Ut,wb as kg,x as Nr,xa as gg,y as Xi,yb as Dg,z as Or,za as Zi,zb as Ng}from"./chunk-REDDOPKR.js";import{a as M,b as ve,c as xo}from"./chunk-XXUG4HYI.js";var ts=class{_doc;constructor(e){this._doc=e}manager},Yo=(()=>{class n extends ts{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(te(tt))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),ea=new ne(""),cl=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(o=>{o.manager=this});let i=t.filter(o=>!(o instanceof Yo));this._plugins=i.slice().reverse();let s=t.find(o=>o instanceof Yo);s&&this._plugins.push(s)}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new se(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(te(ea),te($e))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),sl="ng-app-id";function Fg(n){for(let e of n)e.remove()}function jg(n,e){let t=e.createElement("style");return t.textContent=n,t}function qT(n,e,t,r){let i=n.head?.querySelectorAll(`style[${sl}="${e}"],link[${sl}="${e}"]`);if(i)for(let s of i)s.removeAttribute(sl),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function al(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var ul=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,qT(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,jg);r?.forEach(i=>this.addUsage(i,this.external,al))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(Fg(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Fg(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,jg(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,al(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(te(tt),te(el),te(tl,8),te(xr))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),ol={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ll=/%COMP%/g;var $g="%COMP%",HT=`_nghost-${$g}`,WT=`_ngcontent-${$g}`,GT=!0,KT=new ne("",{factory:()=>GT});function JT(n){return WT.replace(ll,n)}function QT(n){return HT.replace(ll,n)}function zg(n,e){return e.map(t=>t.replace(ll,n))}var hl=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,r,i,s,o,c,u=null,h=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=c,this.nonce=u,this.tracingService=h,this.defaultRenderer=new ns(t,o,c,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof Zo?i.applyToHost(t):i instanceof rs&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,c=this.ngZone,u=this.eventManager,h=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,m=this.tracingService;switch(r.encapsulation){case qo.Emulated:s=new Zo(u,h,r,this.appId,f,o,c,m);break;case qo.ShadowDom:return new Xo(u,t,r,o,c,this.nonce,m,h);case qo.ExperimentalIsolatedShadowDom:return new Xo(u,t,r,o,c,this.nonce,m);default:s=new rs(u,h,r,f,o,c,m);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(te(cl),te(ul),te(el),te(KT),te(tt),te($e),te(tl),te(Ho,8))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),ns=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(ol[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Bg(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Bg(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new se(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=ol[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=ol[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Zi.DashCase|Zi.Important)?e.style.setProperty(t,r,i&Zi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Zi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=es().getGlobalEventTarget(this.doc,e),!e))throw new se(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function Bg(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Xo=class extends ns{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,s,o,c,u){super(e,i,s,c),this.hostEl=t,this.sharedStylesHost=u,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let h=r.styles;h=zg(r.id,h);for(let m of h){let g=document.createElement("style");o&&g.setAttribute("nonce",o),g.textContent=m,this.shadowRoot.appendChild(g)}let f=r.getExternalStyles?.();if(f)for(let m of f){let g=al(m,i);o&&g.setAttribute("nonce",o),this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},rs=class extends ns{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,c,u){super(e,s,o,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let h=r.styles;this.styles=u?zg(u,h):h,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&yg.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Zo=class extends rs{contentAttr;hostAttr;constructor(e,t,r,i,s,o,c,u){let h=i+"-"+r.id;super(e,t,r,s,o,c,u,h),this.contentAttr=JT(h),this.hostAttr=QT(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var ta=class n extends Lg{supportsDOMEvents=!0;static makeCurrent(){Mg(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=YT();return t==null?null:XT(t)}resetBaseElement(){is=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Jo(document.cookie,e)}},is=null;function YT(){return is=is||document.head.querySelector("base"),is?is.getAttribute("href"):null}function XT(n){return new URL(n,document.baseURI).pathname}var ZT=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),qg=["alt","control","meta","shift"],eb={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},tb={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Hg=(()=>{class n extends ts{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),c=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>es().onAndCancel(t,o.domEventName,c,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),qg.forEach(h=>{let f=r.indexOf(h);f>-1&&(r.splice(f,1),o+=h+".")}),o+=s,r.length!=0||s.length===0)return null;let u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let i=eb[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),qg.forEach(o=>{if(o!==i){let c=tb[o];c(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(te(tt))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})();function nb(n,e,t){let r=M({rootComponent:n,platformRef:t?.platformRef},rb(e));return Og(r)}function rb(n){return{appProviders:[...cb,...n?.providers??[]],platformProviders:ab}}function ib(){ta.makeCurrent()}function sb(){return new Zu}function ob(){return pg(document),document}var ab=[{provide:xr,useValue:Ug},{provide:mg,useValue:ib,multi:!0},{provide:tt,useFactory:ob}];var cb=[{provide:lg,useValue:"root"},{provide:Zu,useFactory:sb},{provide:ea,useClass:Yo,multi:!0},{provide:ea,useClass:Hg,multi:!0},hl,ul,cl,{provide:_g,useExisting:hl},{provide:Qo,useClass:ZT},[]];var zn=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=t.slice(r+1).trim();this.addHeaderEntry(i,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(c=>s.indexOf(c)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var ra=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}},ia=class{encodeKey(e){return Wg(e)}encodeValue(e){return Wg(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function ub(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,c]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],u=t.get(o)||[];u.push(c),t.set(o,u)}),t}var lb=/%(\d[a-f0-9])/gi,hb={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Wg(n){return encodeURIComponent(n).replace(lb,(e,t)=>hb[t]??e)}function na(n){return`${n}`}var dn=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new ia,e.fromString){if(e.fromObject)throw new se(2805,!1);this.map=ub(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(na):[na(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(na(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(na(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};function db(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Gg(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Kg(n){return typeof Blob<"u"&&n instanceof Blob}function Jg(n){return typeof FormData<"u"&&n instanceof FormData}function fb(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Qg="Content-Type",Yg="Accept",Xg="text/plain",Zg="application/json",pb=`${Zg}, ${Xg}, */*`,ss=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,r,i){this.url=t,this.method=e.toUpperCase();let s;if(db(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s){if(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,this.keepalive=!!s.keepalive,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),s.priority&&(this.priority=s.priority),s.cache&&(this.cache=s.cache),s.credentials&&(this.credentials=s.credentials),typeof s.timeout=="number"){if(s.timeout<1||!Number.isInteger(s.timeout))throw new se(2822,"");this.timeout=s.timeout}s.mode&&(this.mode=s.mode),s.redirect&&(this.redirect=s.redirect),s.integrity&&(this.integrity=s.integrity),s.referrer&&(this.referrer=s.referrer),s.referrerPolicy&&(this.referrerPolicy=s.referrerPolicy),this.transferCache=s.transferCache}if(this.headers??=new zn,this.context??=new ra,!this.params)this.params=new dn,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),u=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+u+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Gg(this.body)||Kg(this.body)||Jg(this.body)||fb(this.body)?this.body:this.body instanceof dn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Jg(this.body)?null:Kg(this.body)?this.body.type||null:Gg(this.body)?null:typeof this.body=="string"?Xg:this.body instanceof dn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Zg:null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.keepalive??this.keepalive,o=e.priority||this.priority,c=e.cache||this.cache,u=e.mode||this.mode,h=e.redirect||this.redirect,f=e.credentials||this.credentials,m=e.referrer||this.referrer,g=e.integrity||this.integrity,A=e.referrerPolicy||this.referrerPolicy,P=e.transferCache??this.transferCache,D=e.timeout??this.timeout,R=e.body!==void 0?e.body:this.body,O=e.withCredentials??this.withCredentials,U=e.reportProgress??this.reportProgress,B=e.headers||this.headers,z=e.params||this.params,ge=e.context??this.context;return e.setHeaders!==void 0&&(B=Object.keys(e.setHeaders).reduce((X,E)=>X.set(E,e.setHeaders[E]),B)),e.setParams&&(z=Object.keys(e.setParams).reduce((X,E)=>X.set(E,e.setParams[E]),z)),new n(t,r,R,{params:z,headers:B,context:ge,reportProgress:U,responseType:i,withCredentials:O,transferCache:P,keepalive:s,cache:c,priority:o,timeout:D,mode:u,redirect:h,credentials:f,referrer:m,integrity:g,referrerPolicy:A})}},Ur=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(Ur||{}),Fr=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,r="OK"){this.headers=e.headers||new zn,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}},sa=class n extends Fr{constructor(e={}){super(e)}type=Ur.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},oa=class n extends Fr{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=Ur.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}},os=class extends Fr{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},mb=200,gb=204;var yb=new ne("");var _b=/^\)\]\}',?\n/;var ml=(()=>{class n{xhrFactory;tracingService=x(Ho,{optional:!0});constructor(t){this.xhrFactory=t}maybePropagateTrace(t){return this.tracingService?.propagate?this.tracingService.propagate(t):t}handle(t){if(t.method==="JSONP")throw new se(-2800,!1);let r=this.xhrFactory;return G(null).pipe(Be(()=>new ot(s=>{let o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((R,O)=>o.setRequestHeader(R,O.join(","))),t.headers.has(Yg)||o.setRequestHeader(Yg,pb),!t.headers.has(Qg)){let R=t.detectContentTypeHeader();R!==null&&o.setRequestHeader(Qg,R)}if(t.timeout&&(o.timeout=t.timeout),t.responseType){let R=t.responseType.toLowerCase();o.responseType=R!=="json"?R:"text"}let c=t.serializeBody(),u=null,h=()=>{if(u!==null)return u;let R=o.statusText||"OK",O=new zn(o.getAllResponseHeaders()),U=o.responseURL||t.url;return u=new sa({headers:O,status:o.status,statusText:R,url:U}),u},f=this.maybePropagateTrace(()=>{let{headers:R,status:O,statusText:U,url:B}=h(),z=null;O!==gb&&(z=typeof o.response>"u"?o.responseText:o.response),O===0&&(O=z?mb:0);let ge=O>=200&&O<300;if(t.responseType==="json"&&typeof z=="string"){let X=z;z=z.replace(_b,"");try{z=z!==""?JSON.parse(z):null}catch(E){z=X,ge&&(ge=!1,z={error:E,text:z})}}ge?(s.next(new oa({body:z,headers:R,status:O,statusText:U,url:B||void 0})),s.complete()):s.error(new os({error:z,headers:R,status:O,statusText:U,url:B||void 0}))}),m=this.maybePropagateTrace(R=>{let{url:O}=h(),U=new os({error:R,status:o.status||0,statusText:o.statusText||"Unknown Error",url:O||void 0});s.error(U)}),g=m;t.timeout&&(g=this.maybePropagateTrace(R=>{let{url:O}=h(),U=new os({error:new DOMException("Request timed out","TimeoutError"),status:o.status||0,statusText:o.statusText||"Request timeout",url:O||void 0});s.error(U)}));let A=!1,P=this.maybePropagateTrace(R=>{A||(s.next(h()),A=!0);let O={type:Ur.DownloadProgress,loaded:R.loaded};R.lengthComputable&&(O.total=R.total),t.responseType==="text"&&o.responseText&&(O.partialText=o.responseText),s.next(O)}),D=this.maybePropagateTrace(R=>{let O={type:Ur.UploadProgress,loaded:R.loaded};R.lengthComputable&&(O.total=R.total),s.next(O)});return o.addEventListener("load",f),o.addEventListener("error",m),o.addEventListener("timeout",g),o.addEventListener("abort",m),t.reportProgress&&(o.addEventListener("progress",P),c!==null&&o.upload&&o.upload.addEventListener("progress",D)),o.send(c),s.next({type:Ur.Sent}),()=>{o.removeEventListener("error",m),o.removeEventListener("abort",m),o.removeEventListener("load",f),o.removeEventListener("timeout",g),t.reportProgress&&(o.removeEventListener("progress",P),c!==null&&o.upload&&o.upload.removeEventListener("progress",D)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(r){return new(r||n)(te(Qo))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function vb(n,e){return e(n)}function Ib(n,e,t){return(r,i)=>De(t,()=>e(r,s=>n(s,i)))}var ey=new ne("",{factory:()=>[]}),Eb=new ne(""),ty=new ne("",{factory:()=>!0});var gl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=te(ml),i},providedIn:"root"})}return n})();var aa=(()=>{class n{backend;injector;chain=null;pendingTasks=x(Lr);contributeToStability=x(ty);constructor(t,r){this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(ey),...this.injector.get(Eb,[])]));this.chain=r.reduceRight((i,s)=>Ib(i,s,this.injector),vb)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Uo(r))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(te(gl),te(ct))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=te(aa),i},providedIn:"root"})}return n})();function pl(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer,referrerPolicy:n.referrerPolicy}}var wb=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof ss)s=t;else{let u;i.headers instanceof zn?u=i.headers:u=new zn(i.headers);let h;i.params&&(i.params instanceof dn?h=i.params:h=new dn({fromObject:i.params})),s=new ss(t,r,i.body!==void 0?i.body:null,{headers:u,context:i.context,params:h,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache,keepalive:i.keepalive,priority:i.priority,cache:i.cache,mode:i.mode,redirect:i.redirect,credentials:i.credentials,referrer:i.referrer,referrerPolicy:i.referrerPolicy,integrity:i.integrity,timeout:i.timeout})}let o=G(s).pipe(Xi(u=>this.handler.handle(u)));if(t instanceof ss||i.observe==="events")return o;let c=o.pipe(Ut(u=>u instanceof oa));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(ce(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new se(2806,!1);return u.body}));case"blob":return c.pipe(ce(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new se(2807,!1);return u.body}));case"text":return c.pipe(ce(u=>{if(u.body!==null&&typeof u.body!="string")throw new se(2808,!1);return u.body}));case"json":default:return c.pipe(ce(u=>u.body))}case"response":return c;default:throw new se(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new dn().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,pl(i,r))}post(t,r,i={}){return this.request("POST",t,pl(i,r))}put(t,r,i={}){return this.request("PUT",t,pl(i,r))}static \u0275fac=function(r){return new(r||n)(te(yl))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Tb=new ne("",{factory:()=>!0}),bb="XSRF-TOKEN",Ab=new ne("",{factory:()=>bb}),Sb="X-XSRF-TOKEN",Rb=new ne("",{providedIn:"root",factory:()=>Sb}),Cb=(()=>{class n{cookieName=x(Ab);doc=x(tt);lastCookieString="";lastToken=null;parseCount=0;getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Jo(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ny=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=te(Cb),i},providedIn:"root"})}return n})();function Pb(n,e){if(!x(Tb)||n.method==="GET"||n.method==="HEAD")return e(n);try{let i=x(xg).href,{origin:s}=new URL(i),{origin:o}=new URL(n.url,s);if(s!==o)return e(n)}catch{return e(n)}let t=x(ny).getToken(),r=x(Rb);return t!=null&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,t)})),e(n)}function kb(...n){let e=[wb,aa,{provide:yl,useExisting:aa},{provide:gl,useFactory:()=>x(yb,{optional:!0})??x(ml)},{provide:ey,useValue:Pb,multi:!0}];for(let t of n)e.push(...t.\u0275providers);return at(e)}var ry=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(te(tt))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var q="primary",vs=Symbol("RouteTitle"),wl=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Gn(n){return new wl(n)}function dy(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],c=n[s];if(o[0]===":")i[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function fa(n){return new Promise((e,t)=>{n.pipe(ln()).subscribe({next:r=>e(r),error:r=>t(r)})})}function Nb(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!vt(n[t],e[t]))return!1;return!0}function vt(n,e){let t=n?Tl(n):void 0,r=e?Tl(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!fy(n[i],e[i]))return!1;return!0}function Tl(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function fy(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function py(n){return n.length>0?n[n.length-1]:null}function Jn(n){return Qu(n)?n:bg(n)?xe(Promise.resolve(n)):G(n)}function my(n){return Qu(n)?fa(n):Promise.resolve(n)}var Ob={exact:yy,subset:_y},gy={exact:Mb,subset:Lb,ignored:()=>!0};function iy(n,e,t){return Ob[t.paths](n.root,e.root,t.matrixParams)&&gy[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Mb(n,e){return vt(n,e)}function yy(n,e,t){if(!Hn(n.segments,e.segments)||!la(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!yy(n.children[r],e.children[r],t))return!1;return!0}function Lb(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>fy(n[t],e[t]))}function _y(n,e,t){return vy(n,e,e.segments,t)}function vy(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Hn(i,t)||e.hasChildren()||!la(i,t,r))}else if(n.segments.length===t.length){if(!Hn(n.segments,t)||!la(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!_y(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Hn(n.segments,i)||!la(n.segments,i,r)||!n.children[q]?!1:vy(n.children[q],e,s,r)}}function la(n,e,t){return e.every((r,i)=>gy[t](n[i].parameters,r.parameters))}var ht=class{root;queryParams;fragment;_queryParamMap;constructor(e=new re([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Gn(this.queryParams),this._queryParamMap}toString(){return Ub.serialize(this)}},re=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ha(this)}},fn=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Gn(this.parameters),this._parameterMap}toString(){return Ey(this)}};function xb(n,e){return Hn(n,e)&&n.every((t,r)=>vt(t.parameters,e[r].parameters))}function Hn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Vb(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===q&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==q&&(t=t.concat(e(i,r)))}),t}var Is=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>new pn,providedIn:"root"})}return n})(),pn=class{parse(e){let t=new Al(e);return new ht(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${as(e.root,!0)}`,r=Bb(e.queryParams),i=typeof e.fragment=="string"?`#${Fb(e.fragment)}`:"";return`${t}${r}${i}`}},Ub=new pn;function ha(n){return n.segments.map(e=>Ey(e)).join("/")}function as(n,e){if(!n.hasChildren())return ha(n);if(e){let t=n.children[q]?as(n.children[q],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==q&&r.push(`${i}:${as(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Vb(n,(r,i)=>i===q?[as(n.children[q],!1)]:[`${i}:${as(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[q]!=null?`${ha(n)}/${t[0]}`:`${ha(n)}/(${t.join("//")})`}}function Iy(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ca(n){return Iy(n).replace(/%3B/gi,";")}function Fb(n){return encodeURI(n)}function bl(n){return Iy(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function da(n){return decodeURIComponent(n)}function sy(n){return da(n.replace(/\+/g,"%20"))}function Ey(n){return`${bl(n.path)}${jb(n.parameters)}`}function jb(n){return Object.entries(n).map(([e,t])=>`;${bl(e)}=${bl(t)}`).join("")}function Bb(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${ca(t)}=${ca(i)}`).join("&"):`${ca(t)}=${ca(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var $b=/^[^\/()?;#]+/;function _l(n){let e=n.match($b);return e?e[0]:""}var zb=/^[^\/()?;=#]+/;function qb(n){let e=n.match(zb);return e?e[0]:""}var Hb=/^[^=?&#]+/;function Wb(n){let e=n.match(Hb);return e?e[0]:""}var Gb=/^[^&#]+/;function Kb(n){let e=n.match(Gb);return e?e[0]:""}var Al=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new re([],{}):new re([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[q]=new re(e,t)),r}parseSegment(){let e=_l(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new se(4009,!1);return this.capture(e),new fn(da(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=qb(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=_l(this.remaining);i&&(r=i,this.capture(r))}e[da(t)]=da(r)}parseQueryParam(e){let t=Wb(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=Kb(this.remaining);o&&(r=o,this.capture(r))}let i=sy(t),s=sy(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=_l(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new se(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=q);let o=this.parseChildren();t[s??q]=Object.keys(o).length===1&&o[q]?o[q]:new re([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new se(4011,!1)}};function wy(n){return n.segments.length>0?new re([],{[q]:n}):n}function Ty(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Ty(i);if(r===q&&s.segments.length===0&&s.hasChildren())for(let[o,c]of Object.entries(s.children))e[o]=c;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new re(n.segments,e);return Jb(t)}function Jb(n){if(n.numberOfChildren===1&&n.children[q]){let e=n.children[q];return new re(n.segments.concat(e.segments),e.children)}return n}function mn(n){return n instanceof ht}function by(n,e,t=null,r=null,i=new pn){let s=Ay(n);return Sy(s,e,t,r,i)}function Ay(n){let e;function t(s){let o={};for(let u of s.children){let h=t(u);o[u.outlet]=h}let c=new re(s.url,o);return s===n&&(e=c),c}let r=t(n.root),i=wy(r);return e??i}function Sy(n,e,t,r,i){let s=n;for(;s.parent;)s=s.parent;if(e.length===0)return vl(s,s,s,t,r,i);let o=Qb(e);if(o.toRoot())return vl(s,s,new re([],{}),t,r,i);let c=Yb(o,s,n),u=c.processChildren?us(c.segmentGroup,c.index,o.commands):Cy(c.segmentGroup,c.index,o.commands);return vl(s,c.segmentGroup,u,t,r,i)}function pa(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function ds(n){return typeof n=="object"&&n!=null&&n.outlets}function oy(n,e,t){n||="\u0275";let r=new ht;return r.queryParams={[n]:e},t.parse(t.serialize(r)).queryParams[n]}function vl(n,e,t,r,i,s){let o={};for(let[h,f]of Object.entries(r??{}))o[h]=Array.isArray(f)?f.map(m=>oy(h,m,s)):oy(h,f,s);let c;n===e?c=t:c=Ry(n,e,t);let u=wy(Ty(c));return new ht(u,o,i)}function Ry(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Ry(s,e,t)}),new re(n.segments,r)}var ma=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&pa(r[0]))throw new se(4003,!1);let i=r.find(ds);if(i&&i!==py(r))throw new se(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Qb(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new ma(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([u,h])=>{c[u]=typeof h=="string"?h.split("/"):h}),[...i,{outlets:c}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((c,u)=>{u==0&&c==="."||(u==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,s]},[]);return new ma(t,e,r)}var Br=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function Yb(n,e,t){if(n.isAbsolute)return new Br(e,!0,0);if(!t)return new Br(e,!1,NaN);if(t.parent===null)return new Br(t,!0,0);let r=pa(n.commands[0])?0:1,i=t.segments.length-1+r;return Xb(t,i,n.numberOfDoubleDots)}function Xb(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new se(4005,!1);i=r.segments.length}return new Br(r,!1,i-s)}function Zb(n){return ds(n[0])?n[0].outlets:{[q]:n}}function Cy(n,e,t){if(n??=new re([],{}),n.segments.length===0&&n.hasChildren())return us(n,e,t);let r=eA(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new re(n.segments.slice(0,r.pathIndex),{});return s.children[q]=new re(n.segments.slice(r.pathIndex),n.children),us(s,0,i)}else return r.match&&i.length===0?new re(n.segments,{}):r.match&&!n.hasChildren()?Sl(n,e,t):r.match?us(n,0,i):Sl(n,e,t)}function us(n,e,t){if(t.length===0)return new re(n.segments,{});{let r=Zb(t),i={};if(Object.keys(r).some(s=>s!==q)&&n.children[q]&&n.numberOfChildren===1&&n.children[q].segments.length===0){let s=us(n.children[q],e,t);return new re(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Cy(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new re(n.segments,i)}}function eA(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],c=t[r];if(ds(c))break;let u=`${c}`,h=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&h&&typeof h=="object"&&h.outlets===void 0){if(!cy(u,h,o))return s;r+=2}else{if(!cy(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Sl(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(ds(s)){let u=tA(s.outlets);return new re(r,u)}if(i===0&&pa(t[0])){let u=n.segments[e];r.push(new fn(u.path,ay(t[0]))),i++;continue}let o=ds(s)?s.outlets[q]:`${s}`,c=i<t.length-1?t[i+1]:null;o&&c&&pa(c)?(r.push(new fn(o,ay(c))),i+=2):(r.push(new fn(o,{})),i++)}return new re(r,{})}function tA(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Sl(new re([],{}),0,r))}),e}function ay(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function cy(n,e,t){return n==t.path&&vt(e,t.parameters)}var ls="imperative",Se=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Se||{}),Je=class{id;url;constructor(e,t){this.id=e,this.url=t}},Kn=class extends Je{type=Se.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Et=class extends Je{urlAfterRedirects;type=Se.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ze=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(ze||{}),fs=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(fs||{}),It=class extends Je{reason;code;type=Se.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},jt=class extends Je{reason;code;type=Se.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},zr=class extends Je{error;target;type=Se.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},ps=class extends Je{urlAfterRedirects;state;type=Se.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ga=class extends Je{urlAfterRedirects;state;type=Se.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ya=class extends Je{urlAfterRedirects;state;shouldActivate;type=Se.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},_a=class extends Je{urlAfterRedirects;state;type=Se.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},va=class extends Je{urlAfterRedirects;state;type=Se.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ia=class{route;type=Se.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ea=class{route;type=Se.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},wa=class{snapshot;type=Se.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ta=class{snapshot;type=Se.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ba=class{snapshot;type=Se.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Aa=class{snapshot;type=Se.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var ms=class{},qr=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function nA(n){return!(n instanceof ms)&&!(n instanceof qr)}function rA(n,e){return n.providers&&!n._injector&&(n._injector=nl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function lt(n){return n.outlet||q}function iA(n,e){let t=n.filter(r=>lt(r)===e);return t.push(...n.filter(r=>lt(r)!==e)),t}function Gr(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Sa=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Gr(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Kr(this.rootInjector)}},Kr=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Sa(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(te(ct))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ra=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Rl(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Rl(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Cl(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Cl(e,this._root).map(t=>t.value)}};function Rl(n,e){if(n===e.value)return e;for(let t of e.children){let r=Rl(n,t);if(r)return r}return null}function Cl(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Cl(n,t);if(r.length)return r.unshift(e),r}return[]}var Ke=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function jr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var gs=class extends Ra{snapshot;constructor(e,t){super(e),this.snapshot=t,Ml(this,e)}toString(){return this.snapshot.toString()}};function Py(n){let e=sA(n),t=new et([new fn("",{})]),r=new et({}),i=new et({}),s=new et({}),o=new et(""),c=new Bt(t,r,s,o,i,q,n,e.root);return c.snapshot=e.root,new gs(new Ke(c,[]),e)}function sA(n){let e={},t={},r={},s=new Wn([],e,r,"",t,q,n,null,{});return new ys("",new Ke(s,[]))}var Bt=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,c,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=c,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(ce(h=>h[vs]))??G(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ce(e=>Gn(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ce(e=>Gn(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ca(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:M(M({},e.params),n.params),data:M(M({},e.data),n.data),resolve:M(M(M(M({},n.data),e.data),i?.data),n._resolvedData)}:r={params:M({},n.params),data:M({},n.data),resolve:M(M({},n.data),n._resolvedData??{})},i&&Dy(i)&&(r.resolve[vs]=i.title),r}var Wn=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[vs]}constructor(e,t,r,i,s,o,c,u,h){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=c,this.routeConfig=u,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Gn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Gn(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ys=class extends Ra{url;constructor(e,t){super(t),this.url=e,Ml(this,t)}toString(){return ky(this._root)}};function Ml(n,e){e.value._routerState=n,e.children.forEach(t=>Ml(n,t))}function ky(n){let e=n.children.length>0?` { ${n.children.map(ky).join(", ")} } `:"";return`${n.value}${e}`}function Il(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,vt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),vt(e.params,t.params)||n.paramsSubject.next(t.params),Nb(e.url,t.url)||n.urlSubject.next(t.url),vt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Pl(n,e){let t=vt(n.params,e.params)&&xb(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Pl(n.parent,e.parent))}function Dy(n){return typeof n.title=="string"||n.title===null}var Ny=new ne(""),Ll=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=q;activateEvents=new Mr;deactivateEvents=new Mr;attachEvents=new Mr;detachEvents=new Mr;routerOutletData=Ng();parentContexts=x(Kr);location=x(Ig);changeDetector=x(il);inputBinder=x(Na,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new se(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new se(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new se(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new se(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new kl(t,c,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Wo({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[$o]})}return n})(),kl=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Bt?this.route:e===Kr?this.childContexts:e===Ny?this.outletData:this.parent.get(e,t)}},Na=new ne("");var xl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=wg({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Cg(0,"router-outlet")},dependencies:[Ll],encapsulation:2})}return n})();function Vl(n){let e=n.children&&n.children.map(Vl),t=e?ve(M({},n),{children:e}):M({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==q&&(t.component=xl),t}function oA(n,e,t){let r=_s(n,e._root,t?t._root:void 0);return new gs(r,e)}function _s(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=aA(n,e,t);return new Ke(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>_s(n,c)),o}}let r=cA(e.value),i=e.children.map(s=>_s(n,s));return new Ke(r,i)}}function aA(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return _s(n,r,i);return _s(n,r)})}function cA(n){return new Bt(new et(n.url),new et(n.params),new et(n.queryParams),new et(n.fragment),new et(n.data),n.outlet,n.component,n)}var Hr=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Oy="ngNavigationCancelingError";function Pa(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=mn(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=My(!1,ze.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function My(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Oy]=!0,t.cancellationCode=e,t}function uA(n){return Ly(n)&&mn(n.url)}function Ly(n){return!!n&&n[Oy]}var lA=(n,e,t,r)=>ce(i=>(new Dl(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Dl=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Il(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=jr(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=jr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=jr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=jr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Aa(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Ta(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Il(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),Il(c.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},ka=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},$r=class{component;route;constructor(e,t){this.component=e,this.route=t}};function hA(n,e,t){let r=n._root,i=e?e._root:null;return cs(r,i,t,[r.value])}function dA(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Jr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!ug(n)?n:e.get(n):r}function cs(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=jr(e);return n.children.forEach(o=>{fA(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,c])=>hs(c,t.getContext(o),i)),i}function fA(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=pA(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new ka(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?cs(n,e,c?c.children:null,r,i):cs(n,e,t,r,i),u&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new $r(c.outlet.component,o))}else o&&hs(e,c,i),i.canActivateChecks.push(new ka(r)),s.component?cs(n,null,c?c.children:null,r,i):cs(n,null,t,r,i);return i}function pA(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Hn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Hn(n.url,e.url)||!vt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Pl(n,e)||!vt(n.queryParams,e.queryParams);case"paramsChange":default:return!Pl(n,e)}}function hs(n,e,t){let r=jr(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?hs(o,e.children.getContext(s),t):hs(o,null,t):hs(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new $r(e.outlet.component,i)):t.canDeactivateChecks.push(new $r(null,i)):t.canDeactivateChecks.push(new $r(null,i))}function Es(n){return typeof n=="function"}function mA(n){return typeof n=="boolean"}function gA(n){return n&&Es(n.canLoad)}function yA(n){return n&&Es(n.canActivate)}function _A(n){return n&&Es(n.canActivateChild)}function vA(n){return n&&Es(n.canDeactivate)}function IA(n){return n&&Es(n.canMatch)}function xy(n){return n instanceof rg||n?.name==="EmptyError"}var ua=Symbol("INITIAL_VALUE");function Wr(){return Be(n=>ig(n.map(e=>e.pipe(Or(1),og(ua)))).pipe(ce(e=>{for(let t of e)if(t!==!0){if(t===ua)return ua;if(t===!1||EA(t))return t}return!0}),Ut(e=>e!==ua),Or(1)))}function EA(n){return mn(n)||n instanceof Hr}function Vy(n){return n.aborted?G(void 0).pipe(Or(1)):new ot(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function Uy(n){return Fo(Vy(n))}function wA(n,e){return un(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?G(ve(M({},t),{guardsResult:!0})):TA(o,r,i,n).pipe(un(c=>c&&mA(c)?bA(r,s,n,e):G(c)),ce(c=>ve(M({},t),{guardsResult:c})))})}function TA(n,e,t,r){return xe(n).pipe(un(i=>PA(i.component,i.route,t,e,r)),ln(i=>i!==!0,!0))}function bA(n,e,t,r){return xe(e).pipe(Xi(i=>sg(SA(i.route.parent,r),AA(i.route,r),CA(n,i.path,t),RA(n,i.route,t))),ln(i=>i!==!0,!0))}function AA(n,e){return n!==null&&e&&e(new ba(n)),G(!0)}function SA(n,e){return n!==null&&e&&e(new wa(n)),G(!0)}function RA(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return G(!0);let i=r.map(s=>Vo(()=>{let o=Gr(e)??t,c=Jr(s,o),u=yA(c)?c.canActivate(e,n):De(o,()=>c(e,n));return Jn(u).pipe(ln())}));return G(i).pipe(Wr())}function CA(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>dA(o)).filter(o=>o!==null).map(o=>Vo(()=>{let c=o.guards.map(u=>{let h=Gr(o.node)??t,f=Jr(u,h),m=_A(f)?f.canActivateChild(r,n):De(h,()=>f(r,n));return Jn(m).pipe(ln())});return G(c).pipe(Wr())}));return G(s).pipe(Wr())}function PA(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return G(!0);let o=s.map(c=>{let u=Gr(e)??i,h=Jr(c,u),f=vA(h)?h.canDeactivate(n,e,t,r):De(u,()=>h(n,e,t,r));return Jn(f).pipe(ln())});return G(o).pipe(Wr())}function kA(n,e,t,r,i){let s=e.canLoad;if(s===void 0||s.length===0)return G(!0);let o=s.map(c=>{let u=Jr(c,n),h=gA(u)?u.canLoad(e,t):De(n,()=>u(e,t)),f=Jn(h);return i?f.pipe(Uy(i)):f});return G(o).pipe(Wr(),Fy(r))}function Fy(n){return eg(He(e=>{if(typeof e!="boolean")throw Pa(n,e)}),ce(e=>e===!0))}function DA(n,e,t,r,i){let s=e.canMatch;if(!s||s.length===0)return G(!0);let o=s.map(c=>{let u=Jr(c,n),h=IA(u)?u.canMatch(e,t):De(n,()=>u(e,t)),f=Jn(h);return i?f.pipe(Uy(i)):f});return G(o).pipe(Wr(),Fy(r))}var qn=class jy extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,jy.prototype)}},Nl=class By extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,By.prototype)}};function NA(n){throw new se(4e3,!1)}function OA(n){throw My(!1,ze.GuardRejected)}var MA=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return r;if(i.numberOfChildren>1||!i.children[q])throw NA(`${e.redirectTo}`);i=i.children[q]}}async applyRedirectCommands(e,t,r,i,s){let o=await LA(t,i,s);if(o instanceof ht)throw new Nl(o);let c=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),e,r);if(o[0]==="/")throw new Nl(c);return c}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new ht(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([c,u])=>{o[c]=this.createSegmentGroup(e,u,r,i)}),new re(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new se(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}};function LA(n,e,t){if(typeof n=="string")return Promise.resolve(n);let r=n,{queryParams:i,fragment:s,routeConfig:o,url:c,outlet:u,params:h,data:f,title:m}=e;return fa(Jn(De(t,()=>r({params:h,data:f,queryParams:i,fragment:s,routeConfig:o,url:c,outlet:u,title:m}))))}var Ol={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function xA(n,e,t,r,i,s){let o=$y(n,e,t);return o.matched?(r=rA(e,r),DA(r,e,t,i,s).pipe(ce(c=>c===!0?o:M({},Ol)))):G(o)}function $y(n,e,t){if(e.path==="**")return VA(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?M({},Ol):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||dy)(t,n,e);if(!i)return M({},Ol);let s={};Object.entries(i.posParams??{}).forEach(([c,u])=>{s[c]=u.path});let o=i.consumed.length>0?M(M({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function VA(n){return{matched:!0,parameters:n.length>0?py(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function uy(n,e,t,r){return t.length>0&&jA(n,t,r)?{segmentGroup:new re(e,FA(r,new re(t,n.children))),slicedSegments:[]}:t.length===0&&BA(n,t,r)?{segmentGroup:new re(n.segments,UA(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new re(n.segments,n.children),slicedSegments:t}}function UA(n,e,t,r){let i={};for(let s of t)if(Oa(n,e,s)&&!r[lt(s)]){let o=new re([],{});i[lt(s)]=o}return M(M({},r),i)}function FA(n,e){let t={};t[q]=e;for(let r of n)if(r.path===""&&lt(r)!==q){let i=new re([],{});t[lt(r)]=i}return t}function jA(n,e,t){return t.some(r=>Oa(n,e,r)&&lt(r)!==q)}function BA(n,e,t){return t.some(r=>Oa(n,e,r))}function Oa(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function $A(n,e,t){return e.length===0&&!n.children[t]}var zA=class{};async function qA(n,e,t,r,i,s,o="emptyOnly",c){return new WA(n,e,t,r,i,o,s,c).recognize()}var HA=31,WA=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,c,u){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c,this.abortSignal=u,this.applyRedirects=new MA(this.urlSerializer,this.urlTree)}noMatchError(e){return new se(4002,`'${e.segmentGroup}'`)}async recognize(){let e=uy(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:r}=await this.match(e),i=new Ke(r,t),s=new ys("",i),o=by(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}async match(e){let t=new Wn([],Object.freeze({}),Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),q,this.rootComponentType,null,{});try{return{children:await this.processSegmentGroup(this.injector,this.config,e,q,t),rootSnapshot:t}}catch(r){if(r instanceof Nl)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof qn?this.noMatchError(r):r}}async processSegmentGroup(e,t,r,i,s){if(r.segments.length===0&&r.hasChildren())return this.processChildren(e,t,r,s);let o=await this.processSegment(e,t,r,r.segments,i,!0,s);return o instanceof Ke?[o]:[]}async processChildren(e,t,r,i){let s=[];for(let u of Object.keys(r.children))u==="primary"?s.unshift(u):s.push(u);let o=[];for(let u of s){let h=r.children[u],f=iA(t,u),m=await this.processSegmentGroup(e,f,h,u,i);o.push(...m)}let c=zy(o);return GA(c),c}async processSegment(e,t,r,i,s,o,c){for(let u of t)try{return await this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,s,o,c)}catch(h){if(h instanceof qn||xy(h))continue;throw h}if($A(r,i,s))return new zA;throw new qn(r)}async processSegmentAgainstRoute(e,t,r,i,s,o,c,u){if(lt(r)!==o&&(o===q||!Oa(i,s,r)))throw new qn(i);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,i,r,s,o,u);if(this.allowRedirects&&c)return this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,u);throw new qn(i)}async expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,c){let{matched:u,parameters:h,consumedSegments:f,positionalParamSegments:m,remainingSegments:g}=$y(t,i,s);if(!u)throw new qn(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>HA&&(this.allowRedirects=!1));let A=new Wn(s,h,Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,ly(i),lt(i),i.component??i._loadedComponent??null,i,hy(i)),P=Ca(A,c,this.paramsInheritanceStrategy);if(A.params=Object.freeze(P.params),A.data=Object.freeze(P.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let D=await this.applyRedirects.applyRedirectCommands(f,i.redirectTo,m,A,e),R=await this.applyRedirects.lineralizeSegments(i,D);return this.processSegment(e,r,t,R.concat(g),o,!1,c)}async matchSegmentAgainstRoute(e,t,r,i,s,o){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let c=await fa(xA(t,r,i,e,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(t.children={}),!c?.matched)throw new qn(t);e=r._injector??e;let{routes:u}=await this.getChildConfig(e,r,i),h=r._loadedInjector??e,{parameters:f,consumedSegments:m,remainingSegments:g}=c,A=new Wn(m,f,Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,ly(r),lt(r),r.component??r._loadedComponent??null,r,hy(r)),P=Ca(A,o,this.paramsInheritanceStrategy);A.params=Object.freeze(P.params),A.data=Object.freeze(P.data);let{segmentGroup:D,slicedSegments:R}=uy(t,m,g,u);if(R.length===0&&D.hasChildren()){let B=await this.processChildren(h,u,D,A);return new Ke(A,B)}if(u.length===0&&R.length===0)return new Ke(A,[]);let O=lt(r)===s,U=await this.processSegment(h,u,D,R,O?q:s,!0,A);return new Ke(A,U instanceof Ke?[U]:[])}async getChildConfig(e,t,r){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0)return{routes:t._loadedRoutes,injector:t._loadedInjector};if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await fa(kA(e,t,r,this.urlSerializer,this.abortSignal))){let s=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=s.routes,t._loadedInjector=s.injector,s}throw OA(t)}return{routes:[],injector:e}}};function GA(n){n.sort((e,t)=>e.value.outlet===q?-1:t.value.outlet===q?1:e.value.outlet.localeCompare(t.value.outlet))}function KA(n){let e=n.value.routeConfig;return e&&e.path===""}function zy(n){let e=[],t=new Set;for(let r of n){if(!KA(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=zy(r.children);e.push(new Ke(r.value,i))}return e.filter(r=>!t.has(r))}function ly(n){return n.data||{}}function hy(n){return n.resolve||{}}var JA=new ne("",{factory:()=>qA});function QA(n,e,t,r,i,s,o){let c=n.get(JA);return un(u=>G(u).pipe(Be(h=>c(n,e,t,r,h.extractedUrl,i,s,o)),ce(({state:h,tree:f})=>ve(M({},u),{targetSnapshot:h,urlAfterRedirects:f}))))}function YA(n,e){return un(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return G(t);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let h of qy(u))o.add(h);let c=0;return xe(o).pipe(Xi(u=>s.has(u)?XA(u,r,n,e):(u.data=Ca(u,u.parent,n).resolve,G(void 0))),He(()=>c++),Yu(1),un(u=>c===o.size?G(t):Vt))})}function qy(n){let e=n.children.map(t=>qy(t)).flat();return[n,...e]}function XA(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Dy(i)&&(s[vs]=i.title),Vo(()=>(n.data=Ca(n,n.parent,t).resolve,ZA(s,n,e,r).pipe(ce(o=>(n._resolvedData=o,n.data=M(M({},n.data),o),null)))))}function ZA(n,e,t,r){let i=Tl(n);if(i.length===0)return G({});let s={};return xe(i).pipe(un(o=>eS(n[o],e,t,r).pipe(ln(),He(c=>{if(c instanceof Hr)throw Pa(new pn,c);s[o]=c}))),Yu(1),ce(()=>s),Nr(o=>xy(o)?Vt:Yi(o)))}function eS(n,e,t,r){let i=Gr(e)??r,s=Jr(n,i),o=s.resolve?s.resolve(e,t):De(i,()=>s(e,t));return Jn(o)}function El(n){return Be(e=>{let t=n(e);return t?xe(t).pipe(ce(()=>e)):G(e)})}var Ul=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===q);return r}getResolvedTitleForRoute(t){return t.data[vs]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>x(Hy),providedIn:"root"})}return n})(),Hy=(()=>{class n extends Ul{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(te(ry))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qn=new ne("",{factory:()=>({})}),ws=new ne(""),Wy=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=x(kg);async loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await my(De(t,()=>r.loadComponent())),o=await Jy(Ky(s));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o,o}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await Gy(r,this.compiler,t,this.onLoadEndListener);return r._loadedRoutes=s.routes,r._loadedInjector=s.injector,s}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,i),i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function Gy(n,e,t,r){let i=await my(De(t,()=>n.loadChildren())),s=await Jy(Ky(i)),o;s instanceof Eg||Array.isArray(s)?o=s:o=await e.compileModuleAsync(s),r&&r(n);let c,u,h=!1;return Array.isArray(o)?(u=o,h=!0):(c=o.create(t).injector,u=c.get(ws,[],{optional:!0,self:!0}).flat()),{routes:u.map(Vl),injector:c}}function tS(n){return n&&typeof n=="object"&&"default"in n}function Ky(n){return tS(n)?n.default:n}async function Jy(n){return n}var Ma=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>x(nS),providedIn:"root"})}return n})(),nS=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qy=new ne("");var rS=()=>{},Yy=new ne(""),Xy=(()=>{class n{currentNavigation=hn(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=hn(null);events=new Bn;transitionAbortWithErrorSubject=new Bn;configLoader=x(Wy);environmentInjector=x(ct);destroyRef=x(jo);urlSerializer=x(Is);rootContexts=x(Kr);location=x(Ko);inputBindingEnabled=x(Na,{optional:!0})!==null;titleStrategy=x(Ul);options=x(Qn,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=x(Ma);createViewTransition=x(Qy,{optional:!0});navigationErrorHandler=x(Yy,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>G(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Ia(i)),r=i=>this.events.next(new Ea(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;Ft(()=>{this.transitions?.next(ve(M({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(t){return this.transitions=new et(null),this.transitions.pipe(Ut(r=>r!==null),Be(r=>{let i=!1,s=new AbortController;return G(r).pipe(Be(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",ze.SupersededByNewNavigation),Vt;this.currentTransition=r;let c=this.lastSuccessfulNavigation();this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:c?ve(M({},c),{previousNavigation:null}):null,abort:()=>s.abort()});let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&h!=="reload")return this.events.next(new jt(o.id,this.urlSerializer.serialize(o.rawUrl),"",fs.IgnoredSameUrlNavigation)),o.resolve(!1),Vt;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return G(o).pipe(Be(f=>(this.events.next(new Kn(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),f.id!==this.navigationId?Vt:Promise.resolve(f))),QA(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,s.signal),He(f=>{r.targetSnapshot=f.targetSnapshot,r.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=f.urlAfterRedirects,g));let m=new ps(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(m)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:f,extractedUrl:m,source:g,restoredState:A,extras:P}=o,D=new Kn(f,this.urlSerializer.serialize(m),g,A);this.events.next(D);let R=Py(this.rootComponentType).snapshot;return this.currentTransition=r=ve(M({},o),{targetSnapshot:R,urlAfterRedirects:m,extras:ve(M({},P),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(O=>(O.finalUrl=m,O)),G(r)}else return this.events.next(new jt(o.id,this.urlSerializer.serialize(o.extractedUrl),"",fs.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Vt}),He(o=>{let c=new ga(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(c)}),ce(o=>(this.currentTransition=r=ve(M({},o),{guards:hA(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),wA(this.environmentInjector,o=>this.events.next(o)),He(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Pa(this.urlSerializer,o.guardsResult);let c=new ya(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(c)}),Ut(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",ze.GuardRejected),!1)),El(o=>{if(o.guards.canActivateChecks.length!==0)return G(o).pipe(He(c=>{let u=new _a(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),Be(c=>{let u=!1;return G(c).pipe(YA(this.paramsInheritanceStrategy,this.environmentInjector),He({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",ze.NoDataFromResolver)}}))}),He(c=>{let u=new va(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),El(o=>{let c=h=>{let f=[];if(h.routeConfig?._loadedComponent)h.component=h.routeConfig?._loadedComponent;else if(h.routeConfig?.loadComponent){let m=Gr(h)??this.environmentInjector;f.push(this.configLoader.loadComponent(m,h.routeConfig).then(g=>{h.component=g}))}for(let m of h.children)f.push(...c(m));return f},u=c(o.targetSnapshot.root);return u.length===0?G(o):xe(Promise.all(u).then(()=>o))}),El(()=>this.afterPreactivation()),Be(()=>{let{currentSnapshot:o,targetSnapshot:c}=r,u=this.createViewTransition?.(this.environmentInjector,o.root,c.root);return u?xe(u).pipe(ce(()=>r)):G(r)}),ce(o=>{let c=oA(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=ve(M({},o),{targetRouterState:c}),this.currentNavigation.update(u=>(u.targetRouterState=c,u)),r}),He(()=>{this.events.next(new ms)}),lA(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Or(1),Fo(Vy(s.signal).pipe(Ut(()=>!i&&!r.targetRouterState),He(()=>{this.cancelNavigationTransition(r,s.signal.reason+"",ze.Aborted)}))),He({next:o=>{i=!0,this.currentNavigation.update(c=>(c.abort=rS,c)),this.lastSuccessfulNavigation.set(Ft(this.currentNavigation)),this.events.next(new Et(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),Fo(this.transitionAbortWithErrorSubject.pipe(He(o=>{throw o}))),Uo(()=>{s.abort(),i||this.cancelNavigationTransition(r,"",ze.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Nr(o=>{if(this.destroyed)return r.resolve(!1),Vt;if(i=!0,Ly(o))this.events.next(new It(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),uA(o)?this.events.next(new qr(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let c=new zr(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let u=De(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(u instanceof Hr){let{message:h,cancellationCode:f}=Pa(this.urlSerializer,u);this.events.next(new It(r.id,this.urlSerializer.serialize(r.extractedUrl),h,f)),this.events.next(new qr(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(c),o}catch(u){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(u)}}return Vt}))}))}cancelNavigationTransition(t,r,i){let s=new It(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Ft(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function iS(n){return n!==ls}var Zy=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>x(sS),providedIn:"root"})}return n})(),Da=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},sS=(()=>{class n extends Da{static \u0275fac=(()=>{let t;return function(i){return(t||(t=zo(n)))(i||n)}})();static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Fl=(()=>{class n{urlSerializer=x(Is);options=x(Qn,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=x(Ko);urlHandlingStrategy=x(Ma);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new ht;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof ht?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=Py(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:()=>x(e_),providedIn:"root"})}return n})(),e_=(()=>{class n extends Fl{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof Kn?this.updateStateMemento():t instanceof jt?this.commitTransition(r):t instanceof ps?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof ms?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof It&&t.code!==ze.SupersededByNewNavigation&&t.code!==ze.Redirect?this.restoreHistory(r):t instanceof zr?this.restoreHistory(r,!0):t instanceof Et&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let c=this.browserPageId,u=M(M({},o),this.generateNgRouterState(i,c));this.location.replaceState(t,"",u)}else{let c=M(M({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",c)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=zo(n)))(i||n)}})();static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function jl(n,e){n.events.pipe(Ut(t=>t instanceof Et||t instanceof It||t instanceof zr||t instanceof jt),ce(t=>t instanceof Et||t instanceof jt?0:(t instanceof It?t.code===ze.Redirect||t.code===ze.SupersededByNewNavigation:!1)?2:1),Ut(t=>t!==2),Or(1)).subscribe(()=>{e()})}var oS={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},aS={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Yn=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=x(Tg);stateManager=x(Fl);options=x(Qn,{optional:!0})||{};pendingTasks=x(hg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=x(Xy);urlSerializer=x(Is);location=x(Ko);urlHandlingStrategy=x(Ma);injector=x(ct);_events=new Bn;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=x(Zy);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=x(ws,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!x(Na,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Zm;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=Ft(this.navigationTransitions.currentNavigation);if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof It&&r.code!==ze.Redirect&&r.code!==ze.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Et)this.navigated=!0;else if(r instanceof qr){let o=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u=M({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||iS(i.source)},o);this.scheduleNavigation(c,ls,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}nA(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ls,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let u=M({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(s.state=u)}let c=this.parseUrl(t);this.scheduleNavigation(c,r,o,s).catch(u=>{this.disposed||this.injector.get(Bo)(u)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Ft(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Vl),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=u?this.currentUrlTree.fragment:o,f=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":f=M(M({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}f!==null&&(f=this.removeEmptyProps(f));let m;try{let g=i?i.snapshot:this.routerState.snapshot.root;m=Ay(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return Sy(m,t,f,h??null,this.urlSerializer)}navigateByUrl(t,r={skipLocationChange:!1}){let i=mn(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,ls,null,r)}navigate(t,r={skipLocationChange:!1}){return cS(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Xu(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=M({},oS):r===!1?i=M({},aS):i=r,mn(t))return iy(this.currentUrlTree,t,i);let s=this.parseUrl(t);return iy(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((m,g)=>{c=m,u=g});let f=this.pendingTasks.add();return jl(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(m=>Promise.reject(m))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function cS(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new se(4008,!1)}var t_=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=hn(null);get href(){return Ft(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Bn;applicationErrorHandler=x(Bo);options=x(Qn,{optional:!0});constructor(t,r,i,s,o,c){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=c,this.reactiveHref.set(x(new Dg("href"),{optional:!0}));let u=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area"||!!(typeof customElements=="object"&&customElements.get(u)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,r=i=>i==="merge"||i==="preserve";t||=r(this.queryParamsHandling),t||=!this.queryParamsHandling&&!r(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(i=>{i instanceof Et&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(mn(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,s,o){let c=this.urlTree;if(c===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u)?.catch(h=>{this.applicationErrorHandler(h)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:mn(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(Vr(Yn),Vr(Bt),dg("tabindex"),Vr(vg),Vr(fg),Vr(Vg))};static \u0275dir=Wo({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){r&1&&Pg("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Rg("href",i.reactiveHref(),gg)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Go],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Go],replaceUrl:[2,"replaceUrl","replaceUrl",Go],routerLink:"routerLink"},features:[$o]})}return n})();var lS=new ne("");function hS(n,...e){return at([{provide:ws,multi:!0,useValue:n},[],{provide:Bt,useFactory:dS},{provide:Ag,multi:!0,useFactory:pS},e.map(t=>t.\u0275providers)])}function dS(){return x(Yn).routerState.root}function fS(n,e){return{\u0275kind:n,\u0275providers:e}}function pS(){let n=x(ut);return e=>{let t=n.get(Sg);if(e!==t.components[0])return;let r=n.get(Yn),i=n.get(mS);n.get(gS)===1&&r.initialNavigation(),n.get(yS,null,{optional:!0})?.setUpPreloading(),n.get(lS,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var mS=new ne("",{factory:()=>new Bn}),gS=new ne("",{factory:()=>1});var yS=new ne("");function _S(n){return fS(5,[{provide:Qn,useValue:n}])}var n_=()=>{};var s_=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},vS=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},La={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,f=s>>2,m=(s&3)<<4|c>>4,g=(c&15)<<2|h>>6,A=h&63;u||(A=64,o||(g=64)),r.push(t[f],t[m],t[g],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(s_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):vS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||m==null)throw new $l;let g=s<<2|c>>4;if(r.push(g),h!==64){let A=c<<4&240|h>>2;if(r.push(A),m!==64){let P=h<<6&192|m;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},$l=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},IS=function(n){let e=s_(n);return La.encodeByteArray(e,!0)},bs=function(n){return IS(n).replace(/\./g,"")},xa=function(n){try{return La.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ql(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var ES=()=>ql().__FIREBASE_DEFAULTS__,wS=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},TS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&xa(n[1]);return e&&JSON.parse(e)},Va=()=>{try{return n_()||ES()||wS()||TS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Hl=n=>{var e,t;return(t=(e=Va())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},o_=n=>{let e=Hl(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Wl=()=>{var n;return(n=Va())===null||n===void 0?void 0:n.config},Gl=n=>{var e;return(e=Va())===null||e===void 0?void 0:e[`_${n}`]};var Xn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function gn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ua(n){return(await fetch(n,{credentials:"include"})).ok}function a_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[bs(JSON.stringify(t)),bs(JSON.stringify(o)),""].join(".")}var Ts={};function bS(){let n={prod:[],emulator:[]};for(let e of Object.keys(Ts))Ts[e]?n.emulator.push(e):n.prod.push(e);return n}function AS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var r_=!1;function Fa(n,e){if(typeof window>"u"||typeof document>"u"||!gn(window.location.host)||Ts[n]===e||Ts[n]||r_)return;Ts[n]=e;function t(g){return`__firebase__banner__${g}`}let r="__firebase__banner",s=bS().prod.length>0;function o(){let g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,A){g.setAttribute("width","24"),g.setAttribute("id",A),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){let g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{r_=!0,o()},g}function f(g,A){g.setAttribute("id",A),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){let g=AS(r),A=t("text"),P=document.getElementById(A)||document.createElement("span"),D=t("learnmore"),R=document.getElementById(D)||document.createElement("a"),O=t("preprendIcon"),U=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){let B=g.element;c(B),f(R,D);let z=h();u(U,O),B.append(U,P,R,z),document.body.appendChild(B)}s?(P.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Re(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function c_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Re())}function SS(){var n;let e=(n=Va())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function u_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function l_(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function h_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function d_(){let n=Re();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function f_(){return!SS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function As(){try{return typeof indexedDB=="object"}catch{return!1}}function p_(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var RS="FirebaseError",Qe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=RS,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dt.prototype.create)}},dt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?CS(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Qe(i,c,r)}};function CS(n,e){return n.replace(PS,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var PS=/\{\$([^}]+)}/g;function m_(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function wt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(i_(s)&&i_(o)){if(!wt(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function i_(n){return n!==null&&typeof n=="object"}function Ss(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Qr(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Yr(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function g_(n,e){let t=new zl(n,e);return t.subscribe.bind(t)}var zl=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");kS(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Bl),i.error===void 0&&(i.error=Bl),i.complete===void 0&&(i.complete=Bl);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function kS(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Bl(){}var mL=14400*1e3;function ye(n){return n&&n._delegate?n._delegate:n}var qe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Zn="[DEFAULT]";var Kl=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Xn;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NS(e))try{this.getOrInitializeService({instanceIdentifier:Zn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Zn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zn){return this.instances.has(e)}getOptions(e=Zn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:DS(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Zn){return this.component?this.component.multipleInstances?e:Zn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function DS(n){return n===Zn?void 0:n}function NS(n){return n.instantiationMode==="EAGER"}var ja=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Kl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var OS=[],Q=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(Q||{}),MS={debug:Q.DEBUG,verbose:Q.VERBOSE,info:Q.INFO,warn:Q.WARN,error:Q.ERROR,silent:Q.SILENT},LS=Q.INFO,xS={[Q.DEBUG]:"log",[Q.VERBOSE]:"log",[Q.INFO]:"info",[Q.WARN]:"warn",[Q.ERROR]:"error"},VS=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=xS[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Tt=class{constructor(e){this.name=e,this._logLevel=LS,this._logHandler=VS,this._userLogHandler=null,OS.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Q.DEBUG,...e),this._logHandler(this,Q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Q.VERBOSE,...e),this._logHandler(this,Q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Q.INFO,...e),this._logHandler(this,Q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Q.WARN,...e),this._logHandler(this,Q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Q.ERROR,...e),this._logHandler(this,Q.ERROR,...e)}};var US=(n,e)=>e.some(t=>n instanceof t),y_,__;function FS(){return y_||(y_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jS(){return __||(__=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var v_=new WeakMap,Ql=new WeakMap,I_=new WeakMap,Jl=new WeakMap,Xl=new WeakMap;function BS(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(bt(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&v_.set(t,n)}).catch(()=>{}),Xl.set(e,n),e}function $S(n){if(Ql.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Ql.set(n,e)}var Yl={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ql.get(n);if(e==="objectStoreNames")return n.objectStoreNames||I_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function E_(n){Yl=n(Yl)}function zS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ba(this),e,...t);return I_.set(r,e.sort?e.sort():[e]),bt(r)}:jS().includes(n)?function(...e){return n.apply(Ba(this),e),bt(v_.get(this))}:function(...e){return bt(n.apply(Ba(this),e))}}function qS(n){return typeof n=="function"?zS(n):(n instanceof IDBTransaction&&$S(n),US(n,FS())?new Proxy(n,Yl):n)}function bt(n){if(n instanceof IDBRequest)return BS(n);if(Jl.has(n))return Jl.get(n);let e=qS(n);return e!==n&&(Jl.set(n,e),Xl.set(e,n)),e}var Ba=n=>Xl.get(n);function $a(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),c=bt(o);return r&&o.addEventListener("upgradeneeded",u=>{r(bt(o.result),u.oldVersion,u.newVersion,bt(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}var HS=["get","getKey","getAll","getAllKeys","count"],WS=["put","add","delete","clear"],Zl=new Map;function w_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Zl.get(e))return Zl.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=WS.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||HS.includes(t)))return;let s=async function(o,...c){let u=this.transaction(o,i?"readwrite":"readonly"),h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),i&&u.done]))[0]};return Zl.set(e,s),s}E_(n=>ve(M({},n),{get:(e,t,r)=>w_(e,t)||n.get(e,t,r),has:(e,t)=>!!w_(e,t)||n.has(e,t)}));var th=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(GS(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function GS(n){let e=n.getComponent();return e?.type==="VERSION"}var nh="@firebase/app",T_="0.13.2";var $t=new Tt("@firebase/app"),KS="@firebase/app-compat",JS="@firebase/analytics-compat",QS="@firebase/analytics",YS="@firebase/app-check-compat",XS="@firebase/app-check",ZS="@firebase/auth",eR="@firebase/auth-compat",tR="@firebase/database",nR="@firebase/data-connect",rR="@firebase/database-compat",iR="@firebase/functions",sR="@firebase/functions-compat",oR="@firebase/installations",aR="@firebase/installations-compat",cR="@firebase/messaging",uR="@firebase/messaging-compat",lR="@firebase/performance",hR="@firebase/performance-compat",dR="@firebase/remote-config",fR="@firebase/remote-config-compat",pR="@firebase/storage",mR="@firebase/storage-compat",gR="@firebase/firestore",yR="@firebase/ai",_R="@firebase/firestore-compat",vR="firebase",IR="11.10.0";var rh="[DEFAULT]",ER={[nh]:"fire-core",[KS]:"fire-core-compat",[QS]:"fire-analytics",[JS]:"fire-analytics-compat",[XS]:"fire-app-check",[YS]:"fire-app-check-compat",[ZS]:"fire-auth",[eR]:"fire-auth-compat",[tR]:"fire-rtdb",[nR]:"fire-data-connect",[rR]:"fire-rtdb-compat",[iR]:"fire-fn",[sR]:"fire-fn-compat",[oR]:"fire-iid",[aR]:"fire-iid-compat",[cR]:"fire-fcm",[uR]:"fire-fcm-compat",[lR]:"fire-perf",[hR]:"fire-perf-compat",[dR]:"fire-rc",[fR]:"fire-rc-compat",[pR]:"fire-gcs",[mR]:"fire-gcs-compat",[gR]:"fire-fst",[_R]:"fire-fst-compat",[yR]:"fire-vertex","fire-js":"fire-js",[vR]:"fire-js-all"};var Rs=new Map,wR=new Map,ih=new Map;function b_(n,e){try{n.container.addComponent(e)}catch(t){$t.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ft(n){let e=n.name;if(ih.has(e))return $t.debug(`There were multiple attempts to register component ${e}.`),!1;ih.set(e,n);for(let t of Rs.values())b_(t,n);for(let t of wR.values())b_(t,n);return!0}function Xr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function We(n){return n==null?!1:n.settings!==void 0}var TR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yn=new dt("app","Firebase",TR);var sh=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yn.create("app-deleted",{appName:this._name})}};var _n=IR;function ch(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:rh,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw yn.create("bad-app-name",{appName:String(i)});if(t||(t=Wl()),!t)throw yn.create("no-options");let s=Rs.get(i);if(s){if(wt(t,s.options)&&wt(r,s.config))return s;throw yn.create("duplicate-app",{appName:i})}let o=new ja(i);for(let u of ih.values())o.addComponent(u);let c=new sh(t,r,o);return Rs.set(i,c),c}function er(n=rh){let e=Rs.get(n);if(!e&&n===rh&&Wl())return ch();if(!e)throw yn.create("no-app",{appName:n});return e}function za(){return Array.from(Rs.values())}function pe(n,e,t){var r;let i=(r=ER[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$t.warn(c.join(" "));return}ft(new qe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var bR="firebase-heartbeat-database",AR=1,Cs="firebase-heartbeat-store",eh=null;function C_(){return eh||(eh=$a(bR,AR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Cs)}catch(t){console.warn(t)}}}}).catch(n=>{throw yn.create("idb-open",{originalErrorMessage:n.message})})),eh}async function SR(n){try{let t=(await C_()).transaction(Cs),r=await t.objectStore(Cs).get(P_(n));return await t.done,r}catch(e){if(e instanceof Qe)$t.warn(e.message);else{let t=yn.create("idb-get",{originalErrorMessage:e?.message});$t.warn(t.message)}}}async function A_(n,e){try{let r=(await C_()).transaction(Cs,"readwrite");await r.objectStore(Cs).put(e,P_(n)),await r.done}catch(t){if(t instanceof Qe)$t.warn(t.message);else{let r=yn.create("idb-set",{originalErrorMessage:t?.message});$t.warn(r.message)}}}function P_(n){return`${n.name}!${n.options.appId}`}var RR=1024,CR=30,oh=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new ah(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=S_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>CR){let o=kR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){$t.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=S_(),{heartbeatsToSend:r,unsentEntries:i}=PR(this._heartbeatsCache.heartbeats),s=bs(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return $t.warn(t),""}}};function S_(){return new Date().toISOString().substring(0,10)}function PR(n,e=RR){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),R_(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),R_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var ah=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return As()?p_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await SR(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return A_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return A_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function R_(n){return bs(JSON.stringify({version:2,heartbeats:n})).length}function kR(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function DR(n){ft(new qe("platform-logger",e=>new th(e),"PRIVATE")),ft(new qe("heartbeat",e=>new oh(e),"PRIVATE")),pe(nh,T_,n),pe(nh,T_,"esm2017"),pe("fire-js","")}DR("");var NR="firebase",OR="11.10.0";pe(NR,OR,"app");function k_(n){n===void 0&&(n=x(ut));let e=n.get(Lr);return t=>new ot(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let c=t.subscribe({next:u=>{r.next(u),o()},complete:()=>{r.complete(),o()},error:u=>{r.error(u),o()}});return c.add(()=>{r.unsubscribe(),o()}),c})}var vn=new ag("ANGULARFIRE2_VERSION");function Ps(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var ei=(n,e)=>{let t=e?[e]:za(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Zr=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(Zr||{}),D_=rl()&&typeof Zone<"u"?Zr.WARN:Zr.SILENT;var qa=class{zone;delegate;constructor(e,t=ng){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},In=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=x($e);this.outsideAngular=t.runOutsideAngular(()=>new qa(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new qa(typeof Zone>"u"?void 0:Zone.current,tg))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),N_=!1;function MR(n,e){!N_&&(D_>Zr.SILENT||rl())&&(N_=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),D_>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function LR(n){let e=x($e,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function tr(n){let e=x($e,{optional:!0});return e?e.run(()=>n()):n()}var xR=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),De(t,()=>tr(()=>n.apply(void 0,r)))),_e=(n,e,t)=>(t||=e?Zr.WARN:Zr.VERBOSE,function(){let r,i=arguments,s,o,c;try{s=x(In),o=x(Lr),c=x(ct)}catch{return MR(n,t),n.apply(this,i)}for(let h=0;h<arguments.length;h++)typeof i[h]=="function"&&(e&&(r||=tr(()=>o.add())),i[h]=xR(i[h],r,c));let u=LR(()=>n.apply(this,i));return e?u instanceof ot?u.pipe(Ju(s.outsideAngular),Ku(s.insideAngular),k_(c)):u instanceof Promise?tr(()=>{let h=o.add();return new Promise((f,m)=>{u.then(g=>De(c,()=>tr(()=>f(g))),g=>De(c,()=>tr(()=>m(g)))).finally(h)})}):typeof u=="function"&&r?function(){return setTimeout(r,0),u.apply(this,arguments)}:tr(()=>u):u instanceof ot?u.pipe(Ju(s.outsideAngular),Ku(s.insideAngular)):tr(()=>u)});var zt=class{constructor(e){return e}},nr=class{constructor(){return za()}};function VR(n){return n&&n.length===1?n[0]:new zt(er())}var uh=new ne("angularfire2._apps"),UR={provide:zt,useFactory:VR,deps:[[new nt,uh]]},FR={provide:nr,deps:[[new nt,uh]]};function jR(n){return(e,t)=>{let r=t.get(xr);pe("angularfire",vn.full,"core"),pe("angularfire",vn.full,"app"),pe("angular",cg.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new zt(i)}}function cx(n,...e){return at([UR,FR,{provide:uh,useFactory:jR(n),multi:!0,deps:[$e,ut,In,...e]}])}var ux=_e(ch,!0);var BR=new Map,$R={activated:!1,tokenObservers:[]},zR={initialized:!1,enabled:!1};function pt(n){return BR.get(n)||Object.assign({},$R)}function x_(){return zR}var qR="https://content-firebaseappcheck.googleapis.com/v1";var HR="exchangeDebugToken",O_={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},_x=1440*60*1e3;var dh=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Xn,this.pending.promise.catch(t=>{}),await WR(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Xn,this.pending.promise.catch(t=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function WR(n){return new Promise(e=>{setTimeout(e,n)})}var GR={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},En=new dt("appCheck","AppCheck",GR);function V_(n){if(!pt(n).activated)throw En.create("use-before-activation",{appName:n.name})}async function U_({url:n,body:e},t){let r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){let m=await i.getHeartbeatsHeader();m&&(r["X-Firebase-Client"]=m)}let s={method:"POST",body:JSON.stringify(e),headers:r},o;try{o=await fetch(n,s)}catch(m){throw En.create("fetch-network-error",{originalErrorMessage:m?.message})}if(o.status!==200)throw En.create("fetch-status-error",{httpStatus:o.status});let c;try{c=await o.json()}catch(m){throw En.create("fetch-parse-error",{originalErrorMessage:m?.message})}let u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw En.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let h=Number(u[1])*1e3,f=Date.now();return{token:c.token,expireTimeMillis:f+h,issuedAtTimeMillis:f}}function F_(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${qR}/projects/${t}/apps/${r}:${HR}?key=${i}`,body:{debug_token:e}}}var KR="firebase-app-check-database",JR=1,fh="firebase-app-check-store";var Ha=null;function QR(){return Ha||(Ha=new Promise((n,e)=>{try{let t=indexedDB.open(KR,JR);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(En.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(fh,{keyPath:"compositeKey"})}}}catch(t){e(En.create("storage-open",{originalErrorMessage:t?.message}))}}),Ha)}function YR(n,e){return XR(ZR(n),e)}async function XR(n,e){let r=(await QR()).transaction(fh,"readwrite"),s=r.objectStore(fh).put({compositeKey:n,value:e});return new Promise((o,c)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var h;c(En.create("storage-set",{originalErrorMessage:(h=u.target.error)===null||h===void 0?void 0:h.message}))}})}function ZR(n){return`${n.options.appId}-${n.name}`}var ks=new Tt("@firebase/app-check");function lh(n,e){return As()?YR(n,e).catch(t=>{ks.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function j_(){return x_().enabled}async function B_(){let n=x_();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}var eC={error:"UNKNOWN_ERROR"};function tC(n){return La.encodeString(JSON.stringify(n),!1)}async function ph(n,e=!1,t=!1){let r=n.app;V_(r);let i=pt(r),s=i.token,o;if(s&&!Ds(s)&&(i.token=void 0,s=void 0),!s){let h=await i.cachedTokenPromise;h&&(Ds(h)?s=h:await lh(r,void 0))}if(!e&&s&&Ds(s))return{token:s.token};let c=!1;if(j_())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=U_(F_(r,await B_()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),c=!0);let h=await i.exchangeTokenPromise;return await lh(r,h),i.token=h,{token:h.token}}catch(h){return h.code==="appCheck/throttled"||h.code==="appCheck/initial-throttle"?ks.warn(h.message):t&&ks.error(h),hh(h)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),c=!0),s=await pt(r).exchangeTokenPromise}catch(h){h.code==="appCheck/throttled"||h.code==="appCheck/initial-throttle"?ks.warn(h.message):t&&ks.error(h),o=h}let u;return s?o?Ds(s)?u={token:s.token,internalError:o}:u=hh(o):(u={token:s.token},i.token=s,await lh(r,s)):u=hh(o),c&&sC(r,u),u}async function nC(n){let e=n.app;V_(e);let{provider:t}=pt(e);if(j_()){let r=await B_(),{token:i}=await U_(F_(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=await t.getToken();return{token:r}}}function rC(n,e,t,r){let{app:i}=n,s=pt(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ds(s.token)){let c=s.token;Promise.resolve().then(()=>{t({token:c.token}),M_(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>M_(n))}function $_(n,e){let t=pt(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function M_(n){let{app:e}=n,t=pt(e),r=t.tokenRefresher;r||(r=iC(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function iC(n){let{app:e}=n;return new dh(async()=>{let t=pt(e),r;if(t.token?r=await ph(n,!0):r=await ph(n),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{let t=pt(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},O_.RETRIAL_MIN_WAIT,O_.RETRIAL_MAX_WAIT)}function sC(n,e){let t=pt(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ds(n){return n.expireTimeMillis-Date.now()>0}function hh(n){return{token:tC(eC),error:n}}var mh=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=pt(this.app);for(let t of e)$_(this.app,t.next);return Promise.resolve()}};function oC(n,e){return new mh(n,e)}function aC(n){return{getToken:e=>ph(n,e),getLimitedUseToken:()=>nC(n),addTokenListener:e=>rC(n,"INTERNAL",e),removeTokenListener:e=>$_(n.app,e)}}var cC="@firebase/app-check",uC="0.10.1";var lC="app-check",L_="app-check-internal";function hC(){ft(new qe(lC,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return oC(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(L_).initialize()})),ft(new qe(L_,n=>{let e=n.getProvider("app-check").getImmediate();return aC(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),pe(cC,uC)}hC();var dC="app-check";var ti=class{constructor(){return ei(dC)}};var fC=["localhost","0.0.0.0","127.0.0.1"],kx=typeof window<"u"&&fC.includes(window.location.hostname);var z_=()=>{};var q_=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},pC=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},H_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,f=s>>2,m=(s&3)<<4|c>>4,g=(c&15)<<2|h>>6,A=h&63;u||(A=64,o||(g=64)),r.push(t[f],t[m],t[g],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(q_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||m==null)throw new yh;let g=s<<2|c>>4;if(r.push(g),h!==64){let A=c<<4&240|h>>2;if(r.push(A),m!==64){let P=h<<6&192|m;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},yh=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},mC=function(n){let e=q_(n);return H_.encodeByteArray(e,!0)},vh=function(n){return mC(n).replace(/\./g,"")},Wa=function(n){try{return H_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var yC=()=>gC().__FIREBASE_DEFAULTS__,_C=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},vC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Wa(n[1]);return e&&JSON.parse(e)},IC=()=>{try{return z_()||yC()||_C()||vC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var W_=n=>IC()?.[`_${n}`];function Ih(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function mt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function G_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mt())}function K_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function J_(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Q_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Y_(){try{return typeof indexedDB=="object"}catch{return!1}}function X_(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var EC="FirebaseError",At=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=EC,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qt.prototype.create)}},qt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?wC(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new At(i,c,r)}};function wC(n,e){return n.replace(TC,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var TC=/\{\$([^}]+)}/g;function Eh(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Z_(n,e){let t=new _h(n,e);return t.subscribe.bind(t)}var _h=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");bC(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=gh),i.error===void 0&&(i.error=gh),i.complete===void 0&&(i.complete=gh);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function bC(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function gh(){}var Lx=14400*1e3;function ni(n){return n&&n._delegate?n._delegate:n}var Ht=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var AC=[],ue=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(ue||{}),SC={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},RC=ue.INFO,CC={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},PC=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=CC[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ri=class{constructor(e){this.name=e,this._logLevel=RC,this._logHandler=PC,this._userLogHandler=null,AC.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?SC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}};var Th=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(DC(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function DC(n){return n.getComponent()?.type==="VERSION"}var bh="@firebase/app",ev="0.14.6";var Wt=new ri("@firebase/app"),NC="@firebase/app-compat",OC="@firebase/analytics-compat",MC="@firebase/analytics",LC="@firebase/app-check-compat",xC="@firebase/app-check",VC="@firebase/auth",UC="@firebase/auth-compat",FC="@firebase/database",jC="@firebase/data-connect",BC="@firebase/database-compat",$C="@firebase/functions",zC="@firebase/functions-compat",qC="@firebase/installations",HC="@firebase/installations-compat",WC="@firebase/messaging",GC="@firebase/messaging-compat",KC="@firebase/performance",JC="@firebase/performance-compat",QC="@firebase/remote-config",YC="@firebase/remote-config-compat",XC="@firebase/storage",ZC="@firebase/storage-compat",eP="@firebase/firestore",tP="@firebase/ai",nP="@firebase/firestore-compat",rP="firebase",iP="12.6.0";var sP={[bh]:"fire-core",[NC]:"fire-core-compat",[MC]:"fire-analytics",[OC]:"fire-analytics-compat",[xC]:"fire-app-check",[LC]:"fire-app-check-compat",[VC]:"fire-auth",[UC]:"fire-auth-compat",[FC]:"fire-rtdb",[jC]:"fire-data-connect",[BC]:"fire-rtdb-compat",[$C]:"fire-fn",[zC]:"fire-fn-compat",[qC]:"fire-iid",[HC]:"fire-iid-compat",[WC]:"fire-fcm",[GC]:"fire-fcm-compat",[KC]:"fire-perf",[JC]:"fire-perf-compat",[QC]:"fire-rc",[YC]:"fire-rc-compat",[XC]:"fire-gcs",[ZC]:"fire-gcs-compat",[eP]:"fire-fst",[nP]:"fire-fst-compat",[tP]:"fire-vertex","fire-js":"fire-js",[rP]:"fire-js-all"};var oP=new Map,aP=new Map,tv=new Map;function nv(n,e){try{n.container.addComponent(e)}catch(t){Wt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function si(n){let e=n.name;if(tv.has(e))return Wt.debug(`There were multiple attempts to register component ${e}.`),!1;tv.set(e,n);for(let t of oP.values())nv(t,n);for(let t of aP.values())nv(t,n);return!0}function rr(n){return n==null?!1:n.settings!==void 0}var cP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rh=new qt("app","Firebase",cP);var Ga=iP;function ii(n,e,t){let r=sP[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wt.warn(o.join(" "));return}si(new Ht(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var uP="firebase-heartbeat-database",lP=1,Ns="firebase-heartbeat-store",wh=null;function ov(){return wh||(wh=$a(uP,lP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ns)}catch(t){console.warn(t)}}}}).catch(n=>{throw Rh.create("idb-open",{originalErrorMessage:n.message})})),wh}async function hP(n){try{let t=(await ov()).transaction(Ns),r=await t.objectStore(Ns).get(av(n));return await t.done,r}catch(e){if(e instanceof At)Wt.warn(e.message);else{let t=Rh.create("idb-get",{originalErrorMessage:e?.message});Wt.warn(t.message)}}}async function rv(n,e){try{let r=(await ov()).transaction(Ns,"readwrite");await r.objectStore(Ns).put(e,av(n)),await r.done}catch(t){if(t instanceof At)Wt.warn(t.message);else{let r=Rh.create("idb-set",{originalErrorMessage:t?.message});Wt.warn(r.message)}}}function av(n){return`${n.name}!${n.options.appId}`}var dP=1024,fP=30,Ah=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Sh(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=iv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>fP){let i=mP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Wt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=iv(),{heartbeatsToSend:t,unsentEntries:r}=pP(this._heartbeatsCache.heartbeats),i=vh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Wt.warn(e),""}}};function iv(){return new Date().toISOString().substring(0,10)}function pP(n,e=dP){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),sv(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),sv(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Sh=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Y_()?X_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await hP(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return rv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return rv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function sv(n){return vh(JSON.stringify({version:2,heartbeats:n})).length}function mP(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function gP(n){si(new Ht("platform-logger",e=>new Th(e),"PRIVATE")),si(new Ht("heartbeat",e=>new Ah(e),"PRIVATE")),ii(bh,ev,n),ii(bh,ev,"esm2020"),ii("fire-js","")}gP("");function mv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var gv=mv,yv=new qt("auth","Firebase",mv());var Ya=new ri("@firebase/auth");function yP(n,...e){Ya.logLevel<=ue.WARN&&Ya.warn(`Auth (${Ga}): ${n}`,...e)}function Ja(n,...e){Ya.logLevel<=ue.ERROR&&Ya.error(`Auth (${Ga}): ${n}`,...e)}function cv(n,...e){throw Fh(n,...e)}function Uh(n,...e){return Fh(n,...e)}function _v(n,e,t){let r=ve(M({},gv()),{[e]:t});return new qt("auth","Firebase",r).create(e,{appName:n.name})}function Qa(n){return _v(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fh(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return yv.create(n,...e)}function ie(n,e,...t){if(!n)throw Fh(e,...t)}function Os(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ja(e),new Error(e)}function Xa(n,e){n||Os(e)}function _P(){return uv()==="http:"||uv()==="https:"}function uv(){return typeof self<"u"&&self.location?.protocol||null}function vP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_P()||J_()||"connection"in navigator)?navigator.onLine:!0}function IP(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var or=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xa(t>e,"Short delay should be less than long delay!"),this.isMobile=G_()||Q_()}get(){return vP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function EP(n,e){Xa(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Za=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Os("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Os("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Os("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var wP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var TP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bP=new or(3e4,6e4);function vv(n,e){return n.tenantId&&!e.tenantId?ve(M({},e),{tenantId:n.tenantId}):e}async function ic(n,e,t,r,i={}){return Iv(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let c=Eh(M({key:n.config.apiKey},o)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);let h=M({method:e,headers:u},s);return K_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ih(n.emulatorConfig.host)&&(h.credentials="include"),Za.fetch()(await Ev(n,n.config.apiHost,t,c),h)})}async function Iv(n,e,t){n._canInitEmulator=!1;let r=M(M({},wP),e);try{let i=new kh(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw Ka(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ka(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ka(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ka(n,"user-disabled",o);let f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw _v(n,f,h);cv(n,f)}}catch(i){if(i instanceof At)throw i;cv(n,"network-request-failed",{message:String(i)})}}async function Ev(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?EP(n.config,i):`${n.config.apiScheme}://${i}`;return TP.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}var kh=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Uh(this.auth,"network-request-failed")),bP.get())})}};function Ka(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Uh(n,e,r);return i.customData._tokenResponse=t,i}async function AP(n,e){return ic(n,"POST","/v1/accounts:delete",e)}async function ec(n,e){return ic(n,"POST","/v1/accounts:lookup",e)}function Ms(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function wv(n,e=!1){let t=ni(n),r=await t.getIdToken(e),i=Tv(r);ie(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Ms(Ch(i.auth_time)),issuedAtTime:Ms(Ch(i.iat)),expirationTime:Ms(Ch(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Ch(n){return Number(n)*1e3}function Tv(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ja("JWT malformed, contained fewer than 3 sections"),null;try{let i=Wa(t);return i?JSON.parse(i):(Ja("Failed to decode base64 JWT payload"),null)}catch(i){return Ja("Caught error parsing JWT payload as JSON",i?.toString()),null}}function lv(n){let e=Tv(n);return ie(e,"internal-error"),ie(typeof e.exp<"u","internal-error"),ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Dh(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof At&&SP(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function SP({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Nh=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var xs=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ms(this.lastLoginAt),this.creationTime=Ms(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function tc(n){let e=n.auth,t=await n.getIdToken(),r=await Dh(n,ec(e,{idToken:t}));ie(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let s=i.providerUserInfo?.length?Av(i.providerUserInfo):[],o=RP(n.providerData,s),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new xs(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function bv(n){let e=ni(n);await tc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function RP(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Av(n){return n.map(r=>{var i=r,{providerId:e}=i,t=xo(i,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function CP(n,e){let t=await Iv(n,{},async()=>{let r=Eh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await Ev(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Ih(n.emulatorConfig.host)&&(u.credentials="include"),Za.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function PP(n,e){return ic(n,"POST","/v2/accounts:revokeToken",vv(n,e))}var Ls=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ie(e.idToken,"internal-error"),ie(typeof e.idToken<"u","internal-error"),ie(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):lv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ie(e.length!==0,"internal-error");let t=lv(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await CP(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(ie(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ie(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ie(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Os("not implemented")}};function wn(n,e){ie(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ir=class n{constructor(s){var o=s,{uid:e,auth:t,stsTokenManager:r}=o,i=xo(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Nh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new xs(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await Dh(this,this.stsTokenManager.getToken(this.auth,e));return ie(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return wv(this,e)}reload(){return bv(this)}_assign(e){this!==e&&(ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>M({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(ve(M({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await tc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rr(this.auth.app))return Promise.reject(Qa(this.auth));let e=await this.getIdToken();return await Dh(this,AP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return ve(M({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>M({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:A,providerData:P,stsTokenManager:D}=t;ie(m&&D,e,"internal-error");let R=Ls.fromJSON(this.name,D);ie(typeof m=="string",e,"internal-error"),wn(r,e.name),wn(i,e.name),ie(typeof g=="boolean",e,"internal-error"),ie(typeof A=="boolean",e,"internal-error"),wn(s,e.name),wn(o,e.name),wn(c,e.name),wn(u,e.name),wn(h,e.name),wn(f,e.name);let O=new n({uid:m,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:A,photoURL:o,phoneNumber:s,tenantId:c,stsTokenManager:R,createdAt:h,lastLoginAt:f});return P&&Array.isArray(P)&&(O.providerData=P.map(U=>M({},U))),u&&(O._redirectEventId=u),O}static async _fromIdTokenResponse(e,t,r=!1){let i=new Ls;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await tc(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];ie(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Av(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new Ls;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new xs(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u}};var hv=new Map;function sr(n){Xa(n instanceof Function,"Expected a class definition");let e=hv.get(n);return e?(Xa(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,hv.set(n,e),e)}var kP=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Oh=kP;function Ph(n,e,t){return`firebase:${n}:${e}:${t}`}var nc=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Ph(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ph("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await ec(this.auth,{idToken:e}).catch(()=>{});return t?ir._fromGetAccountInfoResponse(this.auth,t,e):null}return ir._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(sr(Oh),e,r);let i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h),s=i[0]||sr(Oh),o=Ph(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let f=await h._get(o);if(f){let m;if(typeof f=="string"){let g=await ec(e,{idToken:f}).catch(()=>{});if(!g)break;m=await ir._fromGetAccountInfoResponse(e,g,f)}else m=ir._fromJSON(e,f);h!==s&&(c=m),s=h;break}}catch{}let u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&await s._set(o,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new n(s,e,r))}};function dv(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(MP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(DP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xP(e))return"Blackberry";if(VP(e))return"Webos";if(NP(e))return"Safari";if((e.includes("chrome/")||OP(e))&&!e.includes("edge/"))return"Chrome";if(LP(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function DP(n=mt()){return/firefox\//i.test(n)}function NP(n=mt()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function OP(n=mt()){return/crios\//i.test(n)}function MP(n=mt()){return/iemobile/i.test(n)}function LP(n=mt()){return/android/i.test(n)}function xP(n=mt()){return/blackberry/i.test(n)}function VP(n=mt()){return/webos/i.test(n)}function Sv(n,e=[]){let t;switch(n){case"Browser":t=dv(mt());break;case"Worker":t=`${dv(mt())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ga}/${r}`}var Mh=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let u=e(s);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function UP(n,e={}){return ic(n,"GET","/v2/passwordPolicy",vv(n,e))}var FP=6,Lh=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??FP,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var xh=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rc(this),this.idTokenSubscription=new rc(this),this.beforeStateQueue=new Mh(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=sr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await nc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await ec(this,{idToken:e}),r=await ir._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(rr(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!s||s===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tc(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rr(this.app))return Promise.reject(Qa(this));let t=e?ni(e):null;return t&&ie(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rr(this.app)?Promise.reject(Qa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rr(this.app)?Promise.reject(Qa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(sr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await UP(this),t=new Lh(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await PP(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&sr(e)||this._popupRedirectResolver;ie(t,this,"argument-error"),this.redirectPersistenceManager=await nc.create(this,[sr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ie(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Sv(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(rr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&yP(`Error while retrieving App Check token: ${e.error}`),e?.token}};function jP(n){return ni(n)}var rc=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Z_(t=>this.observer=t)}get next(){return ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var BP={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $P(n){BP=n}function zP(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function qP(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(sr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function jh(n,e,t,r){return ni(n).onIdTokenChanged(e,t,r)}var pV=zP("rcb"),mV=new or(3e4,6e4);var gV=new or(2e3,1e4);var yV=600*1e3;var _V=new or(3e4,6e4);var vV=new or(5e3,15e3);var IV=encodeURIComponent("fac");var fv="@firebase/auth",pv="1.12.0";var Vh=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function HP(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WP(n){si(new Ht("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;ie(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Sv(n)},h=new xh(r,i,s,u);return qP(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),si(new Ht("auth-internal",e=>{let t=jP(e.getProvider("auth").getImmediate());return(r=>new Vh(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ii(fv,pv,HP(n)),ii(fv,pv,"esm2020")}var GP=300,EV=W_("authIdTokenMaxAge")||GP;function KP(){return document.getElementsByTagName("head")?.[0]??document}$P({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Uh("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",KP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WP("Browser");function Rv(n){return new ot(function(e){var t=jh(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}function zv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var qv=zv,Hv=new dt("auth","Firebase",zv());var lc=new Tt("@firebase/auth");function YP(n,...e){lc.logLevel<=Q.WARN&&lc.warn(`Auth (${_n}): ${n}`,...e)}function oc(n,...e){lc.logLevel<=Q.ERROR&&lc.error(`Auth (${_n}): ${n}`,...e)}function Rt(n,...e){throw hd(n,...e)}function ar(n,...e){return hd(n,...e)}function Wv(n,e,t){let r=Object.assign(Object.assign({},qv()),{[e]:t});return new dt("auth","Firebase",r).create(e,{appName:n.name})}function Jt(n){return Wv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hd(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Hv.create(n,...e)}function $(n,e,...t){if(!n)throw hd(e,...t)}function Gt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw oc(e),new Error(e)}function An(n,e){n||Gt(e)}function qh(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function XP(){return Cv()==="http:"||Cv()==="https:"}function Cv(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function ZP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XP()||l_()||"connection"in navigator)?navigator.onLine:!0}function e0(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var cr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,An(t>e,"Short delay should be less than long delay!"),this.isMobile=c_()||h_()}get(){return ZP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function dd(n,e){An(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var hc=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var t0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var n0=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],r0=new cr(3e4,6e4);function Sn(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Rn(n,e,t,r,i={}){return Gv(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let c=Ss(Object.assign({key:n.config.apiKey},o)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);let h=Object.assign({method:e,headers:u},s);return u_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&gn(n.emulatorConfig.host)&&(h.credentials="include"),hc.fetch()(await Kv(n,n.config.apiHost,t,c),h)})}async function Gv(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},t0),e);try{let i=new Hh(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw sc(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw sc(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw sc(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw sc(n,"user-disabled",o);let f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Wv(n,f,h);Rt(n,f)}}catch(i){if(i instanceof Qe)throw i;Rt(n,"network-request-failed",{message:String(i)})}}async function Hs(n,e,t,r,i={}){let s=await Rn(n,e,t,r,i);return"mfaPendingCredential"in s&&Rt(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Kv(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?dd(n.config,i):`${n.config.apiScheme}://${i}`;return n0.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function i0(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Hh=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ar(this.auth,"network-request-failed")),r0.get())})}};function sc(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=ar(n,e,r);return i.customData._tokenResponse=t,i}function Pv(n){return n!==void 0&&n.enterprise!==void 0}var Wh=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return i0(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function s0(n,e){return Rn(n,"GET","/v2/recaptchaConfig",Sn(n,e))}async function o0(n,e){return Rn(n,"POST","/v1/accounts:delete",e)}async function dc(n,e){return Rn(n,"POST","/v1/accounts:lookup",e)}function Us(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fd(n,e=!1){let t=ye(n),r=await t.getIdToken(e),i=pd(r);$(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Us(Bh(i.auth_time)),issuedAtTime:Us(Bh(i.iat)),expirationTime:Us(Bh(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Bh(n){return Number(n)*1e3}function pd(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return oc("JWT malformed, contained fewer than 3 sections"),null;try{let i=xa(t);return i?JSON.parse(i):(oc("Failed to decode base64 JWT payload"),null)}catch(i){return oc("Caught error parsing JWT payload as JSON",i?.toString()),null}}function kv(n){let e=pd(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function js(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Qe&&a0(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function a0({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Gh=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Bs=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Us(this.lastLoginAt),this.creationTime=Us(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function fc(n){var e;let t=n.auth,r=await n.getIdToken(),i=await js(n,dc(t,{idToken:r}));$(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Jv(s.providerUserInfo):[],c=c0(n.providerData,o),u=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!c?.length,f=u?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Bs(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,m)}async function md(n){let e=ye(n);await fc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function c0(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Jv(n){return n.map(e=>{var{providerId:t}=e,r=Gu(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function u0(n,e){let t=await Gv(n,{},async()=>{let r=Ss({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await Kv(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let u={method:"POST",headers:c,body:r};return n.emulatorConfig&&gn(n.emulatorConfig.host)&&(u.credentials="include"),hc.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function l0(n,e){return Rn(n,"POST","/v2/accounts:revokeToken",Sn(n,e))}var Fs=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):kv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");let t=kv(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await u0(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&($(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&($(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&($(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Gt("not implemented")}};function Tn(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var bn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Gu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Gh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Bs(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){let t=await js(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return fd(this,e)}reload(){return md(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await fc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(We(this.auth.app))return Promise.reject(Jt(this.auth));let e=await this.getIdToken();return await js(this,o0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,c,u,h,f;let m=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,P=(o=t.photoURL)!==null&&o!==void 0?o:void 0,D=(c=t.tenantId)!==null&&c!==void 0?c:void 0,R=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,O=(h=t.createdAt)!==null&&h!==void 0?h:void 0,U=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:B,emailVerified:z,isAnonymous:ge,providerData:X,stsTokenManager:E}=t;$(B&&E,e,"internal-error");let y=Fs.fromJSON(this.name,E);$(typeof B=="string",e,"internal-error"),Tn(m,e.name),Tn(g,e.name),$(typeof z=="boolean",e,"internal-error"),$(typeof ge=="boolean",e,"internal-error"),Tn(A,e.name),Tn(P,e.name),Tn(D,e.name),Tn(R,e.name),Tn(O,e.name),Tn(U,e.name);let v=new n({uid:B,auth:e,email:g,emailVerified:z,displayName:m,isAnonymous:ge,photoURL:P,phoneNumber:A,tenantId:D,stsTokenManager:y,createdAt:O,lastLoginAt:U});return X&&Array.isArray(X)&&(v.providerData=X.map(I=>Object.assign({},I))),R&&(v._redirectEventId=R),v}static async _fromIdTokenResponse(e,t,r=!1){let i=new Fs;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await fc(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];$(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Jv(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new Fs;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Bs(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u}};var Dv=new Map;function Kt(n){An(n instanceof Function,"Expected a class definition");let e=Dv.get(n);return e?(An(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Dv.set(n,e),e)}var h0=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Kh=h0;function ac(n,e,t){return`firebase:${n}:${e}:${t}`}var pc=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=ac(this.userKey,i.apiKey,s),this.fullPersistenceKey=ac("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await dc(this.auth,{idToken:e}).catch(()=>{});return t?bn._fromGetAccountInfoResponse(this.auth,t,e):null}return bn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(Kt(Kh),e,r);let i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h),s=i[0]||Kt(Kh),o=ac(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let f=await h._get(o);if(f){let m;if(typeof f=="string"){let g=await dc(e,{idToken:f}).catch(()=>{});if(!g)break;m=await bn._fromGetAccountInfoResponse(e,g,f)}else m=bn._fromJSON(e,f);h!==s&&(c=m),s=h;break}}catch{}let u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&await s._set(o,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new n(s,e,r))}};function Nv(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Zv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Qv(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tI(e))return"Blackberry";if(nI(e))return"Webos";if(Yv(e))return"Safari";if((e.includes("chrome/")||Xv(e))&&!e.includes("edge/"))return"Chrome";if(eI(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Qv(n=Re()){return/firefox\//i.test(n)}function Yv(n=Re()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Xv(n=Re()){return/crios\//i.test(n)}function Zv(n=Re()){return/iemobile/i.test(n)}function eI(n=Re()){return/android/i.test(n)}function tI(n=Re()){return/blackberry/i.test(n)}function nI(n=Re()){return/webos/i.test(n)}function gd(n=Re()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function d0(n=Re()){var e;return gd(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function f0(){return d_()&&document.documentMode===10}function rI(n=Re()){return gd(n)||eI(n)||nI(n)||tI(n)||/windows phone/i.test(n)||Zv(n)}function iI(n,e=[]){let t;switch(n){case"Browser":t=Nv(Re());break;case"Worker":t=`${Nv(Re())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${_n}/${r}`}var Jh=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let u=e(s);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function p0(n,e={}){return Rn(n,"GET","/v2/passwordPolicy",Sn(n,e))}var m0=6,Qh=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:m0,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,c;let u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Yh=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mc(this),this.idTokenSubscription=new mc(this),this.beforeStateQueue=new Jh(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Hv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Kt(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await pc.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await dc(this,{idToken:e}),r=await bn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(We(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&u?.user&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await fc(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=e0()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(We(this.app))return Promise.reject(Jt(this));let t=e?ye(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return We(this.app)?Promise.reject(Jt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return We(this.app)?Promise.reject(Jt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Kt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await p0(this),t=new Qh(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new dt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await l0(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Kt(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=await pc.create(this,[Kt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if($(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(We(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&YP(`Error while retrieving App Check token: ${t.error}`),t?.token}};function lr(n){return ye(n)}var mc=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=g_(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var wc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function g0(n){wc=n}function sI(n){return wc.loadJS(n)}function y0(){return wc.recaptchaEnterpriseScript}function _0(){return wc.gapiScript}function oI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var Xh=class{constructor(){this.enterprise=new Zh}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},Zh=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var v0="recaptcha-enterprise",aI="NO_RECAPTCHA",ed=class{constructor(e){this.type=v0,this.auth=lr(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,c)=>{s0(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let h=new Wh(u);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(u=>{c(u)})})}function i(s,o,c){let u=window.grecaptcha;Pv(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(aI)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Xh().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(c=>{if(!t&&Pv(window.grecaptcha))i(c,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=y0();u.length!==0&&(u+=c),sI(u).then(()=>{i(c,s,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}};async function Vs(n,e,t,r=!1,i=!1){let s=new ed(n),o;if(i)o=aI;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}let c=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function td(n,e,t,r,i){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let c=await Vs(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let u=await Vs(n,e,t,t==="getOobCode");return r(n,u)}else return Promise.reject(c)});else if(i==="PHONE_PROVIDER")if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){let c=await Vs(n,e,t);return r(n,c).catch(async u=>{var h;if(((h=n._getRecaptchaConfig())===null||h===void 0?void 0:h.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let f=await Vs(n,e,t,!1,!0);return r(n,f)}return Promise.reject(u)})}else{let c=await Vs(n,e,t,!1,!0);return r(n,c)}else return Promise.reject(i+" provider is not supported.")}function yd(n,e){let t=Xr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(wt(s,e??{}))return i;Rt(i,"already-initialized")}return t.initialize({options:e})}function I0(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Kt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function _d(n,e,t){let r=lr(n);$(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=cI(e),{host:o,port:c}=E0(e),u=c===null?"":`:${c}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){$(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),$(wt(h,r.config.emulator)&&wt(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,gn(o)?(Ua(`${s}//${o}${u}`),Fa("Auth",!0)):i||w0()}function cI(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function E0(n){let e=cI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Ov(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Ov(o)}}}function Ov(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function w0(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var $s=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gt("not implemented")}_getIdTokenResponse(e){return Gt("not implemented")}_linkToIdToken(e,t){return Gt("not implemented")}_getReauthenticationResolver(e){return Gt("not implemented")}};async function T0(n,e){return Rn(n,"POST","/v1/accounts:signUp",e)}async function b0(n,e){return Hs(n,"POST","/v1/accounts:signInWithPassword",Sn(n,e))}async function A0(n,e){return Hs(n,"POST","/v1/accounts:signInWithEmailLink",Sn(n,e))}async function S0(n,e){return Hs(n,"POST","/v1/accounts:signInWithEmailLink",Sn(n,e))}var zs=class n extends $s{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return td(e,t,"signInWithPassword",b0,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return A0(e,{email:this._email,oobCode:this._password});default:Rt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return td(e,r,"signUpPassword",T0,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return S0(e,{idToken:t,email:this._email,oobCode:this._password});default:Rt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function $h(n,e){return Hs(n,"POST","/v1/accounts:signInWithIdp",Sn(n,e))}function R0(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function C0(n){let e=Qr(Yr(n)).link,t=e?Qr(Yr(e)).deep_link_id:null,r=Qr(Yr(n)).deep_link_id;return(r?Qr(Yr(r)).link:null)||r||t||e||n}var gc=class n{constructor(e){var t,r,i,s,o,c;let u=Qr(Yr(e)),h=(t=u.apiKey)!==null&&t!==void 0?t:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,m=R0((i=u.mode)!==null&&i!==void 0?i:null);$(h&&f&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=f,this.continueUrl=(s=u.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=u.lang)!==null&&o!==void 0?o:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){let t=C0(e);try{return new n(t)}catch{return null}}};var uI=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return zs._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=gc.parseLink(r);return $(i,"argument-error"),zs._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),yc=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var nd=class extends yc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};async function P0(n,e){return Hs(n,"POST","/v1/accounts:signUp",Sn(n,e))}var oi=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await bn._fromIdTokenResponse(e,r,i),o=Mv(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=Mv(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function Mv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var rd=class n extends Qe{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function lI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?rd._fromErrorAndOperation(n,s,e,r):s})}async function k0(n,e,t=!1){let r=await js(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return oi._forOperation(n,"link",r)}async function D0(n,e,t=!1){let{auth:r}=n;if(We(r.app))return Promise.reject(Jt(r));let i="reauthenticate";try{let s=await js(n,lI(r,i,e,n),t);$(s.idToken,r,"internal-error");let o=pd(s.idToken);$(o,r,"internal-error");let{sub:c}=o;return $(n.uid===c,r,"user-mismatch"),oi._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Rt(r,"user-mismatch"),s}}async function hI(n,e,t=!1){if(We(n.app))return Promise.reject(Jt(n));let r="signIn",i=await lI(n,r,e),s=await oi._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function vd(n,e){return hI(lr(n),e)}async function dI(n){let e=lr(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Id(n,e,t){if(We(n.app))return Promise.reject(Jt(n));let r=lr(n),o=await td(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",P0,"EMAIL_PASSWORD_PROVIDER").catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&dI(n),u}),c=await oi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function Ed(n,e,t){return We(n.app)?Promise.reject(Jt(n)):vd(ye(n),uI.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&dI(n),r})}function wd(n,e,t,r){return ye(n).onIdTokenChanged(e,t,r)}function Td(n,e,t){return ye(n).beforeAuthStateChanged(e,t)}function bd(n){return ye(n).signOut()}var _c="__sak";var vc=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_c,"1"),this.storage.removeItem(_c),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var N0=1e3,O0=10,M0=(()=>{class n extends vc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rI(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);f0()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,O0):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},N0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),fI=M0;var L0=(()=>{class n extends vc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Ad=L0;function x0(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var V0=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:s,data:o}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let u=Array.from(c).map(async f=>f(r.origin,o)),h=await x0(u);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:h})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function pI(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var id=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((c,u)=>{let h=pI("",20);i.port1.start();let f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){let g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(g.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function St(){return window}function U0(n){St().location.href=n}function mI(){return typeof St().WorkerGlobalScope<"u"&&typeof St().importScripts=="function"}async function F0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function j0(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function B0(){return mI()?self:null}var gI="firebaseLocalStorageDb",$0=1,Ic="firebaseLocalStorage",yI="fbase_key",ur=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Tc(n,e){return n.transaction([Ic],e?"readwrite":"readonly").objectStore(Ic)}function z0(){let n=indexedDB.deleteDatabase(gI);return new ur(n).toPromise()}function sd(){let n=indexedDB.open(gI,$0);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Ic,{keyPath:yI})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(Ic)?e(r):(r.close(),await z0(),e(await sd()))})})}async function Lv(n,e,t){let r=Tc(n,!0).put({[yI]:e,value:t});return new ur(r).toPromise()}async function q0(n,e){let t=Tc(n,!1).get(e),r=await new ur(t).toPromise();return r===void 0?null:r.value}function xv(n,e){let t=Tc(n,!0).delete(e);return new ur(t).toPromise()}var H0=800,W0=3,G0=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sd(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>W0)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=V0._getInstance(B0()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await F0(),!this.activeServiceWorker)return;this.sender=new id(this.activeServiceWorker);let i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||j0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await sd();return await Lv(t,_c,"1"),await xv(t,_c),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>Lv(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>q0(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>xv(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(s=>{let o=Tc(s,!1).getAll();return new ur(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),H0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),_I=G0;var lF=oI("rcb"),hF=new cr(3e4,6e4);function K0(n,e){return e?Kt(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var qs=class extends $s{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $h(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $h(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $h(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function J0(n){return hI(n.auth,new qs(n),n.bypassAuthState)}function Q0(n){let{auth:e,user:t}=n;return $(t,e,"internal-error"),D0(t,new qs(n),n.bypassAuthState)}async function Y0(n){let{auth:e,user:t}=n;return $(t,e,"internal-error"),k0(t,new qs(n),n.bypassAuthState)}var od=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return J0;case"linkViaPopup":case"linkViaRedirect":return Y0;case"reauthViaPopup":case"reauthViaRedirect":return Q0;default:Rt(this.auth,"internal-error")}}resolve(e){An(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){An(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var dF=new cr(2e3,1e4);var X0="pendingRedirect",cc=new Map,ad=class extends od{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=cc.get(this.auth._key());if(!e){try{let r=await Z0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}cc.set(this.auth._key(),e)}return this.bypassAuthState||cc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function Z0(n,e){let t=nk(e),r=tk(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function ek(n,e){cc.set(n._key(),e)}function tk(n){return Kt(n._redirectPersistence)}function nk(n){return ac(X0,n.config.apiKey,n.name)}async function rk(n,e,t=!1){if(We(n.app))return Promise.reject(Jt(n));let r=lr(n),i=K0(r,e),o=await new ad(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}var ik=600*1e3,cd=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!sk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!vI(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ar(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ik&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vv(e))}saveEventToCache(e){this.cachedEventUids.add(Vv(e)),this.lastProcessedEventTime=Date.now()}};function Vv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function vI({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function sk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vI(n);default:return!1}}async function ok(n,e={}){return Rn(n,"GET","/v1/projects",e)}var ak=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ck=/^https?/;async function uk(n){if(n.config.emulator)return;let{authorizedDomains:e}=await ok(n);for(let t of e)try{if(lk(t))return}catch{}Rt(n,"unauthorized-domain")}function lk(n){let e=qh(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!ck.test(t))return!1;if(ak.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var hk=new cr(3e4,6e4);function Uv(){let n=St().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function dk(n){return new Promise((e,t)=>{var r,i,s;function o(){Uv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Uv(),t(ar(n,"network-request-failed"))},timeout:hk.get()})}if(!((i=(r=St().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=St().gapi)===null||s===void 0)&&s.load)o();else{let c=oI("iframefcb");return St()[c]=()=>{gapi.load?o():t(ar(n,"network-request-failed"))},sI(`${_0()}?onload=${c}`).catch(u=>t(u))}}).catch(e=>{throw uc=null,e})}var uc=null;function fk(n){return uc=uc||dk(n),uc}var pk=new cr(5e3,15e3),mk="__/auth/iframe",gk="emulator/auth/iframe",yk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_k=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vk(n){let e=n.config;$(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?dd(e,gk):`https://${n.config.authDomain}/${mk}`,r={apiKey:e.apiKey,appName:n.name,v:_n},i=_k.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Ss(r).slice(1)}`}async function Ik(n){let e=await fk(n),t=St().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:vk(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yk,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=ar(n,"network-request-failed"),c=St().setTimeout(()=>{s(o)},pk.get());function u(){St().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{s(o)})}))}var Ek={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wk=500,Tk=600,bk="_blank",Ak="http://localhost",Ec=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Sk(n,e,t,r=wk,i=Tk){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",u=Object.assign(Object.assign({},Ek),{width:r.toString(),height:i.toString(),top:s,left:o}),h=Re().toLowerCase();t&&(c=Xv(h)?bk:t),Qv(h)&&(e=e||Ak,u.scrollbars="yes");let f=Object.entries(u).reduce((g,[A,P])=>`${g}${A}=${P},`,"");if(d0(h)&&c!=="_self")return Rk(e||"",c),new Ec(null);let m=window.open(e||"",c,f);$(m,n,"popup-blocked");try{m.focus()}catch{}return new Ec(m)}function Rk(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var Ck="__/auth/handler",Pk="emulator/auth/handler",kk=encodeURIComponent("fac");async function Fv(n,e,t,r,i,s){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:_n,eventId:i};if(e instanceof yc){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",m_(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,m]of Object.entries(s||{}))o[f]=m}if(e instanceof nd){let f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let f of Object.keys(c))c[f]===void 0&&delete c[f];let u=await n._getAppCheckToken(),h=u?`#${kk}=${encodeURIComponent(u)}`:"";return`${Dk(n)}?${Ss(c).slice(1)}${h}`}function Dk({config:n}){return n.emulator?dd(n,Pk):`https://${n.authDomain}/${Ck}`}var zh="webStorageSupport",ud=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ad,this._completeRedirectFn=rk,this._overrideRedirectResult=ek}async _openPopup(e,t,r,i){var s;An((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=await Fv(e,t,r,qh(),i);return Sk(e,o,pI())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await Fv(e,t,r,qh(),i);return U0(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(An(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await Ik(e),r=new cd(e);return t.register("authEvent",i=>($(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(zh,{type:zh},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[zh];o!==void 0&&t(!!o),Rt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=uk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rI()||Yv()||gd()}},II=ud;var jv="@firebase/auth",Bv="1.10.8";var ld=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Nk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ok(n){ft(new qe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;$(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iI(n)},h=new Yh(r,i,s,u);return I0(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ft(new qe("auth-internal",e=>{let t=lr(e.getProvider("auth").getImmediate());return(r=>new ld(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pe(jv,Bv,Nk(n)),pe(jv,Bv,"esm2017")}var Mk=300,Lk=Gl("authIdTokenMaxAge")||Mk,$v=null,xk=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Lk)return;let i=t?.token;$v!==i&&($v=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Sd(n=er()){let e=Xr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=yd(n,{popupRedirectResolver:II,persistence:[_I,fI,Ad]}),r=Gl("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=xk(s.toString());Td(t,o,()=>o(t.currentUser)),wd(t,c=>o(c))}}let i=Hl("auth");return i&&_d(t,`http://${i}`),t}function Vk(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}g0({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=ar("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Vk().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ok("Browser");var EI="auth",hr=class{constructor(e){return e}},Ws=class{constructor(){return ei(EI)}};var Rd=new ne("angularfire2.auth-instances");function SD(n,e){let t=Ps(EI,n,e);return t&&new hr(t)}function RD(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new hr(r)}}var CD={provide:Ws,deps:[[new nt,Rd]]},PD={provide:hr,useFactory:SD,deps:[[new nt,Rd],zt]};function e2(n,...e){return pe("angularfire",vn.full,"auth"),at([PD,CD,{provide:Rd,useFactory:RD(n),multi:!0,deps:[$e,ut,In,nr,[new nt,ti],...e]}])}var wI=_e(Rv,!0);var TI=_e(Id,!0,2);var t2=_e(Sd,!0);var bI=_e(Ed,!0,2);var Cd=_e(bd,!0,2);var AI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},SI={};var Qt,Pd;(function(){var n;function e(E,y){function v(){}v.prototype=y.prototype,E.D=y.prototype,E.prototype=new v,E.prototype.constructor=E,E.C=function(I,w,b){for(var _=Array(arguments.length-2),Mt=2;Mt<arguments.length;Mt++)_[Mt-2]=arguments[Mt];return y.prototype[w].apply(I,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,y,v){v||(v=0);var I=Array(16);if(typeof y=="string")for(var w=0;16>w;++w)I[w]=y.charCodeAt(v++)|y.charCodeAt(v++)<<8|y.charCodeAt(v++)<<16|y.charCodeAt(v++)<<24;else for(w=0;16>w;++w)I[w]=y[v++]|y[v++]<<8|y[v++]<<16|y[v++]<<24;y=E.g[0],v=E.g[1],w=E.g[2];var b=E.g[3],_=y+(b^v&(w^b))+I[0]+3614090360&4294967295;y=v+(_<<7&4294967295|_>>>25),_=b+(w^y&(v^w))+I[1]+3905402710&4294967295,b=y+(_<<12&4294967295|_>>>20),_=w+(v^b&(y^v))+I[2]+606105819&4294967295,w=b+(_<<17&4294967295|_>>>15),_=v+(y^w&(b^y))+I[3]+3250441966&4294967295,v=w+(_<<22&4294967295|_>>>10),_=y+(b^v&(w^b))+I[4]+4118548399&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(w^y&(v^w))+I[5]+1200080426&4294967295,b=y+(_<<12&4294967295|_>>>20),_=w+(v^b&(y^v))+I[6]+2821735955&4294967295,w=b+(_<<17&4294967295|_>>>15),_=v+(y^w&(b^y))+I[7]+4249261313&4294967295,v=w+(_<<22&4294967295|_>>>10),_=y+(b^v&(w^b))+I[8]+1770035416&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(w^y&(v^w))+I[9]+2336552879&4294967295,b=y+(_<<12&4294967295|_>>>20),_=w+(v^b&(y^v))+I[10]+4294925233&4294967295,w=b+(_<<17&4294967295|_>>>15),_=v+(y^w&(b^y))+I[11]+2304563134&4294967295,v=w+(_<<22&4294967295|_>>>10),_=y+(b^v&(w^b))+I[12]+1804603682&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(w^y&(v^w))+I[13]+4254626195&4294967295,b=y+(_<<12&4294967295|_>>>20),_=w+(v^b&(y^v))+I[14]+2792965006&4294967295,w=b+(_<<17&4294967295|_>>>15),_=v+(y^w&(b^y))+I[15]+1236535329&4294967295,v=w+(_<<22&4294967295|_>>>10),_=y+(w^b&(v^w))+I[1]+4129170786&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^w&(y^v))+I[6]+3225465664&4294967295,b=y+(_<<9&4294967295|_>>>23),_=w+(y^v&(b^y))+I[11]+643717713&4294967295,w=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(w^b))+I[0]+3921069994&4294967295,v=w+(_<<20&4294967295|_>>>12),_=y+(w^b&(v^w))+I[5]+3593408605&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^w&(y^v))+I[10]+38016083&4294967295,b=y+(_<<9&4294967295|_>>>23),_=w+(y^v&(b^y))+I[15]+3634488961&4294967295,w=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(w^b))+I[4]+3889429448&4294967295,v=w+(_<<20&4294967295|_>>>12),_=y+(w^b&(v^w))+I[9]+568446438&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^w&(y^v))+I[14]+3275163606&4294967295,b=y+(_<<9&4294967295|_>>>23),_=w+(y^v&(b^y))+I[3]+4107603335&4294967295,w=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(w^b))+I[8]+1163531501&4294967295,v=w+(_<<20&4294967295|_>>>12),_=y+(w^b&(v^w))+I[13]+2850285829&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^w&(y^v))+I[2]+4243563512&4294967295,b=y+(_<<9&4294967295|_>>>23),_=w+(y^v&(b^y))+I[7]+1735328473&4294967295,w=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(w^b))+I[12]+2368359562&4294967295,v=w+(_<<20&4294967295|_>>>12),_=y+(v^w^b)+I[5]+4294588738&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^w)+I[8]+2272392833&4294967295,b=y+(_<<11&4294967295|_>>>21),_=w+(b^y^v)+I[11]+1839030562&4294967295,w=b+(_<<16&4294967295|_>>>16),_=v+(w^b^y)+I[14]+4259657740&4294967295,v=w+(_<<23&4294967295|_>>>9),_=y+(v^w^b)+I[1]+2763975236&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^w)+I[4]+1272893353&4294967295,b=y+(_<<11&4294967295|_>>>21),_=w+(b^y^v)+I[7]+4139469664&4294967295,w=b+(_<<16&4294967295|_>>>16),_=v+(w^b^y)+I[10]+3200236656&4294967295,v=w+(_<<23&4294967295|_>>>9),_=y+(v^w^b)+I[13]+681279174&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^w)+I[0]+3936430074&4294967295,b=y+(_<<11&4294967295|_>>>21),_=w+(b^y^v)+I[3]+3572445317&4294967295,w=b+(_<<16&4294967295|_>>>16),_=v+(w^b^y)+I[6]+76029189&4294967295,v=w+(_<<23&4294967295|_>>>9),_=y+(v^w^b)+I[9]+3654602809&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^w)+I[12]+3873151461&4294967295,b=y+(_<<11&4294967295|_>>>21),_=w+(b^y^v)+I[15]+530742520&4294967295,w=b+(_<<16&4294967295|_>>>16),_=v+(w^b^y)+I[2]+3299628645&4294967295,v=w+(_<<23&4294967295|_>>>9),_=y+(w^(v|~b))+I[0]+4096336452&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~w))+I[7]+1126891415&4294967295,b=y+(_<<10&4294967295|_>>>22),_=w+(y^(b|~v))+I[14]+2878612391&4294967295,w=b+(_<<15&4294967295|_>>>17),_=v+(b^(w|~y))+I[5]+4237533241&4294967295,v=w+(_<<21&4294967295|_>>>11),_=y+(w^(v|~b))+I[12]+1700485571&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~w))+I[3]+2399980690&4294967295,b=y+(_<<10&4294967295|_>>>22),_=w+(y^(b|~v))+I[10]+4293915773&4294967295,w=b+(_<<15&4294967295|_>>>17),_=v+(b^(w|~y))+I[1]+2240044497&4294967295,v=w+(_<<21&4294967295|_>>>11),_=y+(w^(v|~b))+I[8]+1873313359&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~w))+I[15]+4264355552&4294967295,b=y+(_<<10&4294967295|_>>>22),_=w+(y^(b|~v))+I[6]+2734768916&4294967295,w=b+(_<<15&4294967295|_>>>17),_=v+(b^(w|~y))+I[13]+1309151649&4294967295,v=w+(_<<21&4294967295|_>>>11),_=y+(w^(v|~b))+I[4]+4149444226&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~w))+I[11]+3174756917&4294967295,b=y+(_<<10&4294967295|_>>>22),_=w+(y^(b|~v))+I[2]+718787259&4294967295,w=b+(_<<15&4294967295|_>>>17),_=v+(b^(w|~y))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(w+(_<<21&4294967295|_>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+b&4294967295}r.prototype.u=function(E,y){y===void 0&&(y=E.length);for(var v=y-this.blockSize,I=this.B,w=this.h,b=0;b<y;){if(w==0)for(;b<=v;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<y;)if(I[w++]=E.charCodeAt(b++),w==this.blockSize){i(this,I),w=0;break}}else for(;b<y;)if(I[w++]=E[b++],w==this.blockSize){i(this,I),w=0;break}}this.h=w,this.o+=y},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;var v=8*this.o;for(y=E.length-8;y<E.length;++y)E[y]=v&255,v/=256;for(this.u(E),E=Array(16),y=v=0;4>y;++y)for(var I=0;32>I;I+=8)E[v++]=this.g[y]>>>I&255;return E};function s(E,y){var v=c;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=y(E)}function o(E,y){this.h=y;for(var v=[],I=!0,w=E.length-1;0<=w;w--){var b=E[w]|0;I&&b==y||(v[w]=b,I=!1)}this.g=v}var c={};function u(E){return-128<=E&&128>E?s(E,function(y){return new o([y|0],0>y?-1:0)}):new o([E|0],0>E?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(0>E)return R(h(-E));for(var y=[],v=1,I=0;E>=v;I++)y[I]=E/v|0,v*=4294967296;return new o(y,0)}function f(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return R(f(E.substring(1),y));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(y,8)),I=m,w=0;w<E.length;w+=8){var b=Math.min(8,E.length-w),_=parseInt(E.substring(w,w+b),y);8>b?(b=h(Math.pow(y,b)),I=I.j(b).add(h(_))):(I=I.j(v),I=I.add(h(_)))}return I}var m=u(0),g=u(1),A=u(16777216);n=o.prototype,n.m=function(){if(D(this))return-R(this).m();for(var E=0,y=1,v=0;v<this.g.length;v++){var I=this.i(v);E+=(0<=I?I:4294967296+I)*y,y*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(P(this))return"0";if(D(this))return"-"+R(this).toString(E);for(var y=h(Math.pow(E,6)),v=this,I="";;){var w=z(v,y).g;v=O(v,w.j(y));var b=((0<v.g.length?v.g[0]:v.h)>>>0).toString(E);if(v=w,P(v))return b+I;for(;6>b.length;)b="0"+b;I=b+I}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function P(E){if(E.h!=0)return!1;for(var y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function D(E){return E.h==-1}n.l=function(E){return E=O(this,E),D(E)?-1:P(E)?0:1};function R(E){for(var y=E.g.length,v=[],I=0;I<y;I++)v[I]=~E.g[I];return new o(v,~E.h).add(g)}n.abs=function(){return D(this)?R(this):this},n.add=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],I=0,w=0;w<=y;w++){var b=I+(this.i(w)&65535)+(E.i(w)&65535),_=(b>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);I=_>>>16,b&=65535,_&=65535,v[w]=_<<16|b}return new o(v,v[v.length-1]&-2147483648?-1:0)};function O(E,y){return E.add(R(y))}n.j=function(E){if(P(this)||P(E))return m;if(D(this))return D(E)?R(this).j(R(E)):R(R(this).j(E));if(D(E))return R(this.j(R(E)));if(0>this.l(A)&&0>E.l(A))return h(this.m()*E.m());for(var y=this.g.length+E.g.length,v=[],I=0;I<2*y;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(var w=0;w<E.g.length;w++){var b=this.i(I)>>>16,_=this.i(I)&65535,Mt=E.i(w)>>>16,Ni=E.i(w)&65535;v[2*I+2*w]+=_*Ni,U(v,2*I+2*w),v[2*I+2*w+1]+=b*Ni,U(v,2*I+2*w+1),v[2*I+2*w+1]+=_*Mt,U(v,2*I+2*w+1),v[2*I+2*w+2]+=b*Mt,U(v,2*I+2*w+2)}for(I=0;I<y;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=y;I<2*y;I++)v[I]=0;return new o(v,0)};function U(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function B(E,y){this.g=E,this.h=y}function z(E,y){if(P(y))throw Error("division by zero");if(P(E))return new B(m,m);if(D(E))return y=z(R(E),y),new B(R(y.g),R(y.h));if(D(y))return y=z(E,R(y)),new B(R(y.g),y.h);if(30<E.g.length){if(D(E)||D(y))throw Error("slowDivide_ only works with positive integers.");for(var v=g,I=y;0>=I.l(E);)v=ge(v),I=ge(I);var w=X(v,1),b=X(I,1);for(I=X(I,2),v=X(v,2);!P(I);){var _=b.add(I);0>=_.l(E)&&(w=w.add(v),b=_),I=X(I,1),v=X(v,1)}return y=O(E,w.j(y)),new B(w,y)}for(w=m;0<=E.l(y);){for(v=Math.max(1,Math.floor(E.m()/y.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),b=h(v),_=b.j(y);D(_)||0<_.l(E);)v-=I,b=h(v),_=b.j(y);P(b)&&(b=g),w=w.add(b),E=O(E,_)}return new B(w,E)}n.A=function(E){return z(this,E).h},n.and=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],I=0;I<y;I++)v[I]=this.i(I)&E.i(I);return new o(v,this.h&E.h)},n.or=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],I=0;I<y;I++)v[I]=this.i(I)|E.i(I);return new o(v,this.h|E.h)},n.xor=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],I=0;I<y;I++)v[I]=this.i(I)^E.i(I);return new o(v,this.h^E.h)};function ge(E){for(var y=E.g.length+1,v=[],I=0;I<y;I++)v[I]=E.i(I)<<1|E.i(I-1)>>>31;return new o(v,E.h)}function X(E,y){var v=y>>5;y%=32;for(var I=E.g.length-v,w=[],b=0;b<I;b++)w[b]=0<y?E.i(b+v)>>>y|E.i(b+v+1)<<32-y:E.i(b+v);return new o(w,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Pd=SI.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,Qt=SI.Integer=o}).apply(typeof AI<"u"?AI:typeof self<"u"?self:typeof window<"u"?window:{});var bc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yt={};var kd,kD,ai,Dd,Gs,Ac,Nd,Od,Md;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,l,d){return a==Array.prototype||a==Object.prototype||(a[l]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof bc=="object"&&bc];for(var l=0;l<a.length;++l){var d=a[l];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(a,l){if(l)e:{var d=r;a=a.split(".");for(var p=0;p<a.length-1;p++){var T=a[p];if(!(T in d))break e;d=d[T]}a=a[a.length-1],p=d[a],l=l(p),l!=p&&l!=null&&e(d,a,{configurable:!0,writable:!0,value:l})}}function s(a,l){a instanceof String&&(a+="");var d=0,p=!1,T={next:function(){if(!p&&d<a.length){var S=d++;return{value:l(S,a[S]),done:!1}}return p=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(a){return a||function(){return s(this,function(l,d){return d})}});var o=o||{},c=this||self;function u(a){var l=typeof a;return l=l!="object"?l:a?Array.isArray(a)?"array":l:"null",l=="array"||l=="object"&&typeof a.length=="number"}function h(a){var l=typeof a;return l=="object"&&a!=null||l=="function"}function f(a,l,d){return a.call.apply(a.bind,arguments)}function m(a,l,d){if(!a)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,p),a.apply(l,T)}}return function(){return a.apply(l,arguments)}}function g(a,l,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,g.apply(null,arguments)}function A(a,l){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),a.apply(this,p)}}function P(a,l){function d(){}d.prototype=l.prototype,a.aa=l.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(p,T,S){for(var N=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)N[ae-2]=arguments[ae];return l.prototype[T].apply(p,N)}}function D(a){let l=a.length;if(0<l){let d=Array(l);for(let p=0;p<l;p++)d[p]=a[p];return d}return[]}function R(a,l){for(let d=1;d<arguments.length;d++){let p=arguments[d];if(u(p)){let T=a.length||0,S=p.length||0;a.length=T+S;for(let N=0;N<S;N++)a[T+N]=p[N]}else a.push(p)}}class O{constructor(l,d){this.i=l,this.j=d,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function U(a){return/^[\s\xa0]*$/.test(a)}function B(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function z(a){return z[" "](a),a}z[" "]=function(){};var ge=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function X(a,l,d){for(let p in a)l.call(d,a[p],p,a)}function E(a,l){for(let d in a)l.call(void 0,a[d],d,a)}function y(a){let l={};for(let d in a)l[d]=a[d];return l}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,l){let d,p;for(let T=1;T<arguments.length;T++){p=arguments[T];for(d in p)a[d]=p[d];for(let S=0;S<v.length;S++)d=v[S],Object.prototype.hasOwnProperty.call(p,d)&&(a[d]=p[d])}}function w(a){var l=1;a=a.split(":");let d=[];for(;0<l&&a.length;)d.push(a.shift()),l--;return a.length&&d.push(a.join(":")),d}function b(a){c.setTimeout(()=>{throw a},0)}function _(){var a=wu;let l=null;return a.g&&(l=a.g,a.g=a.g.next,a.g||(a.h=null),l.next=null),l}class Mt{constructor(){this.h=this.g=null}add(l,d){let p=Ni.get();p.set(l,d),this.h?this.h.next=p:this.g=p,this.h=p}}var Ni=new O(()=>new lT,a=>a.reset());class lT{constructor(){this.next=this.g=this.h=null}set(l,d){this.h=l,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Oi,Mi=!1,wu=new Mt,Xp=()=>{let a=c.Promise.resolve(void 0);Oi=()=>{a.then(hT)}};var hT=()=>{for(var a;a=_();){try{a.h.call(a.g)}catch(d){b(d)}var l=Ni;l.j(a),100>l.h&&(l.h++,a.next=l.g,l.g=a)}Mi=!1};function sn(){this.s=this.s,this.C=this.C}sn.prototype.s=!1,sn.prototype.ma=function(){this.s||(this.s=!0,this.N())},sn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ne(a,l){this.type=a,this.g=this.target=l,this.defaultPrevented=!1}Ne.prototype.h=function(){this.defaultPrevented=!0};var dT=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,l=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};c.addEventListener("test",d,l),c.removeEventListener("test",d,l)}catch{}return a})();function Li(a,l){if(Ne.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,p=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=l,l=a.relatedTarget){if(ge){e:{try{z(l.nodeName);var T=!0;break e}catch{}T=!1}T||(l=null)}}else d=="mouseover"?l=a.fromElement:d=="mouseout"&&(l=a.toElement);this.relatedTarget=l,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:fT[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Li.aa.h.call(this)}}P(Li,Ne);var fT={2:"touch",3:"pen",4:"mouse"};Li.prototype.h=function(){Li.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var xi="closure_listenable_"+(1e6*Math.random()|0),pT=0;function mT(a,l,d,p,T){this.listener=a,this.proxy=null,this.src=l,this.type=d,this.capture=!!p,this.ha=T,this.key=++pT,this.da=this.fa=!1}function vo(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Io(a){this.src=a,this.g={},this.h=0}Io.prototype.add=function(a,l,d,p,T){var S=a.toString();a=this.g[S],a||(a=this.g[S]=[],this.h++);var N=bu(a,l,p,T);return-1<N?(l=a[N],d||(l.fa=!1)):(l=new mT(l,this.src,S,!!p,T),l.fa=d,a.push(l)),l};function Tu(a,l){var d=l.type;if(d in a.g){var p=a.g[d],T=Array.prototype.indexOf.call(p,l,void 0),S;(S=0<=T)&&Array.prototype.splice.call(p,T,1),S&&(vo(l),a.g[d].length==0&&(delete a.g[d],a.h--))}}function bu(a,l,d,p){for(var T=0;T<a.length;++T){var S=a[T];if(!S.da&&S.listener==l&&S.capture==!!d&&S.ha==p)return T}return-1}var Au="closure_lm_"+(1e6*Math.random()|0),Su={};function Zp(a,l,d,p,T){if(p&&p.once)return tm(a,l,d,p,T);if(Array.isArray(l)){for(var S=0;S<l.length;S++)Zp(a,l[S],d,p,T);return null}return d=ku(d),a&&a[xi]?a.K(l,d,h(p)?!!p.capture:!!p,T):em(a,l,d,!1,p,T)}function em(a,l,d,p,T,S){if(!l)throw Error("Invalid event type");var N=h(T)?!!T.capture:!!T,ae=Cu(a);if(ae||(a[Au]=ae=new Io(a)),d=ae.add(l,d,p,N,S),d.proxy)return d;if(p=gT(),d.proxy=p,p.src=a,p.listener=d,a.addEventListener)dT||(T=N),T===void 0&&(T=!1),a.addEventListener(l.toString(),p,T);else if(a.attachEvent)a.attachEvent(rm(l.toString()),p);else if(a.addListener&&a.removeListener)a.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function gT(){function a(d){return l.call(a.src,a.listener,d)}let l=yT;return a}function tm(a,l,d,p,T){if(Array.isArray(l)){for(var S=0;S<l.length;S++)tm(a,l[S],d,p,T);return null}return d=ku(d),a&&a[xi]?a.L(l,d,h(p)?!!p.capture:!!p,T):em(a,l,d,!0,p,T)}function nm(a,l,d,p,T){if(Array.isArray(l))for(var S=0;S<l.length;S++)nm(a,l[S],d,p,T);else p=h(p)?!!p.capture:!!p,d=ku(d),a&&a[xi]?(a=a.i,l=String(l).toString(),l in a.g&&(S=a.g[l],d=bu(S,d,p,T),-1<d&&(vo(S[d]),Array.prototype.splice.call(S,d,1),S.length==0&&(delete a.g[l],a.h--)))):a&&(a=Cu(a))&&(l=a.g[l.toString()],a=-1,l&&(a=bu(l,d,p,T)),(d=-1<a?l[a]:null)&&Ru(d))}function Ru(a){if(typeof a!="number"&&a&&!a.da){var l=a.src;if(l&&l[xi])Tu(l.i,a);else{var d=a.type,p=a.proxy;l.removeEventListener?l.removeEventListener(d,p,a.capture):l.detachEvent?l.detachEvent(rm(d),p):l.addListener&&l.removeListener&&l.removeListener(p),(d=Cu(l))?(Tu(d,a),d.h==0&&(d.src=null,l[Au]=null)):vo(a)}}}function rm(a){return a in Su?Su[a]:Su[a]="on"+a}function yT(a,l){if(a.da)a=!0;else{l=new Li(l,this);var d=a.listener,p=a.ha||a.src;a.fa&&Ru(a),a=d.call(p,l)}return a}function Cu(a){return a=a[Au],a instanceof Io?a:null}var Pu="__closure_events_fn_"+(1e9*Math.random()>>>0);function ku(a){return typeof a=="function"?a:(a[Pu]||(a[Pu]=function(l){return a.handleEvent(l)}),a[Pu])}function Oe(){sn.call(this),this.i=new Io(this),this.M=this,this.F=null}P(Oe,sn),Oe.prototype[xi]=!0,Oe.prototype.removeEventListener=function(a,l,d,p){nm(this,a,l,d,p)};function Fe(a,l){var d,p=a.F;if(p)for(d=[];p;p=p.F)d.push(p);if(a=a.M,p=l.type||l,typeof l=="string")l=new Ne(l,a);else if(l instanceof Ne)l.target=l.target||a;else{var T=l;l=new Ne(p,a),I(l,T)}if(T=!0,d)for(var S=d.length-1;0<=S;S--){var N=l.g=d[S];T=Eo(N,p,!0,l)&&T}if(N=l.g=a,T=Eo(N,p,!0,l)&&T,T=Eo(N,p,!1,l)&&T,d)for(S=0;S<d.length;S++)N=l.g=d[S],T=Eo(N,p,!1,l)&&T}Oe.prototype.N=function(){if(Oe.aa.N.call(this),this.i){var a=this.i,l;for(l in a.g){for(var d=a.g[l],p=0;p<d.length;p++)vo(d[p]);delete a.g[l],a.h--}}this.F=null},Oe.prototype.K=function(a,l,d,p){return this.i.add(String(a),l,!1,d,p)},Oe.prototype.L=function(a,l,d,p){return this.i.add(String(a),l,!0,d,p)};function Eo(a,l,d,p){if(l=a.i.g[String(l)],!l)return!0;l=l.concat();for(var T=!0,S=0;S<l.length;++S){var N=l[S];if(N&&!N.da&&N.capture==d){var ae=N.listener,ke=N.ha||N.src;N.fa&&Tu(a.i,N),T=ae.call(ke,p)!==!1&&T}}return T&&!p.defaultPrevented}function im(a,l,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:c.setTimeout(a,l||0)}function sm(a){a.g=im(()=>{a.g=null,a.i&&(a.i=!1,sm(a))},a.l);let l=a.h;a.h=null,a.m.apply(null,l)}class _T extends sn{constructor(l,d){super(),this.m=l,this.l=d,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:sm(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vi(a){sn.call(this),this.h=a,this.g={}}P(Vi,sn);var om=[];function am(a){X(a.g,function(l,d){this.g.hasOwnProperty(d)&&Ru(l)},a),a.g={}}Vi.prototype.N=function(){Vi.aa.N.call(this),am(this)},Vi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Du=c.JSON.stringify,vT=c.JSON.parse,IT=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function Nu(){}Nu.prototype.h=null;function cm(a){return a.h||(a.h=a.i())}function um(){}var Ui={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ou(){Ne.call(this,"d")}P(Ou,Ne);function Mu(){Ne.call(this,"c")}P(Mu,Ne);var Vn={},lm=null;function wo(){return lm=lm||new Oe}Vn.La="serverreachability";function hm(a){Ne.call(this,Vn.La,a)}P(hm,Ne);function Fi(a){let l=wo();Fe(l,new hm(l))}Vn.STAT_EVENT="statevent";function dm(a,l){Ne.call(this,Vn.STAT_EVENT,a),this.stat=l}P(dm,Ne);function je(a){let l=wo();Fe(l,new dm(l,a))}Vn.Ma="timingevent";function fm(a,l){Ne.call(this,Vn.Ma,a),this.size=l}P(fm,Ne);function ji(a,l){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},l)}function Bi(){this.g=!0}Bi.prototype.xa=function(){this.g=!1};function ET(a,l,d,p,T,S){a.info(function(){if(a.g)if(S)for(var N="",ae=S.split("&"),ke=0;ke<ae.length;ke++){var ee=ae[ke].split("=");if(1<ee.length){var Me=ee[0];ee=ee[1];var Le=Me.split("_");N=2<=Le.length&&Le[1]=="type"?N+(Me+"="+ee+"&"):N+(Me+"=redacted&")}}else N=null;else N=S;return"XMLHTTP REQ ("+p+") [attempt "+T+"]: "+l+`
`+d+`
`+N})}function wT(a,l,d,p,T,S,N){a.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+T+"]: "+l+`
`+d+`
`+S+" "+N})}function Cr(a,l,d,p){a.info(function(){return"XMLHTTP TEXT ("+l+"): "+bT(a,d)+(p?" "+p:"")})}function TT(a,l){a.info(function(){return"TIMEOUT: "+l})}Bi.prototype.info=function(){};function bT(a,l){if(!a.g)return l;if(!l)return null;try{var d=JSON.parse(l);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var p=d[a];if(!(2>p.length)){var T=p[1];if(Array.isArray(T)&&!(1>T.length)){var S=T[0];if(S!="noop"&&S!="stop"&&S!="close")for(var N=1;N<T.length;N++)T[N]=""}}}}return Du(d)}catch{return l}}var To={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},pm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Lu;function bo(){}P(bo,Nu),bo.prototype.g=function(){return new XMLHttpRequest},bo.prototype.i=function(){return{}},Lu=new bo;function on(a,l,d,p){this.j=a,this.i=l,this.l=d,this.R=p||1,this.U=new Vi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new mm}function mm(){this.i=null,this.g="",this.h=!1}var gm={},xu={};function Vu(a,l,d){a.L=1,a.v=Co(Lt(l)),a.m=d,a.P=!0,ym(a,null)}function ym(a,l){a.F=Date.now(),Ao(a),a.A=Lt(a.v);var d=a.A,p=a.R;Array.isArray(p)||(p=[String(p)]),Dm(d.i,"t",p),a.C=0,d=a.j.J,a.h=new mm,a.g=Jm(a.j,d?l:null,!a.m),0<a.O&&(a.M=new _T(g(a.Y,a,a.g),a.O)),l=a.U,d=a.g,p=a.ca;var T="readystatechange";Array.isArray(T)||(T&&(om[0]=T.toString()),T=om);for(var S=0;S<T.length;S++){var N=Zp(d,T[S],p||l.handleEvent,!1,l.h||l);if(!N)break;l.g[N.key]=N}l=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,l)):(a.u="GET",a.g.ea(a.A,a.u,null,l)),Fi(),ET(a.i,a.u,a.A,a.l,a.R,a.m)}on.prototype.ca=function(a){a=a.target;let l=this.M;l&&xt(a)==3?l.j():this.Y(a)},on.prototype.Y=function(a){try{if(a==this.g)e:{let Le=xt(this.g);var l=this.g.Ba();let Dr=this.g.Z();if(!(3>Le)&&(Le!=3||this.g&&(this.h.h||this.g.oa()||Um(this.g)))){this.J||Le!=4||l==7||(l==8||0>=Dr?Fi(3):Fi(2)),Uu(this);var d=this.g.Z();this.X=d;t:if(_m(this)){var p=Um(this.g);a="";var T=p.length,S=xt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Un(this),$i(this);var N="";break t}this.h.i=new c.TextDecoder}for(l=0;l<T;l++)this.h.h=!0,a+=this.h.i.decode(p[l],{stream:!(S&&l==T-1)});p.length=0,this.h.g+=a,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=d==200,wT(this.i,this.u,this.A,this.l,this.R,Le,d),this.o){if(this.T&&!this.K){t:{if(this.g){var ae,ke=this.g;if((ae=ke.g?ke.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(ae)){var ee=ae;break t}}ee=null}if(d=ee)Cr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fu(this,d);else{this.o=!1,this.s=3,je(12),Un(this),$i(this);break e}}if(this.P){d=!0;let st;for(;!this.J&&this.C<N.length;)if(st=AT(this,N),st==xu){Le==4&&(this.s=4,je(14),d=!1),Cr(this.i,this.l,null,"[Incomplete Response]");break}else if(st==gm){this.s=4,je(15),Cr(this.i,this.l,N,"[Invalid Chunk]"),d=!1;break}else Cr(this.i,this.l,st,null),Fu(this,st);if(_m(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Le!=4||N.length!=0||this.h.h||(this.s=1,je(16),d=!1),this.o=this.o&&d,!d)Cr(this.i,this.l,N,"[Invalid Chunked Response]"),Un(this),$i(this);else if(0<N.length&&!this.W){this.W=!0;var Me=this.j;Me.g==this&&Me.ba&&!Me.M&&(Me.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),Hu(Me),Me.M=!0,je(11))}}else Cr(this.i,this.l,N,null),Fu(this,N);Le==4&&Un(this),this.o&&!this.J&&(Le==4?Hm(this.j,this):(this.o=!1,Ao(this)))}else $T(this.g),d==400&&0<N.indexOf("Unknown SID")?(this.s=3,je(12)):(this.s=0,je(13)),Un(this),$i(this)}}}catch{}finally{}};function _m(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function AT(a,l){var d=a.C,p=l.indexOf(`
`,d);return p==-1?xu:(d=Number(l.substring(d,p)),isNaN(d)?gm:(p+=1,p+d>l.length?xu:(l=l.slice(p,p+d),a.C=p+d,l)))}on.prototype.cancel=function(){this.J=!0,Un(this)};function Ao(a){a.S=Date.now()+a.I,vm(a,a.I)}function vm(a,l){if(a.B!=null)throw Error("WatchDog timer not null");a.B=ji(g(a.ba,a),l)}function Uu(a){a.B&&(c.clearTimeout(a.B),a.B=null)}on.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(TT(this.i,this.A),this.L!=2&&(Fi(),je(17)),Un(this),this.s=2,$i(this)):vm(this,this.S-a)};function $i(a){a.j.G==0||a.J||Hm(a.j,a)}function Un(a){Uu(a);var l=a.M;l&&typeof l.ma=="function"&&l.ma(),a.M=null,am(a.U),a.g&&(l=a.g,a.g=null,l.abort(),l.ma())}function Fu(a,l){try{var d=a.j;if(d.G!=0&&(d.g==a||ju(d.h,a))){if(!a.K&&ju(d.h,a)&&d.G==3){try{var p=d.Da.g.parse(l)}catch{p=null}if(Array.isArray(p)&&p.length==3){var T=p;if(T[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)Oo(d),Do(d);else break e;qu(d),je(18)}}else d.za=T[1],0<d.za-d.T&&37500>T[2]&&d.F&&d.v==0&&!d.C&&(d.C=ji(g(d.Za,d),6e3));if(1>=wm(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else jn(d,11)}else if((a.K||d.g==a)&&Oo(d),!U(l))for(T=d.Da.g.parse(l),l=0;l<T.length;l++){let ee=T[l];if(d.T=ee[0],ee=ee[1],d.G==2)if(ee[0]=="c"){d.K=ee[1],d.ia=ee[2];let Me=ee[3];Me!=null&&(d.la=Me,d.j.info("VER="+d.la));let Le=ee[4];Le!=null&&(d.Aa=Le,d.j.info("SVER="+d.Aa));let Dr=ee[5];Dr!=null&&typeof Dr=="number"&&0<Dr&&(p=1.5*Dr,d.L=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let st=a.g;if(st){let Lo=st.g?st.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Lo){var S=p.h;S.g||Lo.indexOf("spdy")==-1&&Lo.indexOf("quic")==-1&&Lo.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(Bu(S,S.h),S.h=null))}if(p.D){let Wu=st.g?st.g.getResponseHeader("X-HTTP-Session-Id"):null;Wu&&(p.ya=Wu,le(p.I,p.D,Wu))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),p=d;var N=a;if(p.qa=Km(p,p.J?p.ia:null,p.W),N.K){Tm(p.h,N);var ae=N,ke=p.L;ke&&(ae.I=ke),ae.B&&(Uu(ae),Ao(ae)),p.g=N}else zm(p);0<d.i.length&&No(d)}else ee[0]!="stop"&&ee[0]!="close"||jn(d,7);else d.G==3&&(ee[0]=="stop"||ee[0]=="close"?ee[0]=="stop"?jn(d,7):zu(d):ee[0]!="noop"&&d.l&&d.l.ta(ee),d.v=0)}}Fi(4)}catch{}}var ST=class{constructor(a,l){this.g=a,this.map=l}};function Im(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Em(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function wm(a){return a.h?1:a.g?a.g.size:0}function ju(a,l){return a.h?a.h==l:a.g?a.g.has(l):!1}function Bu(a,l){a.g?a.g.add(l):a.h=l}function Tm(a,l){a.h&&a.h==l?a.h=null:a.g&&a.g.has(l)&&a.g.delete(l)}Im.prototype.cancel=function(){if(this.i=bm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function bm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let l=a.i;for(let d of a.g.values())l=l.concat(d.D);return l}return D(a.i)}function RT(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var l=[],d=a.length,p=0;p<d;p++)l.push(a[p]);return l}l=[],d=0;for(p in a)l[d++]=a[p];return l}function CT(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var l=[];a=a.length;for(var d=0;d<a;d++)l.push(d);return l}l=[],d=0;for(let p in a)l[d++]=p;return l}}}function Am(a,l){if(a.forEach&&typeof a.forEach=="function")a.forEach(l,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,l,void 0);else for(var d=CT(a),p=RT(a),T=p.length,S=0;S<T;S++)l.call(void 0,p[S],d&&d[S],a)}var Sm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PT(a,l){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var p=a[d].indexOf("="),T=null;if(0<=p){var S=a[d].substring(0,p);T=a[d].substring(p+1)}else S=a[d];l(S,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Fn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Fn){this.h=a.h,So(this,a.j),this.o=a.o,this.g=a.g,Ro(this,a.s),this.l=a.l;var l=a.i,d=new Hi;d.i=l.i,l.g&&(d.g=new Map(l.g),d.h=l.h),Rm(this,d),this.m=a.m}else a&&(l=String(a).match(Sm))?(this.h=!1,So(this,l[1]||"",!0),this.o=zi(l[2]||""),this.g=zi(l[3]||"",!0),Ro(this,l[4]),this.l=zi(l[5]||"",!0),Rm(this,l[6]||"",!0),this.m=zi(l[7]||"")):(this.h=!1,this.i=new Hi(null,this.h))}Fn.prototype.toString=function(){var a=[],l=this.j;l&&a.push(qi(l,Cm,!0),":");var d=this.g;return(d||l=="file")&&(a.push("//"),(l=this.o)&&a.push(qi(l,Cm,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(qi(d,d.charAt(0)=="/"?NT:DT,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",qi(d,MT)),a.join("")};function Lt(a){return new Fn(a)}function So(a,l,d){a.j=d?zi(l,!0):l,a.j&&(a.j=a.j.replace(/:$/,""))}function Ro(a,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);a.s=l}else a.s=null}function Rm(a,l,d){l instanceof Hi?(a.i=l,LT(a.i,a.h)):(d||(l=qi(l,OT)),a.i=new Hi(l,a.h))}function le(a,l,d){a.i.set(l,d)}function Co(a){return le(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function zi(a,l){return a?l?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function qi(a,l,d){return typeof a=="string"?(a=encodeURI(a).replace(l,kT),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function kT(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Cm=/[#\/\?@]/g,DT=/[#\?:]/g,NT=/[#\?]/g,OT=/[#\?@]/g,MT=/#/g;function Hi(a,l){this.h=this.g=null,this.i=a||null,this.j=!!l}function an(a){a.g||(a.g=new Map,a.h=0,a.i&&PT(a.i,function(l,d){a.add(decodeURIComponent(l.replace(/\+/g," ")),d)}))}n=Hi.prototype,n.add=function(a,l){an(this),this.i=null,a=Pr(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(l),this.h+=1,this};function Pm(a,l){an(a),l=Pr(a,l),a.g.has(l)&&(a.i=null,a.h-=a.g.get(l).length,a.g.delete(l))}function km(a,l){return an(a),l=Pr(a,l),a.g.has(l)}n.forEach=function(a,l){an(this),this.g.forEach(function(d,p){d.forEach(function(T){a.call(l,T,p,this)},this)},this)},n.na=function(){an(this);let a=Array.from(this.g.values()),l=Array.from(this.g.keys()),d=[];for(let p=0;p<l.length;p++){let T=a[p];for(let S=0;S<T.length;S++)d.push(l[p])}return d},n.V=function(a){an(this);let l=[];if(typeof a=="string")km(this,a)&&(l=l.concat(this.g.get(Pr(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)l=l.concat(a[d])}return l},n.set=function(a,l){return an(this),this.i=null,a=Pr(this,a),km(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[l]),this.h+=1,this},n.get=function(a,l){return a?(a=this.V(a),0<a.length?String(a[0]):l):l};function Dm(a,l,d){Pm(a,l),0<d.length&&(a.i=null,a.g.set(Pr(a,l),D(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],l=Array.from(this.g.keys());for(var d=0;d<l.length;d++){var p=l[d];let S=encodeURIComponent(String(p)),N=this.V(p);for(p=0;p<N.length;p++){var T=S;N[p]!==""&&(T+="="+encodeURIComponent(String(N[p]))),a.push(T)}}return this.i=a.join("&")};function Pr(a,l){return l=String(l),a.j&&(l=l.toLowerCase()),l}function LT(a,l){l&&!a.j&&(an(a),a.i=null,a.g.forEach(function(d,p){var T=p.toLowerCase();p!=T&&(Pm(this,p),Dm(this,T,d))},a)),a.j=l}function xT(a,l){let d=new Bi;if(c.Image){let p=new Image;p.onload=A(cn,d,"TestLoadImage: loaded",!0,l,p),p.onerror=A(cn,d,"TestLoadImage: error",!1,l,p),p.onabort=A(cn,d,"TestLoadImage: abort",!1,l,p),p.ontimeout=A(cn,d,"TestLoadImage: timeout",!1,l,p),c.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=a}else l(!1)}function VT(a,l){let d=new Bi,p=new AbortController,T=setTimeout(()=>{p.abort(),cn(d,"TestPingServer: timeout",!1,l)},1e4);fetch(a,{signal:p.signal}).then(S=>{clearTimeout(T),S.ok?cn(d,"TestPingServer: ok",!0,l):cn(d,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(T),cn(d,"TestPingServer: error",!1,l)})}function cn(a,l,d,p,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),p(d)}catch{}}function UT(){this.g=new IT}function FT(a,l,d){let p=d||"";try{Am(a,function(T,S){let N=T;h(T)&&(N=Du(T)),l.push(p+S+"="+encodeURIComponent(N))})}catch(T){throw l.push(p+"type="+encodeURIComponent("_badmap")),T}}function Wi(a){this.l=a.Ub||null,this.j=a.eb||!1}P(Wi,Nu),Wi.prototype.g=function(){return new Po(this.l,this.j)},Wi.prototype.i=(function(a){return function(){return a}})({});function Po(a,l){Oe.call(this),this.D=a,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(Po,Oe),n=Po.prototype,n.open=function(a,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=l,this.readyState=1,Ki(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(l.body=a),(this.D||c).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Gi(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ki(this)),this.g&&(this.readyState=3,Ki(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Nm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var l=a.value?a.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!a.done}))&&(this.response=this.responseText+=l)}a.done?Gi(this):Ki(this),this.readyState==3&&Nm(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Gi(this))},n.Qa=function(a){this.g&&(this.response=a,Gi(this))},n.ga=function(){this.g&&Gi(this)};function Gi(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ki(a)}n.setRequestHeader=function(a,l){this.u.append(a,l)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],l=this.h.entries();for(var d=l.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=l.next();return a.join(`\r
`)};function Ki(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Po.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Om(a){let l="";return X(a,function(d,p){l+=p,l+=":",l+=d,l+=`\r
`}),l}function $u(a,l,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=Om(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):le(a,l,d))}function fe(a){Oe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(fe,Oe);var jT=/^https?$/i,BT=["POST","PUT"];n=fe.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,l,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);l=l?l.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Lu.g(),this.v=this.o?cm(this.o):cm(Lu),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(l,String(a),!0),this.B=!1}catch(S){Mm(this,S);return}if(a=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var T in p)d.set(T,p[T]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let S of p.keys())d.set(S,p.get(S));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),T=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(BT,l,void 0))||p||T||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,N]of d)this.g.setRequestHeader(S,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Vm(this),this.u=!0,this.g.send(a),this.u=!1}catch(S){Mm(this,S)}};function Mm(a,l){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=l,a.m=5,Lm(a),ko(a)}function Lm(a){a.A||(a.A=!0,Fe(a,"complete"),Fe(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Fe(this,"complete"),Fe(this,"abort"),ko(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ko(this,!0)),fe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?xm(this):this.bb())},n.bb=function(){xm(this)};function xm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||xt(a)!=4||a.Z()!=2)){if(a.u&&xt(a)==4)im(a.Ea,0,a);else if(Fe(a,"readystatechange"),xt(a)==4){a.h=!1;try{let N=a.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var d;if(!(d=l)){var p;if(p=N===0){var T=String(a.D).match(Sm)[1]||null;!T&&c.self&&c.self.location&&(T=c.self.location.protocol.slice(0,-1)),p=!jT.test(T?T.toLowerCase():"")}d=p}if(d)Fe(a,"complete"),Fe(a,"success");else{a.m=6;try{var S=2<xt(a)?a.g.statusText:""}catch{S=""}a.l=S+" ["+a.Z()+"]",Lm(a)}}finally{ko(a)}}}}function ko(a,l){if(a.g){Vm(a);let d=a.g,p=a.v[0]?()=>{}:null;a.g=null,a.v=null,l||Fe(a,"ready");try{d.onreadystatechange=p}catch{}}}function Vm(a){a.I&&(c.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function xt(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<xt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var l=this.g.responseText;return a&&l.indexOf(a)==0&&(l=l.substring(a.length)),vT(l)}};function Um(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function $T(a){let l={};a=(a.g&&2<=xt(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<a.length;p++){if(U(a[p]))continue;var d=w(a[p]);let T=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=l[T]||[];l[T]=S,S.push(d)}E(l,function(p){return p.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ji(a,l,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||l}function Fm(a){this.Aa=0,this.i=[],this.j=new Bi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ji("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ji("baseRetryDelayMs",5e3,a),this.cb=Ji("retryDelaySeedMs",1e4,a),this.Wa=Ji("forwardChannelMaxRetries",2,a),this.wa=Ji("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Im(a&&a.concurrentRequestLimit),this.Da=new UT,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Fm.prototype,n.la=8,n.G=1,n.connect=function(a,l,d,p){je(0),this.W=a,this.H=l||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.I=Km(this,null,this.W),No(this)};function zu(a){if(jm(a),a.G==3){var l=a.U++,d=Lt(a.I);if(le(d,"SID",a.K),le(d,"RID",l),le(d,"TYPE","terminate"),Qi(a,d),l=new on(a,a.j,l),l.L=2,l.v=Co(Lt(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(l.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=l.v,d=!0),d||(l.g=Jm(l.j,null),l.g.ea(l.v)),l.F=Date.now(),Ao(l)}Gm(a)}function Do(a){a.g&&(Hu(a),a.g.cancel(),a.g=null)}function jm(a){Do(a),a.u&&(c.clearTimeout(a.u),a.u=null),Oo(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function No(a){if(!Em(a.h)&&!a.s){a.s=!0;var l=a.Ga;Oi||Xp(),Mi||(Oi(),Mi=!0),wu.add(l,a),a.B=0}}function zT(a,l){return wm(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=l.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=ji(g(a.Ga,a,l),Wm(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let T=new on(this,this.j,a),S=this.o;if(this.S&&(S?(S=y(S),I(S,this.S)):S=this.S),this.m!==null||this.O||(T.H=S,S=null),this.P)e:{for(var l=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(l+=p,4096<l){l=d;break e}if(l===4096||d===this.i.length-1){l=d+1;break e}}l=1e3}else l=1e3;l=$m(this,T,l),d=Lt(this.I),le(d,"RID",a),le(d,"CVER",22),this.D&&le(d,"X-HTTP-Session-Id",this.D),Qi(this,d),S&&(this.O?l="headers="+encodeURIComponent(String(Om(S)))+"&"+l:this.m&&$u(d,this.m,S)),Bu(this.h,T),this.Ua&&le(d,"TYPE","init"),this.P?(le(d,"$req",l),le(d,"SID","null"),T.T=!0,Vu(T,d,null)):Vu(T,d,l),this.G=2}}else this.G==3&&(a?Bm(this,a):this.i.length==0||Em(this.h)||Bm(this))};function Bm(a,l){var d;l?d=l.l:d=a.U++;let p=Lt(a.I);le(p,"SID",a.K),le(p,"RID",d),le(p,"AID",a.T),Qi(a,p),a.m&&a.o&&$u(p,a.m,a.o),d=new on(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),l&&(a.i=l.D.concat(a.i)),l=$m(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Bu(a.h,d),Vu(d,p,l)}function Qi(a,l){a.H&&X(a.H,function(d,p){le(l,p,d)}),a.l&&Am({},function(d,p){le(l,p,d)})}function $m(a,l,d){d=Math.min(a.i.length,d);var p=a.l?g(a.l.Na,a.l,a):null;e:{var T=a.i;let S=-1;for(;;){let N=["count="+d];S==-1?0<d?(S=T[0].g,N.push("ofs="+S)):S=0:N.push("ofs="+S);let ae=!0;for(let ke=0;ke<d;ke++){let ee=T[ke].g,Me=T[ke].map;if(ee-=S,0>ee)S=Math.max(0,T[ke].g-100),ae=!1;else try{FT(Me,N,"req"+ee+"_")}catch{p&&p(Me)}}if(ae){p=N.join("&");break e}}}return a=a.i.splice(0,d),l.D=a,p}function zm(a){if(!a.g&&!a.u){a.Y=1;var l=a.Fa;Oi||Xp(),Mi||(Oi(),Mi=!0),wu.add(l,a),a.v=0}}function qu(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=ji(g(a.Fa,a),Wm(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,qm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=ji(g(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,je(10),Do(this),qm(this))};function Hu(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function qm(a){a.g=new on(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var l=Lt(a.qa);le(l,"RID","rpc"),le(l,"SID",a.K),le(l,"AID",a.T),le(l,"CI",a.F?"0":"1"),!a.F&&a.ja&&le(l,"TO",a.ja),le(l,"TYPE","xmlhttp"),Qi(a,l),a.m&&a.o&&$u(l,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Co(Lt(l)),d.m=null,d.P=!0,ym(d,a)}n.Za=function(){this.C!=null&&(this.C=null,Do(this),qu(this),je(19))};function Oo(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function Hm(a,l){var d=null;if(a.g==l){Oo(a),Hu(a),a.g=null;var p=2}else if(ju(a.h,l))d=l.D,Tm(a.h,l),p=1;else return;if(a.G!=0){if(l.o)if(p==1){d=l.m?l.m.length:0,l=Date.now()-l.F;var T=a.B;p=wo(),Fe(p,new fm(p,d)),No(a)}else zm(a);else if(T=l.s,T==3||T==0&&0<l.X||!(p==1&&zT(a,l)||p==2&&qu(a)))switch(d&&0<d.length&&(l=a.h,l.i=l.i.concat(d)),T){case 1:jn(a,5);break;case 4:jn(a,10);break;case 3:jn(a,6);break;default:jn(a,2)}}}function Wm(a,l){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*l}function jn(a,l){if(a.j.info("Error code "+l),l==2){var d=g(a.fb,a),p=a.Xa;let T=!p;p=new Fn(p||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||So(p,"https"),Co(p),T?xT(p.toString(),d):VT(p.toString(),d)}else je(2);a.G=0,a.l&&a.l.sa(l),Gm(a),jm(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function Gm(a){if(a.G=0,a.ka=[],a.l){let l=bm(a.h);(l.length!=0||a.i.length!=0)&&(R(a.ka,l),R(a.ka,a.i),a.h.i.length=0,D(a.i),a.i.length=0),a.l.ra()}}function Km(a,l,d){var p=d instanceof Fn?Lt(d):new Fn(d);if(p.g!="")l&&(p.g=l+"."+p.g),Ro(p,p.s);else{var T=c.location;p=T.protocol,l=l?l+"."+T.hostname:T.hostname,T=+T.port;var S=new Fn(null);p&&So(S,p),l&&(S.g=l),T&&Ro(S,T),d&&(S.l=d),p=S}return d=a.D,l=a.ya,d&&l&&le(p,d,l),le(p,"VER",a.la),Qi(a,p),p}function Jm(a,l,d){if(l&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=a.Ca&&!a.pa?new fe(new Wi({eb:d})):new fe(a.pa),l.Ha(a.J),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qm(){}n=Qm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Mo(){}Mo.prototype.g=function(a,l){return new Ge(a,l)};function Ge(a,l){Oe.call(this),this.g=new Fm(l),this.l=a,this.h=l&&l.messageUrlParams||null,a=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(a?a["X-WebChannel-Content-Type"]=l.messageContentType:a={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(a?a["X-WebChannel-Client-Profile"]=l.va:a={"X-WebChannel-Client-Profile":l.va}),this.g.S=a,(a=l&&l.Sb)&&!U(a)&&(this.g.m=a),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!U(l)&&(this.g.D=l,a=this.h,a!==null&&l in a&&(a=this.h,l in a&&delete a[l])),this.j=new kr(this)}P(Ge,Oe),Ge.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ge.prototype.close=function(){zu(this.g)},Ge.prototype.o=function(a){var l=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=Du(a),a=d);l.i.push(new ST(l.Ya++,a)),l.G==3&&No(l)},Ge.prototype.N=function(){this.g.l=null,delete this.j,zu(this.g),delete this.g,Ge.aa.N.call(this)};function Ym(a){Ou.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var l=a.__sm__;if(l){e:{for(let d in l){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,l=l!==null&&a in l?l[a]:void 0),this.data=l}else this.data=a}P(Ym,Ou);function Xm(){Mu.call(this),this.status=1}P(Xm,Mu);function kr(a){this.g=a}P(kr,Qm),kr.prototype.ua=function(){Fe(this.g,"a")},kr.prototype.ta=function(a){Fe(this.g,new Ym(a))},kr.prototype.sa=function(a){Fe(this.g,new Xm)},kr.prototype.ra=function(){Fe(this.g,"b")},Mo.prototype.createWebChannel=Mo.prototype.g,Ge.prototype.send=Ge.prototype.o,Ge.prototype.open=Ge.prototype.m,Ge.prototype.close=Ge.prototype.close,Md=Yt.createWebChannelTransport=function(){return new Mo},Od=Yt.getStatEventTarget=function(){return wo()},Nd=Yt.Event=Vn,Ac=Yt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},To.NO_ERROR=0,To.TIMEOUT=8,To.HTTP_ERROR=6,Gs=Yt.ErrorCode=To,pm.COMPLETE="complete",Dd=Yt.EventType=pm,um.EventType=Ui,Ui.OPEN="a",Ui.CLOSE="b",Ui.ERROR="c",Ui.MESSAGE="d",Oe.prototype.listen=Oe.prototype.K,ai=Yt.WebChannel=um,kD=Yt.FetchXmlHttpFactory=Wi,fe.prototype.listenOnce=fe.prototype.L,fe.prototype.getLastError=fe.prototype.Ka,fe.prototype.getLastErrorCode=fe.prototype.Ba,fe.prototype.getStatus=fe.prototype.Z,fe.prototype.getResponseJson=fe.prototype.Oa,fe.prototype.getResponseText=fe.prototype.oa,fe.prototype.send=fe.prototype.ea,fe.prototype.setWithCredentials=fe.prototype.Ha,kd=Yt.XhrIo=fe}).apply(typeof bc<"u"?bc:typeof self<"u"?self:typeof window<"u"?window:{});var RI="@firebase/firestore",CI="4.8.0";var Ce=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ce.UNAUTHENTICATED=new Ce(null),Ce.GOOGLE_CREDENTIALS=new Ce("google-credentials-uid"),Ce.FIRST_PARTY=new Ce("first-party-uid"),Ce.MOCK_USER=new Ce("mock-user");var Ci="11.10.0";var yr=new Tt("@firebase/firestore");function ci(){return yr.logLevel}function V(n,...e){if(yr.logLevel<=Q.DEBUG){let t=e.map(Tp);yr.debug(`Firestore (${Ci}): ${n}`,...t)}}function Zt(n,...e){if(yr.logLevel<=Q.ERROR){let t=e.map(Tp);yr.error(`Firestore (${Ci}): ${n}`,...t)}}function Nn(n,...e){if(yr.logLevel<=Q.WARN){let t=e.map(Tp);yr.warn(`Firestore (${Ci}): ${n}`,...t)}}function Tp(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function j(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,IE(n,r,t)}function IE(n,e,t){let r=`FIRESTORE (${Ci}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Zt(r),new Error(r)}function oe(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||IE(e,i,r)}function H(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends Qe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var gt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Nc=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Fd=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ce.UNAUTHENTICATED))}shutdown(){}},jd=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Bd=class{constructor(e){this.t=e,this.currentUser=Ce.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){oe(this.o===void 0,42304);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new gt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new gt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new gt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(oe(typeof r.accessToken=="string",31837,{l:r}),new Nc(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string",2055,{h:e}),new Ce(e)}},$d=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ce.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},zd=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new $d(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ce.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Oc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},qd=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,We(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){oe(this.o===void 0,3512);let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Oc(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(oe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Oc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function DD(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function EE(){return new TextEncoder}var Zs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=DD(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function K(n,e){return n<e?-1:n>e?1:0}function Hd(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return K(r,i);{let s=EE(),o=ND(s.encode(PI(n,t)),s.encode(PI(e,t)));return o!==0?o:K(r,i)}}t+=r>65535?2:1}return K(n.length,e.length)}function PI(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function ND(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return K(n[t],e[t]);return K(n.length,e.length)}function mi(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var kI="__name__",Mc=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&j(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&j(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return K(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Hd(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qt.fromString(e.substring(4,e.length-2))}},de=class n extends Mc{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},OD=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xe=class n extends Mc{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return OD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===kI}static keyField(){return new n([kI])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new L(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new L(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new L(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var F=class n{constructor(e){this.path=e}static fromPath(e){return new n(de.fromString(e))}static fromName(e){return new n(de.fromString(e).popFirst(5))}static empty(){return new n(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&de.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return de.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new de(e.slice()))}};function wE(n,e,t){if(!t)throw new L(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function MD(n,e,t,r){if(e===!0&&r===!0)throw new L(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function DI(n){if(!F.isDocumentKey(n))throw new L(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function NI(n){if(F.isDocumentKey(n))throw new L(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function TE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function hu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":j(12329,{type:typeof n})}function Ze(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=hu(n);throw new L(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Te(n,e){let t={typeString:n};return e&&(t.value=e),t}function mo(n,e){if(!TE(n))throw new L(C.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new L(C.INVALID_ARGUMENT,t);return!0}var OI=-62135596800,MI=1e6,be=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*MI);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<OI)throw new L(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/MI}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(mo(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-OI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};be._jsonSchemaVersion="firestore/timestamp/1.0",be._jsonSchema={type:Te("string",be._jsonSchemaVersion),seconds:Te("number"),nanoseconds:Te("number")};var W=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new be(0,0))}static max(){return new n(new be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var eo=-1,Wd=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Wd.UNKNOWN_ID=-1;function LD(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new be(t+1,0):new be(t,r));return new _r(i,F.empty(),e)}function xD(n){return new _r(n.readTime,n.key,eo)}var _r=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),F.empty(),eo)}static max(){return new n(W.max(),F.empty(),eo)}};function VD(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:K(n.largestBatchId,e.largestBatchId))}var UD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Gd=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Pi(n){if(n.code!==C.FAILED_PRECONDITION||n.message!==UD)throw n;V("LocalStore","Unexpectedly lost primary lease")}var k=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&j(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),c=0;for(let u=0;u<s;u++){let h=u;t(e[h]).next(f=>{o[h]=f,++c,c===s&&r(o)},f=>i(f))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function FD(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ki(n){return n.name==="IndexedDbTransactionError"}var bp=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),Ap=-1;function du(n){return n==null}function to(n){return n===0&&1/n==-1/0}function jD(n){return typeof n=="number"&&Number.isInteger(n)&&!to(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var bE="";function BD(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=LI(e)),e=$D(n.get(t),e);return LI(e)}function $D(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case bE:t+="";break;default:t+=s}}return t}function LI(n){return n+bE+""}var zD="remoteDocuments",AE="owner";var SE="mutationQueues";var RE="mutations";var CE="documentMutations",qD="remoteDocumentsV14";var PE="remoteDocumentGlobal";var kE="targets";var DE="targetDocuments";var NE="targetGlobal",OE="collectionParents";var ME="clientMetadata";var LE="bundles";var xE="namedQueries";var HD="indexConfiguration";var WD="indexState";var GD="indexEntries";var VE="documentOverlays";var KD="globals";var JD=[SE,RE,CE,zD,kE,AE,NE,DE,ME,PE,OE,LE,xE],g2=[...JD,VE],QD=[SE,RE,CE,qD,kE,AE,NE,DE,ME,PE,OE,LE,xE,VE],YD=QD,XD=[...YD,HD,WD,GD];var y2=[...XD,KD];function xI(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function xn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function UE(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var me=class n{constructor(e,t){this.comparator=e,this.root=t||Ct.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ct.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ct.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new di(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new di(this.root,e,this.comparator,!1)}getReverseIterator(){return new di(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new di(this.root,e,this.comparator,!0)}},di=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ct=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw j(43730,{key:this.key,value:this.value});if(this.right.isRed())throw j(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw j(27949);return e+(this.isRed()?0:1)}};Ct.EMPTY=null,Ct.RED=!0,Ct.BLACK=!1;Ct.EMPTY=new class{constructor(){this.size=0}get key(){throw j(57766)}get value(){throw j(16141)}get color(){throw j(16727)}get left(){throw j(29726)}get right(){throw j(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ct(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Pe=class n{constructor(e){this.comparator=e,this.data=new me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Lc(this.data.getIterator())}getIteratorFrom(e){return new Lc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Lc=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var it=class n{constructor(e){this.fields=e,e.sort(Xe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Pe(Xe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mi(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var xc=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ue=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new xc("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ue.EMPTY_BYTE_STRING=new Ue("");var ZD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function en(n){if(oe(!!n,39018),typeof n=="string"){let e=0,t=ZD.exec(n);if(oe(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:he(n.seconds),nanos:he(n.nanos)}}function he(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function tn(n){return typeof n=="string"?Ue.fromBase64String(n):Ue.fromUint8Array(n)}var FE="server_timestamp",jE="__type__",BE="__previous_value__",$E="__local_write_time__";function Sp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[jE])===null||t===void 0?void 0:t.stringValue)===FE}function fu(n){let e=n.mapValue.fields[BE];return Sp(e)?fu(e):e}function no(n){let e=en(n.mapValue.fields[$E].timestampValue);return new be(e.seconds,e.nanos)}var Kd=class{constructor(e,t,r,i,s,o,c,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}},Vc="(default)",Uc=class n{constructor(e,t){this.projectId=e,this.database=t||Vc}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Vc}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Rp="__type__",zE="__max__",Sc={mapValue:{fields:{__type__:{stringValue:zE}}}},Cp="__vector__",gi="value";function On(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Sp(n)?4:HE(n)?9007199254740991:qE(n)?10:11:j(28295,{value:n})}function Dt(n,e){if(n===e)return!0;let t=On(n);if(t!==On(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return no(n).isEqual(no(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=en(i.timestampValue),c=en(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return tn(i.bytesValue).isEqual(tn(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return he(i.geoPointValue.latitude)===he(s.geoPointValue.latitude)&&he(i.geoPointValue.longitude)===he(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return he(i.integerValue)===he(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=he(i.doubleValue),c=he(s.doubleValue);return o===c?to(o)===to(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return mi(n.arrayValue.values||[],e.arrayValue.values||[],Dt);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},c=s.mapValue.fields||{};if(xI(o)!==xI(c))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Dt(o[u],c[u])))return!1;return!0})(n,e);default:return j(52216,{left:n})}}function ro(n,e){return(n.values||[]).find(t=>Dt(t,e))!==void 0}function yi(n,e){if(n===e)return 0;let t=On(n),r=On(e);if(t!==r)return K(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return K(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let c=he(s.integerValue||s.doubleValue),u=he(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return VI(n.timestampValue,e.timestampValue);case 4:return VI(no(n),no(e));case 5:return Hd(n.stringValue,e.stringValue);case 6:return(function(s,o){let c=tn(s),u=tn(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let c=s.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){let f=K(c[h],u[h]);if(f!==0)return f}return K(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let c=K(he(s.latitude),he(o.latitude));return c!==0?c:K(he(s.longitude),he(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return UI(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var c,u,h,f;let m=s.fields||{},g=o.fields||{},A=(c=m[gi])===null||c===void 0?void 0:c.arrayValue,P=(u=g[gi])===null||u===void 0?void 0:u.arrayValue,D=K(((h=A?.values)===null||h===void 0?void 0:h.length)||0,((f=P?.values)===null||f===void 0?void 0:f.length)||0);return D!==0?D:UI(A,P)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Sc.mapValue&&o===Sc.mapValue)return 0;if(s===Sc.mapValue)return 1;if(o===Sc.mapValue)return-1;let c=s.fields||{},u=Object.keys(c),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){let g=Hd(u[m],f[m]);if(g!==0)return g;let A=yi(c[u[m]],h[f[m]]);if(A!==0)return A}return K(u.length,f.length)})(n.mapValue,e.mapValue);default:throw j(23264,{le:t})}}function VI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return K(n,e);let t=en(n),r=en(e),i=K(t.seconds,r.seconds);return i!==0?i:K(t.nanos,r.nanos)}function UI(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=yi(t[i],r[i]);if(s)return s}return K(t.length,r.length)}function _i(n){return Jd(n)}function Jd(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=en(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return tn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return F.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Jd(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Jd(t.fields[o])}`;return i+"}"})(n.mapValue):j(61005,{value:n})}function Pc(n){switch(On(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=fu(n);return e?16+Pc(e):16;case 5:return 2*n.stringValue.length;case 6:return tn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+Pc(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return xn(r.fields,(s,o)=>{i+=s.length+Pc(o)}),i})(n.mapValue);default:throw j(13486,{value:n})}}function FI(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Qd(n){return!!n&&"integerValue"in n}function Pp(n){return!!n&&"arrayValue"in n}function jI(n){return!!n&&"nullValue"in n}function BI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kc(n){return!!n&&"mapValue"in n}function qE(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Rp])===null||t===void 0?void 0:t.stringValue)===Cp}function Js(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return xn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Js(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Js(n.arrayValue.values[t]);return e}return Object.assign({},n)}function HE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===zE}var v2={mapValue:{fields:{[Rp]:{stringValue:Cp},[gi]:{arrayValue:{}}}}};var Ye=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!kc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Js(t)}setAll(e){let t=Xe.emptyPath(),r={},i=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=Js(o):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());kc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];kc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){xn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Js(this.value))}};function WE(n){let e=[];return xn(n.fields,(t,r)=>{let i=new Xe([t]);if(kc(r)){let s=WE(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new it(e)}var yt=class n{constructor(e,t,r,i,s,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),Ye.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),Ye.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),Ye.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ye.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ye.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var vi=class{constructor(e,t){this.position=e,this.inclusive=t}};function $I(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=F.comparator(F.fromName(o.referenceValue),t.key):r=yi(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function zI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Dt(n.position[t],e.position[t]))return!1;return!0}var Ii=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function eN(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Fc=class{},we=class n extends Fc{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Xd(e,t,r):t==="array-contains"?new tf(e,r):t==="in"?new nf(e,r):t==="not-in"?new rf(e,r):t==="array-contains-any"?new sf(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Zd(e,r):new ef(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(yi(t,this.value)):t!==null&&On(this.value)===On(t)&&this.matchesComparison(yi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return j(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},_t=class n extends Fc{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return GE(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function GE(n){return n.op==="and"}function KE(n){return tN(n)&&GE(n)}function tN(n){for(let e of n.filters)if(e instanceof _t)return!1;return!0}function Yd(n){if(n instanceof we)return n.field.canonicalString()+n.op.toString()+_i(n.value);if(KE(n))return n.filters.map(e=>Yd(e)).join(",");{let e=n.filters.map(t=>Yd(t)).join(",");return`${n.op}(${e})`}}function JE(n,e){return n instanceof we?(function(r,i){return i instanceof we&&r.op===i.op&&r.field.isEqual(i.field)&&Dt(r.value,i.value)})(n,e):n instanceof _t?(function(r,i){return i instanceof _t&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,c)=>s&&JE(o,i.filters[c]),!0):!1})(n,e):void j(19439)}function QE(n){return n instanceof we?(function(t){return`${t.field.canonicalString()} ${t.op} ${_i(t.value)}`})(n):n instanceof _t?(function(t){return t.op.toString()+" {"+t.getFilters().map(QE).join(" ,")+"}"})(n):"Filter"}var Xd=class extends we{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){let t=F.comparator(e.key,this.key);return this.matchesComparison(t)}},Zd=class extends we{constructor(e,t){super(e,"in",t),this.keys=YE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ef=class extends we{constructor(e,t){super(e,"not-in",t),this.keys=YE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function YE(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}var tf=class extends we{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Pp(t)&&ro(t.arrayValue,this.value)}},nf=class extends we{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ro(this.value.arrayValue,t)}},rf=class extends we{constructor(e,t){super(e,"not-in",t)}matches(e){if(ro(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ro(this.value.arrayValue,t)}},sf=class extends we{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Pp(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ro(this.value.arrayValue,r))}};var of=class{constructor(e,t=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Pe=null}};function qI(n,e=null,t=[],r=[],i=null,s=null,o=null){return new of(n,e,t,r,i,s,o)}function kp(n){let e=H(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Yd(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),du(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>_i(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>_i(r)).join(",")),e.Pe=t}return e.Pe}function Dp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!eN(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!JE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!zI(n.startAt,e.startAt)&&zI(n.endAt,e.endAt)}function af(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var vr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function nN(n,e,t,r,i,s,o,c){return new vr(n,e,t,r,i,s,o,c)}function pu(n){return new vr(n)}function HI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function XE(n){return n.collectionGroup!==null}function Qs(n){let e=H(n);if(e.Te===null){e.Te=[];let t=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Pe(Xe.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Ii(s,r))}),t.has(Xe.keyField().canonicalString())||e.Te.push(new Ii(Xe.keyField(),r))}return e.Te}function Pt(n){let e=H(n);return e.Ie||(e.Ie=rN(e,Qs(n))),e.Ie}function rN(n,e){if(n.limitType==="F")return qI(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Ii(i.field,s)});let t=n.endAt?new vi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new vi(n.startAt.position,n.startAt.inclusive):null;return qI(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function cf(n,e){let t=n.filters.concat([e]);return new vr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function uf(n,e,t){return new vr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function mu(n,e){return Dp(Pt(n),Pt(e))&&n.limitType===e.limitType}function ZE(n){return`${kp(Pt(n))}|lt:${n.limitType}`}function ui(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>QE(i)).join(", ")}]`),du(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>_i(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>_i(i)).join(",")),`Target(${r})`})(Pt(n))}; limitType=${n.limitType})`}function gu(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):F.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of Qs(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){let h=$I(o,c,u);return o.inclusive?h<=0:h<0})(r.startAt,Qs(r),i)||r.endAt&&!(function(o,c,u){let h=$I(o,c,u);return o.inclusive?h>=0:h>0})(r.endAt,Qs(r),i))})(n,e)}function iN(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ew(n){return(e,t)=>{let r=!1;for(let i of Qs(n)){let s=sN(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function sN(n,e,t){let r=n.field.isKeyField()?F.comparator(e.key,t.key):(function(s,o,c){let u=o.data.field(s),h=c.data.field(s);return u!==null&&h!==null?yi(u,h):j(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return j(19790,{direction:n.dir})}}var nn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){xn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return UE(this.inner)}size(){return this.innerSize}};var oN=new me(F.comparator);function rn(){return oN}var tw=new me(F.comparator);function Ks(...n){let e=tw;for(let t of n)e=e.insert(t.key,t);return e}function nw(n){let e=tw;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function dr(){return Ys()}function rw(){return Ys()}function Ys(){return new nn(n=>n.toString(),(n,e)=>n.isEqual(e))}var aN=new me(F.comparator),cN=new Pe(F.comparator);function Y(...n){let e=cN;for(let t of n)e=e.add(t);return e}var uN=new Pe(K);function lN(){return uN}function Np(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:to(e)?"-0":e}}function iw(n){return{integerValue:""+n}}function hN(n,e){return jD(e)?iw(e):Np(n,e)}var Ei=class{constructor(){this._=void 0}};function dN(n,e,t){return n instanceof wi?(function(i,s){let o={fields:{[jE]:{stringValue:FE},[$E]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Sp(s)&&(s=fu(s)),s&&(o.fields[BE]=s),{mapValue:o}})(t,e):n instanceof Ir?ow(n,e):n instanceof Er?aw(n,e):(function(i,s){let o=sw(i,s),c=WI(o)+WI(i.Ee);return Qd(o)&&Qd(i.Ee)?iw(c):Np(i.serializer,c)})(n,e)}function fN(n,e,t){return n instanceof Ir?ow(n,e):n instanceof Er?aw(n,e):t}function sw(n,e){return n instanceof Ti?(function(r){return Qd(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var wi=class extends Ei{},Ir=class extends Ei{constructor(e){super(),this.elements=e}};function ow(n,e){let t=cw(e);for(let r of n.elements)t.some(i=>Dt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Er=class extends Ei{constructor(e){super(),this.elements=e}};function aw(n,e){let t=cw(e);for(let r of n.elements)t=t.filter(i=>!Dt(i,r));return{arrayValue:{values:t}}}var Ti=class extends Ei{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function WI(n){return he(n.integerValue||n.doubleValue)}function cw(n){return Pp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function pN(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Ir&&i instanceof Ir||r instanceof Er&&i instanceof Er?mi(r.elements,i.elements,Dt):r instanceof Ti&&i instanceof Ti?Dt(r.Ee,i.Ee):r instanceof wi&&i instanceof wi})(n.transform,e.transform)}var lf=class{constructor(e,t){this.version=e,this.transformResults=t}},Xt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Dc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var bi=class{};function uw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new io(n.key,Xt.none()):new wr(n.key,n.data,Xt.none());{let t=n.data,r=Ye.empty(),i=new Pe(Xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Nt(n.key,r,new it(i.toArray()),Xt.none())}}function mN(n,e,t){n instanceof wr?(function(i,s,o){let c=i.value.clone(),u=KI(i.fieldTransforms,s,o.transformResults);c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Nt?(function(i,s,o){if(!Dc(i.precondition,s))return void s.convertToUnknownDocument(o.version);let c=KI(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(lw(i)),u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Xs(n,e,t,r){return n instanceof wr?(function(s,o,c,u){if(!Dc(s.precondition,o))return c;let h=s.value.clone(),f=JI(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Nt?(function(s,o,c,u){if(!Dc(s.precondition,o))return c;let h=JI(s.fieldTransforms,u,o),f=o.data;return f.setAll(lw(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))})(n,e,t,r):(function(s,o,c){return Dc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function gN(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=sw(r.transform,i||null);s!=null&&(t===null&&(t=Ye.empty()),t.set(r.field,s))}return t||null}function GI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&mi(r,i,(s,o)=>pN(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var wr=class extends bi{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Nt=class extends bi{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function lw(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function KI(n,e,t){let r=new Map;oe(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,fN(o,c,t[i]))}return r}function JI(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,dN(s,o,e))}return r}var io=class extends bi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},hf=class extends bi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var df=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&mN(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Xs(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Xs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=rw();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(i.key)?null:c;let u=uw(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Y())}isEqual(e){return this.batchId===e.batchId&&mi(this.mutations,e.mutations,(t,r)=>GI(t,r))&&mi(this.baseMutations,e.baseMutations,(t,r)=>GI(t,r))}},ff=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){oe(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return aN})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var pf=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var mf=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ie,Z;function yN(n){switch(n){case C.OK:return j(64938);case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0;default:return j(15467,{code:n})}}function hw(n){if(n===void 0)return Zt("GRPC error has no .code"),C.UNKNOWN;switch(n){case Ie.OK:return C.OK;case Ie.CANCELLED:return C.CANCELLED;case Ie.UNKNOWN:return C.UNKNOWN;case Ie.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case Ie.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case Ie.INTERNAL:return C.INTERNAL;case Ie.UNAVAILABLE:return C.UNAVAILABLE;case Ie.UNAUTHENTICATED:return C.UNAUTHENTICATED;case Ie.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case Ie.NOT_FOUND:return C.NOT_FOUND;case Ie.ALREADY_EXISTS:return C.ALREADY_EXISTS;case Ie.PERMISSION_DENIED:return C.PERMISSION_DENIED;case Ie.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case Ie.ABORTED:return C.ABORTED;case Ie.OUT_OF_RANGE:return C.OUT_OF_RANGE;case Ie.UNIMPLEMENTED:return C.UNIMPLEMENTED;case Ie.DATA_LOSS:return C.DATA_LOSS;default:return j(39323,{code:n})}}(Z=Ie||(Ie={}))[Z.OK=0]="OK",Z[Z.CANCELLED=1]="CANCELLED",Z[Z.UNKNOWN=2]="UNKNOWN",Z[Z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Z[Z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Z[Z.NOT_FOUND=5]="NOT_FOUND",Z[Z.ALREADY_EXISTS=6]="ALREADY_EXISTS",Z[Z.PERMISSION_DENIED=7]="PERMISSION_DENIED",Z[Z.UNAUTHENTICATED=16]="UNAUTHENTICATED",Z[Z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Z[Z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Z[Z.ABORTED=10]="ABORTED",Z[Z.OUT_OF_RANGE=11]="OUT_OF_RANGE",Z[Z.UNIMPLEMENTED=12]="UNIMPLEMENTED",Z[Z.INTERNAL=13]="INTERNAL",Z[Z.UNAVAILABLE=14]="UNAVAILABLE",Z[Z.DATA_LOSS=15]="DATA_LOSS";var QI=null;var _N=new Qt([4294967295,4294967295],0);function YI(n){let e=EE().encode(n),t=new Pd;return t.update(e),new Uint8Array(t.digest())}function XI(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Qt([t,r],0),new Qt([i,s],0)]}var gf=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new fr(`Invalid padding: ${t}`);if(r<0)throw new fr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new fr(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Qt.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Qt.fromNumber(r)));return i.compare(_N)===1&&(i=new Qt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=YI(e),[r,i]=XI(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.fe===0)return;let t=YI(e),[r,i]=XI(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);this.we(o)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},fr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var jc=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,so.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new me(K),rn(),Y())}},so=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Y(),Y(),Y())}};var fi=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},Bc=class{constructor(e,t){this.targetId=e,this.De=t}},$c=class{constructor(e,t,r=Ue.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},zc=class{constructor(){this.ve=0,this.Ce=ZI(),this.Fe=Ue.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Y(),t=Y(),r=Y();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:j(38017,{changeType:s})}}),new so(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=ZI()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,oe(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},yf=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=rn(),this.je=Rc(),this.Je=Rc(),this.He=new me(K)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:j(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let s=i.target;if(af(s))if(r===0){let o=new F(s.path);this.Xe(t,o,yt.newNoDocument(o,W.min()))}else oe(r===1,20013,{expectedCount:r});else{let o=this.ot(t);if(o!==r){let c=this._t(e),u=c?this.ut(c,e,o):1;if(u!==0){this.rt(t);let h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,h)}QI?.ct((function(f,m,g,A,P){var D,R,O,U,B,z;let ge={localCacheCount:f,existenceFilterCount:m.count,databaseId:g.database,projectId:g.projectId},X=m.unchangedNames;return X&&(ge.bloomFilter={applied:P===0,hashCount:(D=X?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(U=(O=(R=X?.bits)===null||R===void 0?void 0:R.bitmap)===null||O===void 0?void 0:O.length)!==null&&U!==void 0?U:0,padding:(z=(B=X?.bits)===null||B===void 0?void 0:B.padding)!==null&&z!==void 0?z:0,mightContain:E=>{var y;return(y=A?.mightContain(E))!==null&&y!==void 0&&y}}),ge})(o,e.De,this.We.lt(),c,u))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,c;try{o=tn(r).toUint8Array()}catch(u){if(u instanceof xc)return Nn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new gf(o,i,s)}catch(u){return Nn(u instanceof fr?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.fe===0?null:c}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.We.lt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Xe(t,s,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((s,o)=>{let c=this.st(o);if(c){if(s.current&&af(c.target)){let u=new F(c.target.path);this.Tt(u).has(o)||this.It(o,u)||this.Xe(o,u,yt.newNoDocument(u,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}});let r=Y();this.Je.forEach((s,o)=>{let c=!0;o.forEachWhile(u=>{let h=this.st(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));let i=new jc(e,t,this.He,this.ze,r);return this.ze=rn(),this.je=Rc(),this.Je=Rc(),this.He=new me(K),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new zc,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Pe(K),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Pe(K),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new zc),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function Rc(){return new me(F.comparator)}function ZI(){return new me(F.comparator)}var vN={asc:"ASCENDING",desc:"DESCENDING"},IN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EN={and:"AND",or:"OR"},_f=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function vf(n,e){return n.useProto3Json||du(e)?e:{value:e}}function qc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function wN(n,e){return qc(n,e.toTimestamp())}function kt(n){return oe(!!n,49232),W.fromTimestamp((function(t){let r=en(t);return new be(r.seconds,r.nanos)})(n))}function Op(n,e){return If(n,e).canonicalString()}function If(n,e){let t=(function(i){return new de(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function fw(n){let e=de.fromString(n);return oe(_w(e),10190,{key:e.toString()}),e}function Ef(n,e){return Op(n.databaseId,e.path)}function Ld(n,e){let t=fw(e);if(t.get(1)!==n.databaseId.projectId)throw new L(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(mw(t))}function pw(n,e){return Op(n.databaseId,e)}function TN(n){let e=fw(n);return e.length===4?de.emptyPath():mw(e)}function wf(n){return new de(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function mw(n){return oe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function eE(n,e,t){return{name:Ef(n,e),fields:t.value.mapValue.fields}}function bN(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:j(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(h,f){return h.useProto3Json?(oe(f===void 0||typeof f=="string",58123),Ue.fromBase64String(f||"")):(oe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Ue.fromUint8Array(f||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){let f=h.code===void 0?C.UNKNOWN:hw(h.code);return new L(f,h.message||"")})(o);t=new $c(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ld(n,r.document.name),s=kt(r.document.updateTime),o=r.document.createTime?kt(r.document.createTime):W.min(),c=new Ye({mapValue:{fields:r.document.fields}}),u=yt.newFoundDocument(i,s,o,c),h=r.targetIds||[],f=r.removedTargetIds||[];t=new fi(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ld(n,r.document),s=r.readTime?kt(r.readTime):W.min(),o=yt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new fi([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ld(n,r.document),s=r.removedTargetIds||[];t=new fi([],s,i,null)}else{if(!("filter"in e))return j(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new mf(i,s),c=r.targetId;t=new Bc(c,o)}}return t}function AN(n,e){let t;if(e instanceof wr)t={update:eE(n,e.key,e.value)};else if(e instanceof io)t={delete:Ef(n,e.key)};else if(e instanceof Nt)t={update:eE(n,e.key,e.data),updateMask:MN(e.fieldMask)};else{if(!(e instanceof hf))return j(16599,{Rt:e.type});t={verify:Ef(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,o){let c=o.transform;if(c instanceof wi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ir)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Er)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ti)return{fieldPath:o.field.canonicalString(),increment:c.Ee};throw j(20930,{transform:o.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:wN(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:j(27497)})(n,e.precondition)),t}function SN(n,e){return n&&n.length>0?(oe(e!==void 0,14353),n.map(t=>(function(i,s){let o=i.updateTime?kt(i.updateTime):kt(s);return o.isEqual(W.min())&&(o=kt(s)),new lf(o,i.transformResults||[])})(t,e))):[]}function RN(n,e){return{documents:[pw(n,e.path)]}}function CN(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=pw(n,i);let s=(function(h){if(h.length!==0)return yw(_t.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(h){if(h.length!==0)return h.map(f=>(function(g){return{field:li(g.field),direction:DN(g.dir)}})(f))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=vf(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{Vt:t,parent:i}}function PN(n){let e=TN(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){oe(r===1,65062);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){let g=gw(m);return g instanceof _t&&KE(g)?g.getFilters():[g]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map(g=>(function(P){return new Ii(hi(P.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(g))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let g;return g=typeof m=="object"?m.value:m,du(g)?null:g})(t.limit));let u=null;t.startAt&&(u=(function(m){let g=!!m.before,A=m.values||[];return new vi(A,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){let g=!m.before,A=m.values||[];return new vi(A,g)})(t.endAt)),nN(e,i,o,s,c,"F",u,h)}function kN(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function gw(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=hi(t.unaryFilter.field);return we.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=hi(t.unaryFilter.field);return we.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=hi(t.unaryFilter.field);return we.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=hi(t.unaryFilter.field);return we.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return j(61313);default:return j(60726)}})(n):n.fieldFilter!==void 0?(function(t){return we.create(hi(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return j(58110);default:return j(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return _t.create(t.compositeFilter.filters.map(r=>gw(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return j(1026)}})(t.compositeFilter.op))})(n):j(30097,{filter:n})}function DN(n){return vN[n]}function NN(n){return IN[n]}function ON(n){return EN[n]}function li(n){return{fieldPath:n.canonicalString()}}function hi(n){return Xe.fromServerFormat(n.fieldPath)}function yw(n){return n instanceof we?(function(t){if(t.op==="=="){if(BI(t.value))return{unaryFilter:{field:li(t.field),op:"IS_NAN"}};if(jI(t.value))return{unaryFilter:{field:li(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(BI(t.value))return{unaryFilter:{field:li(t.field),op:"IS_NOT_NAN"}};if(jI(t.value))return{unaryFilter:{field:li(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:li(t.field),op:NN(t.op),value:t.value}}})(n):n instanceof _t?(function(t){let r=t.getFilters().map(i=>yw(i));return r.length===1?r[0]:{compositeFilter:{op:ON(t.op),filters:r}}})(n):j(54877,{filter:n})}function MN(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function _w(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var oo=class n{constructor(e,t,r,i,s=W.min(),o=W.min(),c=Ue.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Tf=class{constructor(e){this.gt=e}};function LN(n){let e=PN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?uf(e,e.limit,"L"):e}var Hc=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(he(e.integerValue));else if("doubleValue"in e){let r=he(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),to(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=en(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(tn(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?HE(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):qE(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):j(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let s=e.fields||{};this.Ct(t,53);let o=gi,c=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(he(c)),this.xt(o,t),this.Dt(s[o],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),F.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};Hc.Ut=new Hc;var bf=class{constructor(){this.Dn=new Af}addToCollectionParentIndex(e,t){return this.Dn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(_r.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(_r.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}},Af=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Pe(de.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Pe(de.comparator)).toArray()}};var I2=new Uint8Array(0);var tE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vw=41943040,rt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};rt.DEFAULT_COLLECTION_PERCENTILE=10,rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rt.DEFAULT=new rt(vw,rt.DEFAULT_COLLECTION_PERCENTILE,rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rt.DISABLED=new rt(-1,0,0);var ao=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var nE="LruGarbageCollector",xN=1048576;function rE([n,e],[t,r]){let i=K(n,t);return i===0?K(e,r):i}var Sf=class{constructor(e){this.Tr=e,this.buffer=new Pe(rE),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();rE(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Rf=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){V(nE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ki(t)?V(nE,"Ignoring IndexedDB error during garbage collection: ",t):await Pi(t)}await this.Rr(3e5)})}},Cf=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return k.resolve(bp.ue);let r=new Sf(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(tE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),tE):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,o,c,u,h,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,c=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(h=Date.now(),ci()<=Q.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${s} targets in `+(u-c)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}};function VN(n,e){return new Cf(n,e)}var Pf=class{constructor(){this.changes=new nn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var kf=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Df=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Xs(r.mutation,i,it.empty(),be.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Y()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Y()){let i=dr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Ks();return s.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=dr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Y()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,r,i){let s=rn(),o=Ys(),c=(function(){return Ys()})();return t.forEach((u,h)=>{let f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof Nt)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),Xs(f.mutation,h,f.mutation.getFieldMask(),be.now())):o.set(h.key,it.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,f)=>o.set(h,f)),t.forEach((h,f)=>{var m;return c.set(h,new kf(f,(m=o.get(h))!==null&&m!==void 0?m:null))}),c))}recalculateAndSaveOverlays(e,t){let r=Ys(),i=new me((o,c)=>o-c),s=Y();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let c of o)c.keys().forEach(u=>{let h=t.get(u);if(h===null)return;let f=r.get(u)||it.empty();f=c.applyToLocalView(h,f),r.set(u,f);let m=(i.get(c.batchId)||Y()).add(u);i=i.insert(c.batchId,m)})}).next(()=>{let o=[],c=i.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),h=u.key,f=u.value,m=rw();f.forEach(g=>{if(!s.has(g)){let A=uw(t.get(g),r.get(g));A!==null&&m.set(g,A),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return k.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return F.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):XE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):k.resolve(dr()),c=eo,u=s;return o.next(h=>k.forEach(h,(f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),s.get(f)?k.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,Y())).next(f=>({batchId:c,changes:nw(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=Ks();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Ks();return this.indexManager.getCollectionParents(e,s).next(c=>k.forEach(c,u=>{let h=(function(m,g){return new vr(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,h)=>{let f=h.getKey();o.get(f)===null&&(o=o.insert(f,yt.newInvalidDocument(f)))});let c=Ks();return o.forEach((u,h)=>{let f=s.get(u);f!==void 0&&Xs(f.mutation,h,it.empty(),be.now()),gu(t,h)&&(c=c.insert(u,h))}),c})}};var Nf=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return k.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:kt(i.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:LN(i.bundledQuery),readTime:kt(i.readTime)}})(t)),k.resolve()}};var Of=class{constructor(){this.overlays=new me(F.comparator),this.kr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){let r=dr();return k.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.wt(e,t,s)}),k.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){let i=dr(),s=t.length+1,o=new F(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return k.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new me((h,f)=>h-f),o=this.overlays.getIterator();for(;o.hasNext();){let h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=dr(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}let c=dr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return k.resolve(c)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new pf(t,r));let s=this.kr.get(t);s===void 0&&(s=Y(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}};var Mf=class{constructor(){this.sessionToken=Ue.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}};var co=class{constructor(){this.qr=new Pe(Ee.Qr),this.$r=new Pe(Ee.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new Ee(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Ee(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new F(new de([])),r=new Ee(t,e),i=new Ee(t,e+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new F(new de([])),r=new Ee(t,e),i=new Ee(t,e+1),s=Y();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ee(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ee=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return F.comparator(e.key,t.key)||K(e.Hr,t.Hr)}static Ur(e,t){return K(e.Hr,t.Hr)||F.comparator(e.key,t.key)}};var Lf=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Pe(Ee.Qr)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new df(s,t,r,i);this.mutationQueue.push(o);for(let c of i)this.Yr=this.Yr.add(new Ee(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,t){return k.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?Ap:this.er-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ee(t,0),i=new Ee(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{let c=this.Zr(o.Hr);s.push(c)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pe(K);return t.forEach(i=>{let s=new Ee(i,0),o=new Ee(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],c=>{r=r.add(c.Hr)})}),k.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;F.isDocumentKey(s)||(s=s.child(""));let o=new Ee(new F(s),0),c=new Pe(K);return this.Yr.forEachWhile(u=>{let h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Hr)),!0)},o),k.resolve(this.ei(c))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){oe(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return k.forEach(t.mutations,i=>{let s=new Ee(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new Ee(t,0),i=this.Yr.firstAfterOrEqual(r);return k.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var xf=class{constructor(e){this.ni=e,this.docs=(function(){return new me(F.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():yt.newInvalidDocument(t))}getEntries(e,t){let r=rn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=rn(),o=t.path,c=new F(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||VD(xD(f),r)<=0||(i.has(f.key)||gu(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return k.resolve(s)}getAllFromCollectionGroup(e,t,r,i){j(9500)}ri(e,t){return k.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Vf(this)}getSize(e){return k.resolve(this.size)}},Vf=class extends Pf{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),k.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var Uf=class{constructor(e){this.persistence=e,this.ii=new nn(t=>kp(t),Dp),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.si=0,this.oi=new co,this.targetCount=0,this._i=ao.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),k.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new ao(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.hr(t),k.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ii.forEach((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),k.waitFor(s).next(()=>i)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),k.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this.oi.containsKey(t))}};var Wc=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new bp(0),this.ci=!1,this.ci=!0,this.li=new Mf,this.referenceDelegate=e(this),this.hi=new Uf(this),this.indexManager=new bf,this.remoteDocumentCache=(function(i){return new xf(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new Tf(t),this.Ti=new Nf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Of,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new Lf(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new Ff(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return k.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},Ff=class extends Gd{constructor(e){super(),this.currentSequenceNumber=e}},jf=class n{constructor(e){this.persistence=e,this.Ai=new co,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw j(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.mi,r=>{let i=F.fromPath(r);return this.fi(e,i).next(s=>{s||t.removeEntry(i,W.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return k.or([()=>k.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Gc=class n{constructor(e,t){this.persistence=e,this.gi=new nn(r=>BD(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=VN(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return k.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?k.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,t).next(c=>{c||(r++,s.removeEntry(o,W.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),k.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Pc(e.data.value)),t}Sr(e,t,r){return k.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return k.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Bf=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=Y(),i=Y();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var $f=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var zf=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return f_()?8:FD(Re())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ps(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $f;return this.ws(e,t,o).next(c=>{if(s.result=c,this.Rs)return this.Ss(e,t,o,c.size)})}).next(()=>s.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(ci()<=Q.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",ui(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),k.resolve()):(ci()<=Q.DEBUG&&V("QueryEngine","Query:",ui(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(ci()<=Q.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",ui(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pt(t))):k.resolve())}ps(e,t){if(HI(t))return k.resolve(null);let r=Pt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=uf(t,null,"F"),r=Pt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Y(...s);return this.gs.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{let h=this.bs(t,c);return this.Ds(t,h,o,u.readTime)?this.ps(e,uf(t,null,"F")):this.vs(e,h,t,u)}))})))}ys(e,t,r,i){return HI(t)||i.isEqual(W.min())?k.resolve(null):this.gs.getDocuments(e,r).next(s=>{let o=this.bs(t,s);return this.Ds(t,o,r,i)?k.resolve(null):(ci()<=Q.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ui(t)),this.vs(e,o,t,LD(i,eo)).next(c=>c))})}bs(e,t){let r=new Pe(ew(e));return t.forEach((i,s)=>{gu(e,s)&&(r=r.add(s))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return ci()<=Q.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",ui(t)),this.gs.getDocumentsMatchingQuery(e,t,_r.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Mp="LocalStore",UN=3e8,qf=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new me(K),this.Ms=new nn(s=>kp(s),Dp),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Df(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function FN(n,e,t,r){return new qf(n,e,t,r)}async function Iw(n,e){let t=H(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],c=[],u=Y();for(let h of i){o.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}for(let h of s){c.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(r,u).next(h=>({Bs:h,removedBatchIds:o,addedBatchIds:c}))})})}function jN(n,e){let t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(c,u,h,f){let m=h.batch,g=m.keys(),A=k.resolve();return g.forEach(P=>{A=A.next(()=>f.getEntry(u,P)).next(D=>{let R=h.docVersions.get(P);oe(R!==null,48541),D.version.compareTo(R)<0&&(m.applyToRemoteDocument(D,h),D.isValidDocument()&&(D.setReadTime(h.commitVersion),f.addEntry(D)))})}),A.next(()=>c.mutationQueue.removeMutationBatch(u,m))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=Y();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Ew(n){let e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function BN(n,e){let t=H(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let c=[];e.targetChanges.forEach((f,m)=>{let g=i.get(m);if(!g)return;c.push(t.hi.removeMatchingKeys(s,f.removedDocuments,m).next(()=>t.hi.addMatchingKeys(s,f.addedDocuments,m)));let A=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?A=A.withResumeToken(Ue.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):f.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(f.resumeToken,r)),i=i.insert(m,A),(function(D,R,O){return D.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=UN?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0})(g,A,f)&&c.push(t.hi.updateTargetData(s,A))});let u=rn(),h=Y();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),c.push($N(s,o,e.documentUpdates).next(f=>{u=f.Ls,h=f.ks})),!r.isEqual(W.min())){let f=t.hi.getLastRemoteSnapshotVersion(s).next(m=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(f)}return k.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(t.Fs=i,s))}function $N(n,e,t){let r=Y(),i=Y();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=rn();return t.forEach((c,u)=>{let h=s.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(W.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):V(Mp,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Ls:o,ks:i}})}function zN(n,e){let t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Ap),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function qN(n,e){let t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(s=>s?(i=s,k.resolve(i)):t.hi.allocateTargetId(r).next(o=>(i=new oo(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}async function Hf(n,e,t){let r=H(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ki(o))throw o;V(Mp,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function iE(n,e,t){let r=H(n),i=W.min(),s=Y();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(u,h,f){let m=H(u),g=m.Ms.get(f);return g!==void 0?k.resolve(m.Fs.get(g)):m.hi.getTargetData(h,f)})(r,o,Pt(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{s=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:W.min(),t?s:Y())).next(c=>(HN(r,iN(e),c),{documents:c,qs:s})))}function HN(n,e,t){let r=n.xs.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.xs.set(e,r)}var Kc=class{constructor(){this.activeTargetIds=lN()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Wf=class{constructor(){this.Fo=new Kc,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Kc,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Gf=class{xo(e){}shutdown(){}};var sE="ConnectivityMonitor",Jc=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){V(sE,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){V(sE,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Cc=null;function Kf(){return Cc===null?Cc=(function(){return 268435456+Math.round(2147483648*Math.random())})():Cc++,"0x"+Cc.toString(16)}var xd="RestConnection",WN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Jf=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Vc?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let o=Kf(),c=this.Go(e,t.toUriEncodedString());V(xd,`Sending RPC '${e}' ${o}:`,c,r);let u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,i,s);let{host:h}=new URL(c),f=gn(h);return this.jo(e,c,u,r,f).then(m=>(V(xd,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Nn(xd,`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",r),m})}Jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ci})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,t){let r=WN[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var Qf=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var Ve="WebChannelConnection",Yf=class extends Jf{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){let o=Kf();return new Promise((c,u)=>{let h=new kd;h.setWithCredentials(!0),h.listenOnce(Dd.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Gs.NO_ERROR:let m=h.getResponseJson();V(Ve,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),c(m);break;case Gs.TIMEOUT:V(Ve,`RPC '${e}' ${o} timed out`),u(new L(C.DEADLINE_EXCEEDED,"Request time out"));break;case Gs.HTTP_ERROR:let g=h.getStatus();if(V(Ve,`RPC '${e}' ${o} failed with status:`,g,"response text:",h.getResponseText()),g>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);let P=A?.error;if(P&&P.status&&P.message){let D=(function(O){let U=O.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(U)>=0?U:C.UNKNOWN})(P.status);u(new L(D,P.message))}else u(new L(C.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new L(C.UNAVAILABLE,"Connection failed."));break;default:j(9055,{c_:e,streamId:o,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{V(Ve,`RPC '${e}' ${o} completed.`)}});let f=JSON.stringify(i);V(Ve,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",f,r,15)})}P_(e,t,r){let i=Kf(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Md(),c=Od(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let f=s.join("");V(Ve,`Creating RPC '${e}' stream ${i}: ${f}`,u);let m=o.createWebChannel(f,u);this.T_(m);let g=!1,A=!1,P=new Qf({Ho:R=>{A?V(Ve,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(g||(V(Ve,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),V(Ve,`RPC '${e}' stream ${i} sending:`,R),m.send(R))},Yo:()=>m.close()}),D=(R,O,U)=>{R.listen(O,B=>{try{U(B)}catch(z){setTimeout(()=>{throw z},0)}})};return D(m,ai.EventType.OPEN,()=>{A||(V(Ve,`RPC '${e}' stream ${i} transport opened.`),P.s_())}),D(m,ai.EventType.CLOSE,()=>{A||(A=!0,V(Ve,`RPC '${e}' stream ${i} transport closed`),P.__(),this.I_(m))}),D(m,ai.EventType.ERROR,R=>{A||(A=!0,Nn(Ve,`RPC '${e}' stream ${i} transport errored. Name:`,R.name,"Message:",R.message),P.__(new L(C.UNAVAILABLE,"The operation could not be completed")))}),D(m,ai.EventType.MESSAGE,R=>{var O;if(!A){let U=R.data[0];oe(!!U,16349);let B=U,z=B?.error||((O=B[0])===null||O===void 0?void 0:O.error);if(z){V(Ve,`RPC '${e}' stream ${i} received error:`,z);let ge=z.status,X=(function(v){let I=Ie[v];if(I!==void 0)return hw(I)})(ge),E=z.message;X===void 0&&(X=C.INTERNAL,E="Unknown error status: "+ge+" with message "+z.message),A=!0,P.__(new L(X,E)),m.close()}else V(Ve,`RPC '${e}' stream ${i} received:`,U),P.a_(U)}}),D(c,Nd.STAT_EVENT,R=>{R.stat===Ac.PROXY?V(Ve,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Ac.NOPROXY&&V(Ve,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.o_()},0),P}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function Vd(){return typeof document<"u"?document:null}function yu(n){return new _f(n,!0)}var Qc=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var oE="PersistentStream",Yc=class{constructor(e,t,r,i,s,o,c,u){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Qc(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(Zt(t.toString()),Zt("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new L(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return V(oE,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(V(oE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Xf=class extends Yc{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=bN(this.serializer,e),r=(function(s){if(!("targetChange"in s))return W.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?W.min():o.readTime?kt(o.readTime):W.min()})(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=wf(this.serializer),t.addTarget=(function(s,o){let c,u=o.target;if(c=af(u)?{documents:RN(s,u)}:{query:CN(s,u).Vt},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=dw(s,o.resumeToken);let h=vf(s,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(W.min())>0){c.readTime=qc(s,o.snapshotVersion.toTimestamp());let h=vf(s,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);let r=kN(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=wf(this.serializer),t.removeTarget=e,this.k_(t)}},Zf=class extends Yc{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=SN(e.writeResults,e.commitTime),r=kt(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=wf(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>AN(this.serializer,r))};this.k_(t)}};var ep=class{},tp=class extends ep{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new L(C.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,If(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(C.UNKNOWN,s.toString())})}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Jo(e,If(t,r),i,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(C.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},np=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Zt(t),this._a=!1):V("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var Tr="RemoteStore",rp=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Ar(this)&&(V(Tr,"Restarting streams for network reachability change."),await(async function(u){let h=H(u);h.Ia.add(4),await go(h),h.Aa.set("Unknown"),h.Ia.delete(4),await _u(h)})(this))})}),this.Aa=new np(r,i)}};async function _u(n){if(Ar(n))for(let e of n.da)await e(!0)}async function go(n){for(let e of n.da)await e(!1)}function ww(n,e){let t=H(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Up(t)?Vp(t):Di(t).x_()&&xp(t,e))}function Lp(n,e){let t=H(n),r=Di(t);t.Ta.delete(e),r.x_()&&Tw(t,e),t.Ta.size===0&&(r.x_()?r.B_():Ar(t)&&t.Aa.set("Unknown"))}function xp(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Di(n).H_(e)}function Tw(n,e){n.Ra.$e(e),Di(n).Y_(e)}function Vp(n){n.Ra=new yf({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Di(n).start(),n.Aa.aa()}function Up(n){return Ar(n)&&!Di(n).M_()&&n.Ta.size>0}function Ar(n){return H(n).Ia.size===0}function bw(n){n.Ra=void 0}async function GN(n){n.Aa.set("Online")}async function KN(n){n.Ta.forEach((e,t)=>{xp(n,e)})}async function JN(n,e){bw(n),Up(n)?(n.Aa.la(e),Vp(n)):n.Aa.set("Unknown")}async function QN(n,e,t){if(n.Aa.set("Online"),e instanceof $c&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let c of s.targetIds)i.Ta.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ta.delete(c),i.Ra.removeTarget(c))})(n,e)}catch(r){V(Tr,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Xc(n,r)}else if(e instanceof fi?n.Ra.Ye(e):e instanceof Bc?n.Ra.it(e):n.Ra.et(e),!t.isEqual(W.min()))try{let r=await Ew(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let c=s.Ra.Pt(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){let f=s.Ta.get(h);f&&s.Ta.set(h,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{let f=s.Ta.get(u);if(!f)return;s.Ta.set(u,f.withResumeToken(Ue.EMPTY_BYTE_STRING,f.snapshotVersion)),Tw(s,u);let m=new oo(f.target,u,h,f.sequenceNumber);xp(s,m)}),s.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){V(Tr,"Failed to raise snapshot:",r),await Xc(n,r)}}async function Xc(n,e,t){if(!ki(e))throw e;n.Ia.add(1),await go(n),n.Aa.set("Offline"),t||(t=()=>Ew(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{V(Tr,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await _u(n)})}function Aw(n,e){return e().catch(t=>Xc(n,t,e))}async function vu(n){let e=H(n),t=Mn(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Ap;for(;YN(e);)try{let i=await zN(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,XN(e,i)}catch(i){await Xc(e,i)}Sw(e)&&Rw(e)}function YN(n){return Ar(n)&&n.Pa.length<10}function XN(n,e){n.Pa.push(e);let t=Mn(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Sw(n){return Ar(n)&&!Mn(n).M_()&&n.Pa.length>0}function Rw(n){Mn(n).start()}async function ZN(n){Mn(n).na()}async function eO(n){let e=Mn(n);for(let t of n.Pa)e.X_(t.mutations)}async function tO(n,e,t){let r=n.Pa.shift(),i=ff.from(r,e,t);await Aw(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await vu(n)}async function nO(n,e){e&&Mn(n).Z_&&await(async function(r,i){if((function(o){return yN(o)&&o!==C.ABORTED})(i.code)){let s=r.Pa.shift();Mn(r).N_(),await Aw(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await vu(r)}})(n,e),Sw(n)&&Rw(n)}async function aE(n,e){let t=H(n);t.asyncQueue.verifyOperationInProgress(),V(Tr,"RemoteStore received new credentials");let r=Ar(t);t.Ia.add(3),await go(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await _u(t)}async function rO(n,e){let t=H(n);e?(t.Ia.delete(2),await _u(t)):e||(t.Ia.add(2),await go(t),t.Aa.set("Unknown"))}function Di(n){return n.Va||(n.Va=(function(t,r,i){let s=H(t);return s.ia(),new Xf(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:GN.bind(null,n),e_:KN.bind(null,n),n_:JN.bind(null,n),J_:QN.bind(null,n)}),n.da.push(async e=>{e?(n.Va.N_(),Up(n)?Vp(n):n.Aa.set("Unknown")):(await n.Va.stop(),bw(n))})),n.Va}function Mn(n){return n.ma||(n.ma=(function(t,r,i){let s=H(t);return s.ia(),new Zf(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:ZN.bind(null,n),n_:nO.bind(null,n),ea:eO.bind(null,n),ta:tO.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await vu(n)):(await n.ma.stop(),n.Pa.length>0&&(V(Tr,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}var ip=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new gt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,c=new n(e,t,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Fp(n,e){if(Zt("AsyncQueue",`${e}: ${n}`),ki(n))return new L(C.UNAVAILABLE,`${e}: ${n}`);throw n}var Zc=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=Ks(),this.sortedSet=new me(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var eu=class{constructor(){this.fa=new me(F.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):j(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},Ai=class n{constructor(e,t,r,i,s,o,c,u,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new n(e,t,Zc.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var sp=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},op=class{constructor(){this.queries=cE(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=H(t),s=i.queries;i.queries=cE(),s.forEach((o,c)=>{for(let u of c.wa)u.onError(r)})})(this,new L(C.ABORTED,"Firestore shutting down"))}};function cE(){return new nn(n=>ZE(n),mu)}async function jp(n,e){let t=H(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new sp,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await t.onListen(i,!0);break;case 1:s.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let c=Fp(o,`Initialization of query '${ui(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&$p(t)}async function Bp(n,e){let t=H(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function iO(n,e){let t=H(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let c of o.wa)c.Ca(i)&&(r=!0);o.ya=i}}r&&$p(t)}function sO(n,e,t){let r=H(n),i=r.queries.get(e);if(i)for(let s of i.wa)s.onError(t);r.queries.delete(e)}function $p(n){n.Da.forEach(e=>{e.next()})}var ap,uE;(uE=ap||(ap={})).Fa="default",uE.Cache="cache";var uo=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ai(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Ai.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==ap.Cache}};var tu=class{constructor(e){this.key=e}},nu=class{constructor(e){this.key=e}},cp=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Y(),this.mutatedKeys=Y(),this.Xa=ew(e),this.eu=new Zc(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new eu,i=t?t.eu:this.eu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{let g=i.get(f),A=gu(this.query,m)?m:null,P=!!g&&this.mutatedKeys.has(g.key),D=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations),R=!1;g&&A?g.data.isEqual(A.data)?P!==D&&(r.track({type:3,doc:A}),R=!0):this.iu(g,A)||(r.track({type:2,doc:A}),R=!0,(u&&this.Xa(A,u)>0||h&&this.Xa(A,h)<0)&&(c=!0)):!g&&A?(r.track({type:0,doc:A}),R=!0):g&&!A&&(r.track({type:1,doc:g}),R=!0,(u||h)&&(c=!0)),R&&(A?(o=o.add(A),s=D?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{eu:o,ru:r,Ds:c,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let o=e.ru.pa();o.sort((f,m)=>(function(A,P){let D=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j(20277,{At:R})}};return D(A)-D(P)})(f.type,m.type)||this.Xa(f.doc,m.doc)),this.su(r),i=i!=null&&i;let c=t&&!i?this.ou():[],u=this.Za.size===0&&this.current&&!i?1:0,h=u!==this.Ya;return this.Ya=u,o.length!==0||h?{snapshot:new Ai(this.query,e.eu,s,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:c}:{_u:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new eu,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=Y(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new nu(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new tu(r))}),t}uu(e){this.Ha=e.qs,this.Za=Y();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Ai.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},zp="SyncEngine",up=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},lp=class{constructor(e){this.key=e,this.lu=!1}},hp=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new nn(c=>ZE(c),mu),this.Tu=new Map,this.Iu=new Set,this.du=new me(F.comparator),this.Eu=new Map,this.Au=new co,this.Ru={},this.Vu=new Map,this.mu=ao.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};async function oO(n,e,t=!0){let r=Ow(n),i,s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await Cw(r,e,t,!0),i}async function aO(n,e){let t=Ow(n);await Cw(t,e,!0,!1)}async function Cw(n,e,t,r){let i=await qN(n.localStore,Pt(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=await cO(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&ww(n.remoteStore,i),c}async function cO(n,e,t,r,i){n.gu=(m,g,A)=>(async function(D,R,O,U){let B=R.view.nu(O);B.Ds&&(B=await iE(D.localStore,R.query,!1).then(({documents:E})=>R.view.nu(E,B)));let z=U&&U.targetChanges.get(R.targetId),ge=U&&U.targetMismatches.get(R.targetId)!=null,X=R.view.applyChanges(B,D.isPrimaryClient,z,ge);return hE(D,R.targetId,X._u),X.snapshot})(n,m,g,A);let s=await iE(n.localStore,e,!0),o=new cp(e,s.qs),c=o.nu(s.documents),u=so.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=o.applyChanges(c,n.isPrimaryClient,u);hE(n,t,h._u);let f=new up(e,t,o);return n.Pu.set(e,f),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),h.snapshot}async function uO(n,e,t){let r=H(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!mu(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Hf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Lp(r.remoteStore,i.targetId),dp(r,i.targetId)}).catch(Pi)):(dp(r,i.targetId),await Hf(r.localStore,i.targetId,!0))}async function lO(n,e){let t=H(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Lp(t.remoteStore,r.targetId))}async function hO(n,e,t){let r=_O(n);try{let i=await(function(o,c){let u=H(o),h=be.now(),f=c.reduce((A,P)=>A.add(P.key),Y()),m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",A=>{let P=rn(),D=Y();return u.Os.getEntries(A,f).next(R=>{P=R,P.forEach((O,U)=>{U.isValidDocument()||(D=D.add(O))})}).next(()=>u.localDocuments.getOverlayedDocuments(A,P)).next(R=>{m=R;let O=[];for(let U of c){let B=gN(U,m.get(U.key).overlayedDocument);B!=null&&O.push(new Nt(U.key,B,WE(B.value.mapValue),Xt.exists(!0)))}return u.mutationQueue.addMutationBatch(A,h,O,c)}).next(R=>{g=R;let O=R.applyToLocalDocumentSet(m,D);return u.documentOverlayCache.saveOverlays(A,R.batchId,O)})}).then(()=>({batchId:g.batchId,changes:nw(m)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let h=o.Ru[o.currentUser.toKey()];h||(h=new me(K)),h=h.insert(c,u),o.Ru[o.currentUser.toKey()]=h})(r,i.batchId,t),await yo(r,i.changes),await vu(r.remoteStore)}catch(i){let s=Fp(i,"Failed to persist write");t.reject(s)}}async function Pw(n,e){let t=H(n);try{let r=await BN(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Eu.get(s);o&&(oe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?oe(o.lu,14607):i.removedDocuments.size>0&&(oe(o.lu,42227),o.lu=!1))}),await yo(t,r,e)}catch(r){await Pi(r)}}function lE(n,e,t){let r=H(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((s,o)=>{let c=o.view.va(e);c.snapshot&&i.push(c.snapshot)}),(function(o,c){let u=H(o);u.onlineState=c;let h=!1;u.queries.forEach((f,m)=>{for(let g of m.wa)g.va(c)&&(h=!0)}),h&&$p(u)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function dO(n,e,t){let r=H(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),s=i&&i.key;if(s){let o=new me(F.comparator);o=o.insert(s,yt.newNoDocument(s,W.min()));let c=Y().add(s),u=new jc(W.min(),new Map,new me(K),o,c);await Pw(r,u),r.du=r.du.remove(s),r.Eu.delete(e),qp(r)}else await Hf(r.localStore,e,!1).then(()=>dp(r,e,t)).catch(Pi)}async function fO(n,e){let t=H(n),r=e.batch.batchId;try{let i=await jN(t.localStore,e);Dw(t,r,null),kw(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await yo(t,i)}catch(i){await Pi(i)}}async function pO(n,e,t){let r=H(n);try{let i=await(function(o,c){let u=H(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(m=>(oe(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})})(r.localStore,e);Dw(r,e,t),kw(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await yo(r,i)}catch(i){await Pi(i)}}function kw(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function Dw(n,e,t){let r=H(n),i=r.Ru[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function dp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||Nw(n,r)})}function Nw(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(Lp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),qp(n))}function hE(n,e,t){for(let r of t)r instanceof tu?(n.Au.addReference(r.key,e),mO(n,r)):r instanceof nu?(V(zp,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||Nw(n,r.key)):j(19791,{yu:r})}function mO(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(V(zp,"New document in limbo: "+t),n.Iu.add(r),qp(n))}function qp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new F(de.fromString(e)),r=n.mu.next();n.Eu.set(r,new lp(t)),n.du=n.du.insert(t,r),ww(n.remoteStore,new oo(Pt(pu(t.path)),r,"TargetPurposeLimboResolution",bp.ue))}}async function yo(n,e,t){let r=H(n),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((c,u)=>{o.push(r.gu(u,e,t).then(h=>{var f;if((h||t)&&r.isPrimaryClient){let m=h?!h.fromCache:(f=t?.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(h){i.push(h);let m=Bf.Es(u.targetId,h);s.push(m)}}))}),await Promise.all(o),r.hu.J_(i),await(async function(u,h){let f=H(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>k.forEach(h,g=>k.forEach(g.Is,A=>f.persistence.referenceDelegate.addReference(m,g.targetId,A)).next(()=>k.forEach(g.ds,A=>f.persistence.referenceDelegate.removeReference(m,g.targetId,A)))))}catch(m){if(!ki(m))throw m;V(Mp,"Failed to update sequence numbers: "+m)}for(let m of h){let g=m.targetId;if(!m.fromCache){let A=f.Fs.get(g),P=A.snapshotVersion,D=A.withLastLimboFreeSnapshotVersion(P);f.Fs=f.Fs.insert(g,D)}}})(r.localStore,s))}async function gO(n,e){let t=H(n);if(!t.currentUser.isEqual(e)){V(zp,"User change. New user:",e.toKey());let r=await Iw(t.localStore,e);t.currentUser=e,(function(s,o){s.Vu.forEach(c=>{c.forEach(u=>{u.reject(new L(C.CANCELLED,o))})}),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await yo(t,r.Bs)}}function yO(n,e){let t=H(n),r=t.Eu.get(e);if(r&&r.lu)return Y().add(r.key);{let i=Y(),s=t.Tu.get(e);if(!s)return i;for(let o of s){let c=t.Pu.get(o);i=i.unionWith(c.view.tu)}return i}}function Ow(n){let e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Pw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dO.bind(null,e),e.hu.J_=iO.bind(null,e.eventManager),e.hu.pu=sO.bind(null,e.eventManager),e}function _O(n){let e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pO.bind(null,e),e}var Mw=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=yu(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,r){return null}Fu(t,r){return null}vu(t){return FN(this.persistence,new zf,t.initialUser,this.serializer)}Du(t){return new Wc(jf.Vi,this.serializer)}bu(t){return new Wf}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),fp=class extends Mw{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){oe(this.persistence.referenceDelegate instanceof Gc,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Rf(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?rt.withCacheSize(this.cacheSizeBytes):rt.DEFAULT;return new Wc(r=>Gc.Vi(r,t),this.serializer)}};var vO=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>lE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=gO.bind(null,this.syncEngine),await rO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new op})()}createDatastore(t){let r=yu(t.databaseInfo.databaseId),i=(function(o){return new Yf(o)})(t.databaseInfo);return(function(o,c,u,h){return new tp(o,c,u,h)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,c,u){return new rp(i,s,o,c,u)})(this.localStore,this.datastore,t.asyncQueue,r=>lE(this.syncEngine,r,0),(function(){return Jc.C()?new Jc:new Gf})())}createSyncEngine(t,r){return(function(s,o,c,u,h,f,m){let g=new hp(s,o,c,u,h,f);return m&&(g.fu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await(async function(s){let o=H(s);V(Tr,"RemoteStore shutting down."),o.Ia.add(5),await go(o),o.Ea.shutdown(),o.Aa.set("Unknown")})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}return n.provider={build:()=>new n},n})();var lo=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Zt("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Ln="FirestoreClient",pp=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ce.UNAUTHENTICATED,this.clientId=Zs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{V(Ln,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(V(Ln,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new gt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Fp(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Ud(n,e){n.asyncQueue.verifyOperationInProgress(),V(Ln,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Iw(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{Nn("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{V("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Nn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e}async function dE(n,e){n.asyncQueue.verifyOperationInProgress();let t=await IO(n);V(Ln,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>aE(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>aE(e.remoteStore,i)),n._onlineComponents=e}async function IO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(Ln,"Using user provided OfflineComponentProvider");try{await Ud(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===C.FAILED_PRECONDITION||i.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Nn("Error using user provided cache. Falling back to memory cache: "+t),await Ud(n,new Mw)}}else V(Ln,"Using default OfflineComponentProvider"),await Ud(n,new fp(void 0));return n._offlineComponents}async function Lw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(Ln,"Using user provided OnlineComponentProvider"),await dE(n,n._uninitializedComponentsProvider._online)):(V(Ln,"Using default OnlineComponentProvider"),await dE(n,new vO))),n._onlineComponents}function EO(n){return Lw(n).then(e=>e.syncEngine)}async function ru(n){let e=await Lw(n),t=e.eventManager;return t.onListen=oO.bind(null,e.syncEngine),t.onUnlisten=uO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=lO.bind(null,e.syncEngine),t}function wO(n,e,t={}){let r=new gt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,c,u,h){let f=new lo({next:g=>{f.Ou(),o.enqueueAndForget(()=>Bp(s,m));let A=g.docs.has(c);!A&&g.fromCache?h.reject(new L(C.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&g.fromCache&&u&&u.source==="server"?h.reject(new L(C.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new uo(pu(c.path),f,{includeMetadataChanges:!0,ka:!0});return jp(s,m)})(await ru(n),n.asyncQueue,e,t,r)),r.promise}function TO(n,e,t={}){let r=new gt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,c,u,h){let f=new lo({next:g=>{f.Ou(),o.enqueueAndForget(()=>Bp(s,m)),g.fromCache&&u.source==="server"?h.reject(new L(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new uo(c,f,{includeMetadataChanges:!0,ka:!0});return jp(s,m)})(await ru(n),n.asyncQueue,e,t,r)),r.promise}function xw(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var fE=new Map;var Vw="firestore.googleapis.com",pE=!0,iu=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new L(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Vw,this.ssl=pE}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:pE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<xN)throw new L(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}MD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Si=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Fd;switch(r.type){case"firstParty":return new zd(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=fE.get(t);r&&(V("ComponentProvider","Removing Datastore"),fE.delete(t),r.terminate())})(this),Promise.resolve()}};function Uw(n,e,t,r={}){var i;n=Ze(n,Si);let s=gn(e),o=n._getSettings(),c=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),u=`${e}:${t}`;s&&(Ua(`https://${u}`),Fa("Firestore",!0)),o.host!==Vw&&o.host!==u&&Nn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let h=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:r});if(!wt(h,c)&&(n._setSettings(h),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=Ce.MOCK_USER;else{f=a_(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new L(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Ce(g)}n._authCredentials=new jd(new Nc(f,m))}}var br=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ae=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(mo(t,n._jsonSchema))return new n(e,r||null,new F(de.fromString(t.referencePath)))}};Ae._jsonSchemaVersion="firestore/documentReference/1.0",Ae._jsonSchema={type:Te("string",Ae._jsonSchemaVersion),referencePath:Te("string")};var Cn=class n extends br{constructor(e,t,r){super(e,t,pu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ae(this.firestore,null,new F(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Fw(n,e,...t){if(n=ye(n),wE("collection","path",e),n instanceof Si){let r=de.fromString(e,...t);return NI(r),new Cn(n,null,r)}{if(!(n instanceof Ae||n instanceof Cn))throw new L(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(de.fromString(e,...t));return NI(r),new Cn(n.firestore,null,r)}}function jw(n,e,...t){if(n=ye(n),arguments.length===1&&(e=Zs.newId()),wE("doc","path",e),n instanceof Si){let r=de.fromString(e,...t);return DI(r),new Ae(n,null,new F(r))}{if(!(n instanceof Ae||n instanceof Cn))throw new L(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(de.fromString(e,...t));return DI(r),new Ae(n.firestore,n instanceof Cn?n.converter:null,new F(r))}}var mE="AsyncQueue",su=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Qc(this,"async_queue_retry"),this.oc=()=>{let r=Vd();r&&V(mE,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=Vd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=Vd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new gt;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!ki(e))throw e;V(mE,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Zt("INTERNAL UNHANDLED ERROR: ",gE(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=ip.createAndSchedule(this,e,t,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&j(47125,{hc:gE(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function gE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function yE(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var Ot=class extends Si{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new su,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new su(e),this._firestoreClient=void 0,await e}}};function Bw(n,e){let t=typeof n=="object"?n:er(),r=typeof n=="string"?n:e||Vc,i=Xr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=o_("firestore");s&&Uw(i,...s)}return i}function Iu(n){if(n._terminated)throw new L(C.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bO(n),n._firestoreClient}function bO(n){var e,t,r;let i=n._freezeSettings(),s=(function(c,u,h,f){return new Kd(c,u,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,xw(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new pp(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(c){let u=c?._online.build();return{_offline:c?._offline.build(u),_online:u}})(n._componentsProvider))}var Pn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ue.fromBase64String(e))}catch(t){throw new L(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ue.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(mo(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Pn._jsonSchemaVersion="firestore/bytes/1.0",Pn._jsonSchema={type:Te("string",Pn._jsonSchemaVersion),bytes:Te("string")};var Ri=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ho=class{constructor(e){this._methodName=e}};var kn=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(mo(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};kn._jsonSchemaVersion="firestore/geoPoint/1.0",kn._jsonSchema={type:Te("string",kn._jsonSchemaVersion),latitude:Te("number"),longitude:Te("number")};var Dn=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(mo(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new L(C.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Dn._jsonSchemaVersion="firestore/vectorValue/1.0",Dn._jsonSchema={type:Te("string",Dn._jsonSchemaVersion),vectorValues:Te("object")};var AO=/^__.*__$/,mp=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Nt(e,this.data,this.fieldMask,t,this.fieldTransforms):new wr(e,this.data,t,this.fieldTransforms)}},ou=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Nt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function $w(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j(40011,{Ec:n})}}var gp=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return cu(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if($w(this.Ec)&&AO.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},yp=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||yu(e)}Dc(e,t,r,i=!1){return new gp({Ec:e,methodName:t,bc:r,path:Xe.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Hp(n){let e=n._freezeSettings(),t=yu(n._databaseId);return new yp(n._databaseId,!!e.ignoreUndefinedProperties,t)}function SO(n,e,t,r,i,s={}){let o=n.Dc(s.merge||s.mergeFields?2:0,e,t,i);Wp("Data must be an object, but it was:",o,r);let c=zw(r,o),u,h;if(s.merge)u=new it(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let m of s.mergeFields){let g=_p(e,m,t);if(!o.contains(g))throw new L(C.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Hw(f,g)||f.push(g)}u=new it(f),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new mp(new Ye(c),u,h)}var au=class n extends ho{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function RO(n,e,t,r){let i=n.Dc(1,e,t);Wp("Data must be an object, but it was:",i,r);let s=[],o=Ye.empty();xn(r,(u,h)=>{let f=Gp(e,u,t);h=ye(h);let m=i.gc(f);if(h instanceof au)s.push(f);else{let g=_o(h,m);g!=null&&(s.push(f),o.set(f,g))}});let c=new it(s);return new ou(o,c,i.fieldTransforms)}function CO(n,e,t,r,i,s){let o=n.Dc(1,e,t),c=[_p(e,r,t)],u=[i];if(s.length%2!=0)throw new L(C.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)c.push(_p(e,s[g])),u.push(s[g+1]);let h=[],f=Ye.empty();for(let g=c.length-1;g>=0;--g)if(!Hw(h,c[g])){let A=c[g],P=u[g];P=ye(P);let D=o.gc(A);if(P instanceof au)h.push(A);else{let R=_o(P,D);R!=null&&(h.push(A),f.set(A,R))}}let m=new it(h);return new ou(f,m,o.fieldTransforms)}function PO(n,e,t,r=!1){return _o(t,n.Dc(r?4:3,e))}function _o(n,e){if(qw(n=ye(n)))return Wp("Unsupported field value:",e,n),zw(n,e);if(n instanceof ho)return(function(r,i){if(!$w(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let c of r){let u=_o(c,i.yc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return hN(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=be.fromDate(r);return{timestampValue:qc(i.serializer,s)}}if(r instanceof be){let s=new be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:qc(i.serializer,s)}}if(r instanceof kn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pn)return{bytesValue:dw(i.serializer,r._byteString)};if(r instanceof Ae){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Op(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Dn)return(function(o,c){return{mapValue:{fields:{[Rp]:{stringValue:Cp},[gi]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw c.wc("VectorValues must only contain numeric values.");return Np(c.serializer,h)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${hu(r)}`)})(n,e)}function zw(n,e){let t={};return UE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xn(n,(r,i)=>{let s=_o(i,e.Vc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function qw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof be||n instanceof kn||n instanceof Pn||n instanceof Ae||n instanceof ho||n instanceof Dn)}function Wp(n,e,t){if(!qw(t)||!TE(t)){let r=hu(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function _p(n,e,t){if((e=ye(e))instanceof Ri)return e._internalPath;if(typeof e=="string")return Gp(n,e);throw cu("Field path arguments must be of type string or ",n,!1,void 0,t)}var kO=new RegExp("[~\\*/\\[\\]]");function Gp(n,e,t){if(e.search(kO)>=0)throw cu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ri(...e.split("."))._internalPath}catch{throw cu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function cu(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new L(C.INVALID_ARGUMENT,c+n+u)}function Hw(n,e){return n.some(t=>t.isEqual(e))}var uu=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ae(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new vp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Kp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},vp=class extends uu{data(){return super.data()}};function Kp(n,e){return typeof e=="string"?Gp(n,e):e instanceof Ri?e._internalPath:e._delegate._internalPath}function Ww(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var fo=class{},Ip=class extends fo{};function Gw(n,e,...t){let r=[];e instanceof fo&&r.push(e),r=r.concat(t),(function(s){let o=s.filter(u=>u instanceof Ep).length,c=s.filter(u=>u instanceof lu).length;if(o>1||o>0&&c>0)throw new L(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var lu=class n extends Ip{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Jw(e._query,t),new br(e.firestore,e.converter,cf(e._query,t))}_parse(e){let t=Hp(e.firestore);return(function(s,o,c,u,h,f,m){let g;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new L(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){vE(m,f);let P=[];for(let D of m)P.push(_E(u,s,D));g={arrayValue:{values:P}}}else g=_E(u,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||vE(m,f),g=PO(c,o,m,f==="in"||f==="not-in");return we.create(h,f,g)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Kw(n,e,t){let r=e,i=Kp("where",n);return lu._create(i,r,t)}var Ep=class n extends fo{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:_t.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i,c=s.getFlattenedFilters();for(let u of c)Jw(o,u),o=cf(o,u)})(e._query,t),new br(e.firestore,e.converter,cf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function _E(n,e,t){if(typeof(t=ye(t))=="string"){if(t==="")throw new L(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!XE(e)&&t.indexOf("/")!==-1)throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(de.fromString(t));if(!F.isDocumentKey(r))throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return FI(n,new F(r))}if(t instanceof Ae)return FI(n,t._key);throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hu(t)}.`)}function vE(n,e){if(!Array.isArray(n)||n.length===0)throw new L(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Jw(n,e){let t=(function(i,s){for(let o of i)for(let c of o.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new L(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var wp=class{convertValue(e,t="none"){switch(On(e)){case 0:return null;case 1:return e.booleanValue;case 2:return he(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(tn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw j(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return xn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[gi].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>he(o.doubleValue));return new Dn(s)}convertGeoPoint(e){return new kn(he(e.latitude),he(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=fu(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(no(e));default:return null}}convertTimestamp(e){let t=en(e);return new be(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=de.fromString(e);oe(_w(r),9688,{name:e});let i=new Uc(r.get(1),r.get(3)),s=new F(r.popFirst(5));return i.isEqual(t)||Zt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function DO(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var pr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},mr=class n extends uu{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new pi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Kp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(C.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};mr._jsonSchemaVersion="firestore/documentSnapshot/1.0",mr._jsonSchema={type:Te("string",mr._jsonSchemaVersion),bundleSource:Te("string","DocumentSnapshot"),bundleName:Te("string"),bundle:Te("string")};var pi=class extends mr{data(e={}){return super.data(e)}},gr=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new pr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new pi(this._firestore,this._userDataWriter,r.key,r,new pr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{let u=new pi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new pr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let u=new pi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new pr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,f=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:NO(c.type),doc:u,oldIndex:h,newIndex:f}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(C.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Zs.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function NO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j(61501,{type:n})}}function Qw(n){n=Ze(n,Ae);let e=Ze(n.firestore,Ot);return wO(Iu(e),n._key).then(t=>nT(e,n,t))}gr._jsonSchemaVersion="firestore/querySnapshot/1.0",gr._jsonSchema={type:Te("string",gr._jsonSchemaVersion),bundleSource:Te("string","QuerySnapshot"),bundleName:Te("string"),bundle:Te("string")};var po=class extends wp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,t)}};function Yw(n){n=Ze(n,br);let e=Ze(n.firestore,Ot),t=Iu(e),r=new po(e);return Ww(n._query),TO(t,n._query).then(i=>new gr(e,r,n,i))}function Xw(n,e,t){n=Ze(n,Ae);let r=Ze(n.firestore,Ot),i=DO(n.converter,e,t);return Jp(r,[SO(Hp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Xt.none())])}function Zw(n,e,t,...r){n=Ze(n,Ae);let i=Ze(n.firestore,Ot),s=Hp(i),o;return o=typeof(e=ye(e))=="string"||e instanceof Ri?CO(s,"updateDoc",n._key,e,t,r):RO(s,"updateDoc",n._key,e),Jp(i,[o.toMutation(n._key,Xt.exists(!0))])}function eT(n){return Jp(Ze(n.firestore,Ot),[new io(n._key,Xt.none())])}function tT(n,...e){var t,r,i;n=ye(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||yE(e[o])||(s=e[o++]);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(yE(e[o])){let m=e[o];e[o]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let u,h,f;if(n instanceof Ae)h=Ze(n.firestore,Ot),f=pu(n._key.path),u={next:m=>{e[o]&&e[o](nT(h,n,m))},error:e[o+1],complete:e[o+2]};else{let m=Ze(n,br);h=Ze(m.firestore,Ot),f=m._query;let g=new po(h);u={next:A=>{e[o]&&e[o](new gr(h,g,m,A))},error:e[o+1],complete:e[o+2]},Ww(n._query)}return(function(g,A,P,D){let R=new lo(D),O=new uo(A,R,P);return g.asyncQueue.enqueueAndForget(async()=>jp(await ru(g),O)),()=>{R.Ou(),g.asyncQueue.enqueueAndForget(async()=>Bp(await ru(g),O))}})(Iu(h),f,c,u)}function Jp(n,e){return(function(r,i){let s=new gt;return r.asyncQueue.enqueueAndForget(async()=>hO(await EO(r),i,s)),s.promise})(Iu(n),e)}function nT(n,e,t){let r=t.docs.get(e._key),i=new po(n);return new mr(n,i,e._key,r,new pr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Ci=i})(_n),ft(new qe("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),c=new Ot(new Bd(r.getProvider("auth-internal")),new qd(o,r.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new L(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Uc(h.options.projectId,f)})(o,i),o);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),pe(RI,CI,e),pe(RI,CI,"esm2017")})();var Sr=class{constructor(e){return e}},rT="firestore",Qp=class{constructor(){return ei(rT)}};var Yp=new ne("angularfire2.firestore-instances");function OO(n,e){let t=Ps(rT,n,e);return t&&new Sr(t)}function MO(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Sr(r)}}var LO={provide:Qp,deps:[[new nt,Yp]]},xO={provide:Sr,useFactory:OO,deps:[[new nt,Yp],zt]};function bj(n,...e){return pe("angularfire",vn.full,"fst"),at([xO,LO,{provide:Yp,useFactory:MO(n),multi:!0,deps:[$e,ut,In,nr,[new nt,Ws],[new nt,ti],...e]}])}var iT=_e(Fw,!0,2);var sT=_e(eT,!0,2);var Rr=_e(jw,!0,2);var oT=_e(Qw,!0);var aT=_e(Yw,!0);var Aj=_e(Bw,!0);var Sj=_e(tT,!0);var Rj=_e(Gw,!0,2);var cT=_e(Xw,!0,2);var Eu=_e(Zw,!0,2);var Cj=_e(Kw,!0,2);var uT=class n{auth=x(hr);firestore=x(Sr);router=x(Yn);user$=wI(this.auth);currentUser=hn(null);constructor(){this.user$.pipe(Be(e=>e?this.getUserDocument(e.uid):G(null))).subscribe(e=>{this.currentUser.set(e)})}login(e,t){return xe(bI(this.auth,e,t)).pipe(Be(r=>this.getUserDocument(r.user.uid).pipe(ce(i=>({user:i,uid:r.user.uid})))),ce(({user:r,uid:i})=>{if(r){if(r.email==="admin@test.com"&&r.role!=="admin"){r.role="admin";let s=Rr(this.firestore,`users/${i}`);Eu(s,{role:"admin"}).catch(o=>console.error("Admin auto-update failed",o))}return r.isActive?(r.role==="admin"?this.router.navigate(["/admin"]):this.router.navigate(["/dashboard"]),{success:!0,user:r}):(Cd(this.auth),{success:!1,message:"AUTH.USER_DISABLED"})}else{let s=this.auth.currentUser;if(s||i){let o={id:i,name:s?.displayName||"User",email:s?.email||e||"",role:(s?.email||e)==="admin@test.com"?"admin":"user",isActive:!0,avatar:""};return this.createUserDocument(o),this.router.navigate(["/dashboard"]),{success:!0,user:o}}return{success:!1,message:"AUTH.USER_NOT_FOUND"}}}),Nr(r=>(console.error("[Auth] Login Error Stream:",r),Yi(()=>this.mapFirebaseError(r)))))}register(e){return xe(TI(this.auth,e.email,e.password)).pipe(Be(async t=>{let r={id:t.user.uid,name:e.name,email:e.email,role:e.email==="admin@test.com"?"admin":"user",isActive:!0,avatar:""};return await this.createUserDocument(r),{success:!0,user:r}}),Nr(t=>Yi(()=>this.mapFirebaseError(t))))}logout(){Cd(this.auth).then(()=>{this.router.navigate(["/login"])})}mapFirebaseError(e){let t=e.code||"";switch(t){case"auth/email-already-in-use":return"AUTH.EMAIL_EXISTS";case"auth/invalid-credential":return"AUTH.INVALID_CREDENTIALS";case"auth/weak-password":return"AUTH.WEAK_PASSWORD";case"auth/user-disabled":return"AUTH.USER_DISABLED";case"auth/operation-not-allowed":return"AUTH.OPERATION_NOT_ALLOWED";case"auth/user-not-found":return"AUTH.USER_NOT_FOUND";case"auth/wrong-password":return"AUTH.WRONG_PASSWORD";case"auth/too-many-requests":return"AUTH.TOO_MANY_REQUESTS";case"auth/network-request-failed":return"AUTH.NETWORK_ERROR";default:return console.error("Firebase Auth Error:",e),e.message&&e.message.includes("INVALID_LOGIN_CREDENTIALS")||e.message&&(e.message.includes("offline")||e.message.includes("400"))?"AUTH.INVALID_CREDENTIALS":t||e.message}}async createUserDocument(e){let t=Rr(this.firestore,`users/${e.id}`);await cT(t,e)}getUserDocument(e){let t=Rr(this.firestore,`users/${e}`);return xe(oT(t)).pipe(ce(r=>r.exists()?M({id:r.id},r.data()):null))}getAllUsers(){let e=iT(this.firestore,"users");return xe(aT(e)).pipe(ce(t=>t.docs.map(r=>M({id:r.id},r.data()))))}updateUserStatus(e,t){let r=Rr(this.firestore,`users/${e}`);Eu(r,{isActive:t})}deleteUser(e){let t=Rr(this.firestore,`users/${e}`);sT(t)}updateUser(e){if(!this.currentUser())return;let t=Rr(this.firestore,`users/${e.id}`);Eu(t,M({},e)).then(()=>{this.currentUser.set(e)})}get isLoggedIn(){return!!this.currentUser()}get isAdmin(){return this.currentUser()?.role==="admin"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})};export{nb as a,kb as b,cx as c,ux as d,e2 as e,t2 as f,Sr as g,bj as h,iT as i,sT as j,Rr as k,oT as l,aT as m,Aj as n,Sj as o,Rj as p,cT as q,Cj as r,Bt as s,Ll as t,Yn as u,t_ as v,hS as w,_S as x,uT as y};
